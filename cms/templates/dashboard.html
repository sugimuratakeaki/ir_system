{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<!-- KPIã‚«ãƒ¼ãƒ‰ -->
<div class="dashboard-grid">
    {% for key, kpi in kpis.items() %}
    <div class="kpi-card">
        <div class="kpi-value">{{ kpi.value }}{% if key == 'investor_satisfaction' or key == 'faq_accuracy' %}%{% endif %}</div>
        <div class="kpi-label">{{ kpi.label }}</div>
        <div class="kpi-trend {% if kpi.trend.startswith('+') %}trend-positive{% else %}trend-negative{% endif %}">
            <span>{{ kpi.trend }}</span>
        </div>
    </div>
    {% endfor %}
</div>

<!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
<div class="flex gap-lg" style="flex-wrap: wrap;">
    <!-- æœ€è¿‘ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ -->
    <div class="activity-feed" style="flex: 2; min-width: 300px;">
        <div class="activity-header">
            <h2 class="activity-title">æœ€è¿‘ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£</h2>
            <button class="btn btn-sm btn-secondary">ã™ã¹ã¦è¡¨ç¤º</button>
        </div>
        
        <div class="activity-list">
            {% for activity in recent_activities %}
            <div class="activity-item">
                <div class="activity-icon">
                    {{ activity.icon }}
                </div>
                <div class="activity-content">
                    <div class="activity-type">{{ activity.type }}</div>
                    <div class="activity-description">{{ activity.content }}</div>
                    <div class="activity-time">{{ activity.time }}</div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    
    <!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="card" style="flex: 1; min-width: 250px;">
        <div class="card-header">
            <h3 class="text-lg font-semibold">ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h3>
        </div>
        <div class="card-body">
            <div class="flex flex-col gap-md">
                <button class="btn btn-primary" onclick="showNewFAQModal()">
                    <span>â•</span> æ–°è¦FAQä½œæˆ
                </button>
                <button class="btn btn-secondary" onclick="location.href='/upload'">
                    <span>ğŸ“¤</span> ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
                </button>
                <button class="btn btn-secondary" onclick="location.href='/investors'">
                    <span>ğŸ‘¥</span> æŠ•è³‡å®¶è¿½åŠ 
                </button>
                <button class="btn btn-secondary" onclick="generateReport()">
                    <span>ğŸ“Š</span> ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
                </button>
            </div>
        </div>
    </div>
</div>

<!-- ã‚·ã‚¹ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ -->
<div class="card mt-lg">
    <div class="card-header">
        <h3 class="text-lg font-semibold">ã‚·ã‚¹ãƒ†ãƒ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h3>
    </div>
    <div class="card-body">
        <div class="flex gap-lg" style="flex-wrap: wrap;">
            <div class="flex items-center gap-sm">
                <span class="badge badge-success">â—</span>
                <span>AIå‡¦ç†ã‚¨ãƒ³ã‚¸ãƒ³: ç¨¼åƒä¸­</span>
            </div>
            <div class="flex items-center gap-sm">
                <span class="badge badge-success">â—</span>
                <span>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹: æ­£å¸¸</span>
            </div>
            <div class="flex items-center gap-sm">
                <span class="badge badge-success">â—</span>
                <span>APIæ¥ç¶š: è‰¯å¥½</span>
            </div>
            <div class="flex items-center gap-sm">
                <span class="badge badge-warning">â—</span>
                <span>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—: 24æ™‚é–“å‰</span>
            </div>
        </div>
    </div>
</div>

<!-- ãƒ¢ãƒ¼ãƒ€ãƒ«ï¼ˆFAQä½œæˆï¼‰ -->
<div class="modal" id="newFAQModal">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">æ–°è¦FAQä½œæˆ</h2>
            <button class="modal-close" onclick="closeModal('newFAQModal')">&times;</button>
        </div>
        <form onsubmit="event.preventDefault(); createFAQ();">
            <div class="form-group">
                <label class="form-label">è³ªå•</label>
                <input type="text" class="form-control" placeholder="ä¾‹ï¼šé…å½“æ”¿ç­–ã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„" required>
            </div>
            <div class="form-group">
                <label class="form-label">å›ç­”</label>
                <textarea class="form-control" rows="4" placeholder="å›ç­”ã‚’å…¥åŠ›..." required></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">AIè‡ªå‹•ç”Ÿæˆ</label>
                <button type="button" class="btn btn-secondary" onclick="generateAIAnswer()">
                    ğŸ¤– AIã§å›ç­”ã‚’ç”Ÿæˆ
                </button>
            </div>
            <div class="flex gap-md justify-end">
                <button type="button" class="btn btn-secondary" onclick="closeModal('newFAQModal')">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
                <button type="submit" class="btn btn-primary">ä½œæˆ</button>
            </div>
        </form>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// ãƒ¢ãƒ¼ãƒ€ãƒ«åˆ¶å¾¡
function showNewFAQModal() {
    document.getElementById('newFAQModal').classList.add('active');
}

function closeModal(modalId) {
    document.getElementById(modalId).classList.remove('active');
}

// FAQä½œæˆï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
function createFAQ() {
    alert('FAQã‚’ä½œæˆã—ã¾ã—ãŸï¼ˆãƒ‡ãƒ¢ï¼‰');
    closeModal('newFAQModal');
}

// AIå›ç­”ç”Ÿæˆï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
function generateAIAnswer() {
    const textarea = document.querySelector('textarea');
    textarea.value = 'AIãŒç”Ÿæˆã—ãŸå›ç­”ä¾‹ï¼šå½“ç¤¾ã¯å®‰å®šçš„ãªé…å½“ã‚’é‡è¦–ã—ã€é…å½“æ€§å‘30%ã‚’ç›®æ¨™ã¨ã—ã¦ã„ã¾ã™ã€‚';
}

// ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
function generateReport() {
    alert('ãƒ¬ãƒãƒ¼ãƒˆã‚’ç”Ÿæˆä¸­...ï¼ˆãƒ‡ãƒ¢ï¼‰');
}
</script>
{% endblock %}
