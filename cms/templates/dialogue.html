{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
<div class="flex justify-between items-center mb-lg">
    <div>
        <h2 class="text-2xl font-bold mb-sm">å¯¾è©±è¨˜éŒ²ç®¡ç†</h2>
        <p class="text-muted">ã™ã¹ã¦ã®æŠ•è³‡å®¶å¯¾è©±è¨˜éŒ²ã‚’ä¸€å…ƒç®¡ç†</p>
    </div>
    <div class="flex gap-md">
        <!-- ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ -->
        <div class="view-toggle">
            <button class="view-btn active" onclick="setViewMode('simple')" data-view="simple">
                <span class="icon">ğŸ“‹</span>
                <span>ã‚·ãƒ³ãƒ—ãƒ«</span>
            </button>
            <button class="view-btn" onclick="setViewMode('detailed')" data-view="detailed">
                <span class="icon">ğŸ“Š</span>
                <span>è©³ç´°</span>
            </button>
        </div>
        <button class="btn btn-secondary" onclick="showFilterModal()">
            ğŸ” è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿
        </button>
        <a href="/upload" class="btn btn-primary">
            ğŸ“¤ æ–°è¦å–ã‚Šè¾¼ã¿
        </a>
    </div>
</div>

<!-- çµ±è¨ˆã‚µãƒãƒªãƒ¼ -->
<div class="dashboard-grid mb-lg">
    <div class="kpi-card">
        <div class="kpi-value">156</div>
        <div class="kpi-label">ä»Šæœˆã®å¯¾è©±è¨˜éŒ²</div>
        <div class="kpi-trend trend-positive">â†‘ 23% å‰æœˆæ¯”</div>
    </div>
    <div class="kpi-card">
        <div class="kpi-value">42</div>
        <div class="kpi-label">å‡¦ç†å¾…ã¡</div>
        <div class="kpi-trend trend-negative">â†‘ 5ä»¶ æ˜¨æ—¥ã‚ˆã‚Š</div>
    </div>
    <div class="kpi-card">
        <div class="kpi-value">98%</div>
        <div class="kpi-label">AIåˆ†æå®Œäº†ç‡</div>
        <div class="kpi-trend">â†’ å®‰å®š</div>
    </div>
    <div class="kpi-card">
        <div class="kpi-value">234</div>
        <div class="kpi-label">FAQå€™è£œç”Ÿæˆ</div>
        <div class="kpi-trend trend-positive">â†‘ 45% åŠ¹ç‡æ”¹å–„</div>
    </div>
</div>

<!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒãƒ¼ -->
<div class="card mb-lg">
    <div class="card-body">
        <div class="flex gap-md items-center flex-wrap">
            <div class="form-group mb-0">
                <select class="form-control">
                    <option>ã™ã¹ã¦ã®ã‚½ãƒ¼ã‚¹</option>
                    <option>ğŸ™ï¸ éŸ³å£°ãƒ»å‹•ç”»</option>
                    <option>ğŸ’» Webä¼šè­°</option>
                    <option>ğŸ“§ ãƒ¡ãƒ¼ãƒ«</option>
                    <option>ğŸ“„ æ–‡æ›¸</option>
                </select>
            </div>
            <div class="form-group mb-0">
                <select class="form-control">
                    <option>ã™ã¹ã¦ã®ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</option>
                    <option>â³ å‡¦ç†å¾…ã¡</option>
                    <option>ğŸ”„ å‡¦ç†ä¸­</option>
                    <option>âœ… å®Œäº†</option>
                    <option>âŒ ã‚¨ãƒ©ãƒ¼</option>
                </select>
            </div>
            <div class="form-group mb-0">
                <input type="date" class="form-control" placeholder="é–‹å§‹æ—¥">
            </div>
            <span>ã€œ</span>
            <div class="form-group mb-0">
                <input type="date" class="form-control" placeholder="çµ‚äº†æ—¥">
            </div>
            <div class="form-group mb-0 flex-1">
                <input type="text" class="form-control" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢...">
            </div>
            <button class="btn btn-primary">æ¤œç´¢</button>
        </div>
    </div>
</div>

<!-- å¯¾è©±è¨˜éŒ²ä¸€è¦§ -->
<div class="card">
    <div class="card-body">
        <div class="table-container">
            <table class="table" id="dialogueTable">
                <thead>
                    <tr class="simple-view">
                        <th style="width: 40px;">
                            <input type="checkbox" id="selectAll">
                        </th>
                        <th style="width: 120px;">æ—¥æ™‚</th>
                        <th style="width: 100px;">ãƒ‡ãƒ¼ã‚¿</th>
                        <th>ã‚¿ã‚¤ãƒˆãƒ«/å†…å®¹</th>
                        <th style="width: 120px;">å–å¼•å…ˆ</th>
                        <th style="width: 150px;">ç¤¾å†…é–¢ä¿‚è€…</th>
                        <th style="width: 100px;">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                        <th style="width: 120px;">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                    </tr>
                    <tr class="detailed-view">
                        <th style="width: 40px;">
                            <input type="checkbox" id="selectAllDetailed">
                        </th>
                        <th style="width: 120px;">æ—¥æ™‚</th>
                        <th style="width: 100px;">ãƒ‡ãƒ¼ã‚¿</th>
                        <th>ã‚¿ã‚¤ãƒˆãƒ«/å†…å®¹</th>
                        <th style="width: 300px;">AIã‚µãƒãƒªãƒ¼</th>
                        <th style="width: 120px;">å–å¼•å…ˆ</th>
                        <th style="width: 150px;">ç¤¾å†…é–¢ä¿‚è€…</th>
                        <th style="width: 100px;">AIåˆ†æ</th>
                        <th style="width: 100px;">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</th>
                        <th style="width: 120px;">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Webä¼šè­°ã®ä¾‹ -->
                    <tr class="simple-view">
                        <td><input type="checkbox"></td>
                        <td>
                            <div>2024/01/15</div>
                            <div class="text-sm text-muted">14:00-14:45</div>
                        </td>
                        <td>
                            <div class="data-icons">
                                <span class="data-icon active" title="Webä¼šè­°">ğŸ’»</span>
                                <span class="data-icon active" title="éŸ³å£°ã‚ã‚Š">ğŸ¤</span>
                                <span class="data-icon active" title="å‹•ç”»ã‚ã‚Š">ğŸ¥</span>
                                <span class="data-icon inactive" title="æ–‡æ›¸ãªã—">ğŸ“„</span>
                                <span class="data-icon inactive" title="ãƒ¡ãƒ¼ãƒ«ãªã—">âœ‰ï¸</span>
                            </div>
                            <div class="text-xs text-muted mt-xs">45åˆ†ãƒ»156å</div>
                        </td>
                        <td>
                            <div class="font-semibold">2024å¹´ç¬¬3å››åŠæœŸæ±ºç®—èª¬æ˜ä¼š</div>
                            <div class="text-sm text-muted">Zoomä¼šè­° â€¢ æŠ•è³‡å®¶å‘ã‘èª¬æ˜ä¼š</div>
                        </td>
                        <td>
                            <div class="text-sm">æ©Ÿé–¢æŠ•è³‡å®¶å¤šæ•°</div>
                            <div class="text-sm text-muted">æŠ•è³‡å®¶å‘ã‘èª¬æ˜ä¼š</div>
                        </td>
                        <td>
                            <div class="text-sm">CEO, CFO</div>
                            <div class="text-sm text-muted">IRéƒ¨</div>
                        </td>
                        <td>
                            <div class="status-indicator">
                                <span class="badge badge-success">âœ… å®Œäº†</span>
                                <div class="ai-status mt-xs">
                                    <span class="ai-badge ai-complete" title="AIåˆ†æå®Œäº†">ğŸ¤–</span>
                                    <span class="text-xs">AIå‡¦ç†æ¸ˆ</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="flex gap-sm">
                                <button class="btn btn-sm btn-primary" onclick="showDetailModal('meeting_001')">è©³ç´°</button>
                                <button class="btn btn-sm btn-secondary" onclick="editDialogue('meeting_001')">ç·¨é›†</button>
                            </div>
                        </td>
                    </tr>
                    <tr class="detailed-view">
                        <td><input type="checkbox"></td>
                        <td>
                            <div>2024/01/15</div>
                            <div class="text-sm text-muted">14:00-14:45</div>
                        </td>
                        <td>
                            <div class="data-icons">
                                <span class="data-icon active" title="Webä¼šè­°">ğŸ’»</span>
                                <span class="data-icon active" title="éŸ³å£°ã‚ã‚Š">ğŸ¤</span>
                                <span class="data-icon active" title="å‹•ç”»ã‚ã‚Š">ğŸ¥</span>
                                <span class="data-icon inactive" title="æ–‡æ›¸ãªã—">ğŸ“„</span>
                                <span class="data-icon inactive" title="ãƒ¡ãƒ¼ãƒ«ãªã—">âœ‰ï¸</span>
                            </div>
                            <div class="text-xs text-muted mt-xs">45åˆ†ãƒ»156å</div>
                        </td>
                        <td>
                            <div class="font-semibold">2024å¹´ç¬¬3å››åŠæœŸæ±ºç®—èª¬æ˜ä¼š</div>
                            <div class="text-sm text-muted">Zoomä¼šè­° â€¢ æŠ•è³‡å®¶å‘ã‘èª¬æ˜ä¼š</div>
                        </td>
                        <td>
                            <div class="ai-summary">
                                <div class="summary-header">
                                    <span class="icon">ğŸ“</span>
                                    <span class="text-sm font-semibold">AIã‚µãƒãƒªãƒ¼</span>
                                </div>
                                <p class="text-sm mt-sm">å¥½èª¿ãªæ¥­ç¸¾ï¼ˆå£²ä¸Š15%å¢—ã€AIäº‹æ¥­35%å¢—ï¼‰ã‚’å ±å‘Šã€‚æŠ•è³‡å®¶ã‹ã‚‰æˆé•·æˆ¦ç•¥ã€DXæŠ•è³‡ã€ESGç›®æ¨™ã«ã¤ã„ã¦è³ªå•å¤šæ•°ã€‚å…¨ä½“çš„ã«ãƒã‚¸ãƒ†ã‚£ãƒ–ãªåå¿œã€‚</p>
                                <div class="summary-tags mt-sm">
                                    <span class="tag-small">ğŸ“ˆ æˆé•·æ€§</span>
                                    <span class="tag-small">ğŸ‘¥ äººæç¢ºä¿</span>
                                    <span class="tag-small">ğŸŒ ESG</span>
                                </div>
                                <div class="summary-metrics mt-sm">
                                    <div class="metric-item">
                                        <span class="metric-label">ä¸»è¦ãƒˆãƒ”ãƒƒã‚¯:</span>
                                        <span class="metric-value">æµ·å¤–äº‹æ¥­(35%), DXæŠ•è³‡(25%), ESG(20%)</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">æŠ•è³‡å®¶åå¿œ:</span>
                                        <span class="metric-value positive">ãƒã‚¸ãƒ†ã‚£ãƒ– 75%</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">é‡è¦åº¦:</span>
                                        <span class="metric-value high">é«˜</span>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text-sm">æ©Ÿé–¢æŠ•è³‡å®¶å¤šæ•°</div>
                            <div class="text-sm text-muted">æŠ•è³‡å®¶å‘ã‘èª¬æ˜ä¼š</div>
                        </td>
                        <td>
                            <div class="text-sm">CEO, CFO</div>
                            <div class="text-sm text-muted">IRéƒ¨</div>
                        </td>
                        <td>
                            <div class="ai-analysis-summary">
                                <div class="flex gap-xs flex-wrap">
                                    <span class="badge badge-info">FAQ: 12</span>
                                    <span class="badge badge-warning">èª²é¡Œ: 3</span>
                                    <span class="badge badge-success">å¥½æ„Ÿ75%</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="status-indicator">
                                <span class="badge badge-success">âœ… å®Œäº†</span>
                            </div>
                        </td>
                        <td>
                            <div class="flex gap-sm">
                                <button class="btn btn-sm btn-primary" onclick="showDetailModal('meeting_001')">è©³ç´°</button>
                                <button class="btn btn-sm btn-secondary" onclick="editDialogue('meeting_001')">ç·¨é›†</button>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- ãƒ¡ãƒ¼ãƒ«ã®ä¾‹ (ã‚·ãƒ³ãƒ—ãƒ«ãƒ“ãƒ¥ãƒ¼) -->
                    <tr class="simple-view">
                        <td><input type="checkbox"></td>
                        <td>
                            <div>2024/01/14</div>
                            <div class="text-sm text-muted">16:23</div>
                        </td>
                        <td>
                            <div class="data-icons">
                                <span class="data-icon inactive" title="Webä¼šè­°ãªã—">ğŸ’»</span>
                                <span class="data-icon inactive" title="éŸ³å£°ãªã—">ğŸ¤</span>
                                <span class="data-icon inactive" title="å‹•ç”»ãªã—">ğŸ¥</span>
                                <span class="data-icon inactive" title="æ–‡æ›¸ãªã—">ğŸ“„</span>
                                <span class="data-icon active" title="ãƒ¡ãƒ¼ãƒ«ã‚ã‚Š">âœ‰ï¸</span>
                            </div>
                            <div class="text-xs text-muted mt-xs">ãƒ¡ãƒ¼ãƒ«å¯¾å¿œ</div>
                        </td>
                        <td>
                            <div class="font-semibold">é…å½“æ”¿ç­–ã«é–¢ã™ã‚‹è³ªå•</div>
                            <div class="text-sm text-muted">æ©Ÿé–¢æŠ•è³‡å®¶Aç¤¾ â†’ IRéƒ¨</div>
                        </td>
                        <td>
                            <div class="text-sm">æ©Ÿé–¢æŠ•è³‡å®¶Aç¤¾</div>
                            <div class="text-sm text-muted">æ‹…å½“: ç”°ä¸­</div>
                        </td>
                        <td>
                            <div class="text-sm">IRéƒ¨</div>
                            <div class="text-sm text-muted">æ‹…å½“: éˆ´æœ¨</div>
                        </td>
                        <td>
                            <div class="status-indicator">
                                <span class="badge badge-warning">ğŸ”„ å‡¦ç†ä¸­</span>
                                <div class="ai-status mt-xs">
                                    <span class="ai-badge ai-processing" title="AIåˆ†æä¸­">ğŸ¤–</span>
                                    <span class="text-xs">åˆ†æä¸­</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="flex gap-sm">
                                <button class="btn btn-sm btn-primary" disabled>è©³ç´°</button>
                                <button class="btn btn-sm btn-secondary" onclick="editDialogue('email_001')">ç·¨é›†</button>
                            </div>
                        </td>
                    </tr>
                    <!-- ãƒ¡ãƒ¼ãƒ«ã®ä¾‹ (è©³ç´°ãƒ“ãƒ¥ãƒ¼) -->
                    <tr class="detailed-view">
                        <td><input type="checkbox"></td>
                        <td>
                            <div>2024/01/14</div>
                            <div class="text-sm text-muted">16:23</div>
                        </td>
                        <td>
                            <div class="data-icons">
                                <span class="data-icon inactive" title="Webä¼šè­°ãªã—">ğŸ’»</span>
                                <span class="data-icon inactive" title="éŸ³å£°ãªã—">ğŸ¤</span>
                                <span class="data-icon inactive" title="å‹•ç”»ãªã—">ğŸ¥</span>
                                <span class="data-icon inactive" title="æ–‡æ›¸ãªã—">ğŸ“„</span>
                                <span class="data-icon active" title="ãƒ¡ãƒ¼ãƒ«ã‚ã‚Š">âœ‰ï¸</span>
                            </div>
                            <div class="text-xs text-muted mt-xs">ãƒ¡ãƒ¼ãƒ«å¯¾å¿œ</div>
                        </td>
                        <td>
                            <div class="font-semibold">é…å½“æ”¿ç­–ã«é–¢ã™ã‚‹è³ªå•</div>
                            <div class="text-sm text-muted">æ©Ÿé–¢æŠ•è³‡å®¶Aç¤¾ â†’ IRéƒ¨</div>
                        </td>
                        <td>
                            <div class="ai-summary">
                                <div class="summary-header">
                                    <span class="icon">ğŸ“</span>
                                    <span class="text-sm font-semibold">AIã‚µãƒãƒªãƒ¼</span>
                                </div>
                                <p class="text-sm mt-sm">é…å½“æ€§å‘ç›®æ¨™ã€ä¸­æœŸçš„ãªæ ªä¸»é‚„å…ƒæ–¹é‡ã€è‡ªç¤¾æ ªè²·ã„ã®æ¤œè¨çŠ¶æ³ã«ã¤ã„ã¦ã®å•ã„åˆã‚ã›ã€‚çµŒå–¶æ–¹é‡ã«é–¢ã‚ã‚‹é‡è¦äº‹é …ã€‚</p>
                                <div class="summary-tags mt-sm">
                                    <span class="tag-small">ğŸ’µ é…å½“</span>
                                    <span class="tag-small">ğŸ“ˆ æ ªä¸»é‚„å…ƒ</span>
                                    <span class="tag-small">âš ï¸ é‡è¦</span>
                                </div>
                                <div class="summary-metrics mt-sm">
                                    <div class="metric-item">
                                        <span class="metric-label">è³ªå•å†…å®¹:</span>
                                        <span class="metric-value">é…å½“æ€§å‘ã€æ ªä¸»é‚„å…ƒã€è‡ªç¤¾æ ªè²·ã„</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">ç·Šæ€¥åº¦:</span>
                                        <span class="metric-value medium">ä¸­</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">å›ç­”è¦å¦:</span>
                                        <span class="metric-value required">è¦å›ç­”</span>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text-sm">æ©Ÿé–¢æŠ•è³‡å®¶Aç¤¾</div>
                            <div class="text-sm text-muted">æ‹…å½“: ç”°ä¸­</div>
                        </td>
                        <td>
                            <div class="text-sm">IRéƒ¨</div>
                            <div class="text-sm text-muted">æ‹…å½“: éˆ´æœ¨</div>
                        </td>
                        <td>
                            <div class="ai-analysis-summary">
                                <div class="text-sm text-muted">åˆ†æä¸­...</div>
                            </div>
                        </td>
                        <td>
                            <div class="status-indicator">
                                <span class="badge badge-warning">ğŸ”„ å‡¦ç†ä¸­</span>
                            </div>
                        </td>
                        <td>
                            <div class="flex gap-sm">
                                <button class="btn btn-sm btn-primary" disabled>è©³ç´°</button>
                                <button class="btn btn-sm btn-secondary" onclick="editDialogue('email_001')">ç·¨é›†</button>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- éŸ³å£°ã®ä¾‹ (ã‚·ãƒ³ãƒ—ãƒ«ãƒ“ãƒ¥ãƒ¼) -->
                    <tr class="simple-view">
                        <td><input type="checkbox"></td>
                        <td>
                            <div>2024/01/13</div>
                            <div class="text-sm text-muted">10:00-10:32</div>
                        </td>
                        <td>
                            <div class="data-icons">
                                <span class="data-icon inactive" title="Webä¼šè­°ãªã—">ğŸ’»</span>
                                <span class="data-icon active" title="éŸ³å£°ã‚ã‚Š">ğŸ¤</span>
                                <span class="data-icon inactive" title="å‹•ç”»ãªã—">ğŸ¥</span>
                                <span class="data-icon inactive" title="æ–‡æ›¸ãªã—">ğŸ“„</span>
                                <span class="data-icon inactive" title="ãƒ¡ãƒ¼ãƒ«ãªã—">âœ‰ï¸</span>
                            </div>
                            <div class="text-xs text-muted mt-xs">32åˆ†ãƒ»4å</div>
                        </td>
                        <td>
                            <div class="font-semibold">æŠ•è³‡å®¶Bç¤¾ã¨ã®å€‹åˆ¥é¢è«‡</div>
                            <div class="text-sm text-muted">éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ« â€¢ å€‹åˆ¥é¢è«‡</div>
                        </td>
                        <td>
                            <div class="text-sm">æŠ•è³‡å®¶Bç¤¾</div>
                            <div class="text-sm text-muted">2åå‚åŠ </div>
                        </td>
                        <td>
                            <div class="text-sm">CFO, IRéƒ¨é•·</div>
                            <div class="text-sm text-muted">IRéƒ¨</div>
                        </td>
                        <td>
                            <div class="status-indicator">
                                <span class="badge badge-success">âœ… å®Œäº†</span>
                                <div class="ai-status mt-xs">
                                    <span class="ai-badge ai-complete" title="AIåˆ†æå®Œäº†">ğŸ¤–</span>
                                    <span class="text-xs">AIå‡¦ç†æ¸ˆ</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="flex gap-sm">
                                <button class="btn btn-sm btn-primary" onclick="showDetailModal('voice_001')">è©³ç´°</button>
                                <button class="btn btn-sm btn-secondary" onclick="editDialogue('voice_001')">ç·¨é›†</button>
                            </div>
                        </td>
                    </tr>
                    <!-- éŸ³å£°ã®ä¾‹ (è©³ç´°ãƒ“ãƒ¥ãƒ¼) -->
                    <tr class="detailed-view">
                        <td><input type="checkbox"></td>
                        <td>
                            <div>2024/01/13</div>
                            <div class="text-sm text-muted">10:00-10:32</div>
                        </td>
                        <td>
                            <div class="data-icons">
                                <span class="data-icon inactive" title="Webä¼šè­°ãªã—">ğŸ’»</span>
                                <span class="data-icon active" title="éŸ³å£°ã‚ã‚Š">ğŸ¤</span>
                                <span class="data-icon inactive" title="å‹•ç”»ãªã—">ğŸ¥</span>
                                <span class="data-icon inactive" title="æ–‡æ›¸ãªã—">ğŸ“„</span>
                                <span class="data-icon inactive" title="ãƒ¡ãƒ¼ãƒ«ãªã—">âœ‰ï¸</span>
                            </div>
                            <div class="text-xs text-muted mt-xs">32åˆ†ãƒ»4å</div>
                        </td>
                        <td>
                            <div class="font-semibold">æŠ•è³‡å®¶Bç¤¾ã¨ã®å€‹åˆ¥é¢è«‡</div>
                            <div class="text-sm text-muted">éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ« â€¢ å€‹åˆ¥é¢è«‡</div>
                        </td>
                        <td>
                            <div class="ai-summary">
                                <div class="summary-header">
                                    <span class="icon">ğŸ“</span>
                                    <span class="text-sm font-semibold">AIã‚µãƒãƒªãƒ¼</span>
                                </div>
                                <p class="text-sm mt-sm">æŠ•è³‡å®¶Bç¤¾ã¨ã®å€‹åˆ¥é¢è«‡ã€‚äº‹æ¥­æˆ¦ç•¥ã€è²¡å‹™çŠ¶æ³ã€ESGå–ã‚Šçµ„ã¿ã«ã¤ã„ã¦è©³ç´°ãªèª¬æ˜ã€‚æŠ•è³‡å®¶ã‹ã‚‰ã¯æˆé•·æˆ¦ç•¥ã¨ãƒªã‚¹ã‚¯ç®¡ç†ã«ã¤ã„ã¦è³ªå•å¤šæ•°ã€‚å…¨ä½“çš„ã«å»ºè¨­çš„ãªå¯¾è©±ã€‚</p>
                                <div class="summary-tags mt-sm">
                                    <span class="tag-small">ğŸ“ˆ æˆé•·æˆ¦ç•¥</span>
                                    <span class="tag-small">ğŸ’° è²¡å‹™</span>
                                    <span class="tag-small">ğŸŒ ESG</span>
                                </div>
                                <div class="summary-metrics mt-sm">
                                    <div class="metric-item">
                                        <span class="metric-label">ä¸»è¦ãƒˆãƒ”ãƒƒã‚¯:</span>
                                        <span class="metric-value">äº‹æ¥­æˆ¦ç•¥(40%), è²¡å‹™(30%), ESG(30%)</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">æŠ•è³‡å®¶åå¿œ:</span>
                                        <span class="metric-value positive">ãƒã‚¸ãƒ†ã‚£ãƒ– 80%</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">é‡è¦åº¦:</span>
                                        <span class="metric-value high">é«˜</span>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text-sm">æŠ•è³‡å®¶Bç¤¾</div>
                            <div class="text-sm text-muted">2åå‚åŠ </div>
                        </td>
                        <td>
                            <div class="text-sm">CFO, IRéƒ¨é•·</div>
                            <div class="text-sm text-muted">IRéƒ¨</div>
                        </td>
                        <td>
                            <div class="ai-analysis-summary">
                                <div class="flex gap-xs flex-wrap">
                                    <span class="badge badge-info">FAQ: 5</span>
                                    <span class="badge badge-warning">èª²é¡Œ: 2</span>
                                    <span class="badge badge-success">å¥½æ„Ÿ80%</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="status-indicator">
                                <span class="badge badge-success">âœ… å®Œäº†</span>
                            </div>
                        </td>
                        <td>
                            <div class="flex gap-sm">
                                <button class="btn btn-sm btn-primary" onclick="showDetailModal('voice_001')">è©³ç´°</button>
                                <button class="btn btn-sm btn-secondary" onclick="editDialogue('voice_001')">ç·¨é›†</button>
                            </div>
                        </td>
                    </tr>
                    
                    <!-- æ–‡æ›¸ã®ä¾‹ (ã‚·ãƒ³ãƒ—ãƒ«ãƒ“ãƒ¥ãƒ¼) -->
                    <tr class="simple-view">
                        <td><input type="checkbox"></td>
                        <td>
                            <div>2024/01/10</div>
                            <div class="text-sm text-muted">-</div>
                        </td>
                        <td>
                            <div class="data-icons">
                                <span class="data-icon inactive" title="Webä¼šè­°ãªã—">ğŸ’»</span>
                                <span class="data-icon inactive" title="éŸ³å£°ãªã—">ğŸ¤</span>
                                <span class="data-icon inactive" title="å‹•ç”»ãªã—">ğŸ¥</span>
                                <span class="data-icon active" title="æ–‡æ›¸ã‚ã‚Š">ğŸ“„</span>
                                <span class="data-icon inactive" title="ãƒ¡ãƒ¼ãƒ«ãªã—">âœ‰ï¸</span>
                            </div>
                            <div class="text-xs text-muted mt-xs">PDFãƒ»15ãƒšãƒ¼ã‚¸</div>
                        </td>
                        <td>
                            <div class="font-semibold">å–ç· å½¹ä¼šè­°äº‹éŒ²</div>
                            <div class="text-sm text-muted">PDF â€¢ è­°äº‹éŒ²</div>
                        </td>
                        <td>
                            <div class="text-sm">-</div>
                            <div class="text-sm text-muted">å†…éƒ¨æ–‡æ›¸</div>
                        </td>
                        <td>
                            <div class="text-sm">å–ç· å½¹ä¼š</div>
                            <div class="text-sm text-muted">å…¨å–ç· å½¹</div>
                        </td>
                        <td>
                            <div class="status-indicator">
                                <span class="badge badge-success">âœ… å®Œäº†</span>
                                <div class="ai-status mt-xs">
                                    <span class="ai-badge ai-complete" title="AIåˆ†æå®Œäº†">ğŸ¤–</span>
                                    <span class="text-xs">AIå‡¦ç†æ¸ˆ</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="flex gap-sm">
                                <button class="btn btn-sm btn-primary" onclick="showDetailModal('doc_001')">è©³ç´°</button>
                                <button class="btn btn-sm btn-secondary" onclick="editDialogue('doc_001')">ç·¨é›†</button>
                            </div>
                        </td>
                    </tr>
                    <!-- æ–‡æ›¸ã®ä¾‹ (è©³ç´°ãƒ“ãƒ¥ãƒ¼) -->
                    <tr class="detailed-view">
                        <td><input type="checkbox"></td>
                        <td>
                            <div>2024/01/10</div>
                            <div class="text-sm text-muted">-</div>
                        </td>
                        <td>
                            <div class="data-icons">
                                <span class="data-icon inactive" title="Webä¼šè­°ãªã—">ğŸ’»</span>
                                <span class="data-icon inactive" title="éŸ³å£°ãªã—">ğŸ¤</span>
                                <span class="data-icon inactive" title="å‹•ç”»ãªã—">ğŸ¥</span>
                                <span class="data-icon active" title="æ–‡æ›¸ã‚ã‚Š">ğŸ“„</span>
                                <span class="data-icon inactive" title="ãƒ¡ãƒ¼ãƒ«ãªã—">âœ‰ï¸</span>
                            </div>
                            <div class="text-xs text-muted mt-xs">PDFãƒ»15ãƒšãƒ¼ã‚¸</div>
                        </td>
                        <td>
                            <div class="font-semibold">å–ç· å½¹ä¼šè­°äº‹éŒ²</div>
                            <div class="text-sm text-muted">PDF â€¢ è­°äº‹éŒ²</div>
                        </td>
                        <td>
                            <div class="ai-summary">
                                <div class="summary-header">
                                    <span class="icon">ğŸ“</span>
                                    <span class="text-sm font-semibold">AIã‚µãƒãƒªãƒ¼</span>
                                </div>
                                <p class="text-sm mt-sm">2024å¹´1æœˆ10æ—¥é–‹å‚¬ã®å–ç· å½¹ä¼šè­°äº‹éŒ²ã€‚ä¸­æœŸçµŒå–¶è¨ˆç”»ã®ä¿®æ­£ã€é…å½“æ–¹é‡ã®å¤‰æ›´ã€DXæŠ•è³‡å¢—é¡ãªã©é‡è¦ãªæ±ºè­°äº‹é …å¤šæ•°ã€‚å…¨å–ç· å½¹å‡ºå¸­ã€‚</p>
                                <div class="summary-tags mt-sm">
                                    <span class="tag-small">ğŸ“‹ è­°äº‹éŒ²</span>
                                    <span class="tag-small">ğŸ’° é…å½“</span>
                                    <span class="tag-small">âš ï¸ é‡è¦</span>
                                </div>
                                <div class="summary-metrics mt-sm">
                                    <div class="metric-item">
                                        <span class="metric-label">æ±ºè­°äº‹é …:</span>
                                        <span class="metric-value">ä¸­æœŸè¨ˆç”»ä¿®æ­£ã€é…å½“æ–¹é‡å¤‰æ›´ã€DXæŠ•è³‡å¢—é¡</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">é‡è¦åº¦:</span>
                                        <span class="metric-value critical">æœ€é«˜</span>
                                    </div>
                                    <div class="metric-item">
                                        <span class="metric-label">é–‹ç¤ºè¦å¦:</span>
                                        <span class="metric-value required">è¦é–‹ç¤º</span>
                                    </div>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="text-sm">-</div>
                            <div class="text-sm text-muted">å†…éƒ¨æ–‡æ›¸</div>
                        </td>
                        <td>
                            <div class="text-sm">å–ç· å½¹ä¼š</div>
                            <div class="text-sm text-muted">å…¨å–ç· å½¹</div>
                        </td>
                        <td>
                            <div class="ai-analysis-summary">
                                <div class="flex gap-xs flex-wrap">
                                    <span class="badge badge-info">é‡è¦: 8</span>
                                    <span class="badge badge-warning">æ±ºè­°: 5</span>
                                    <span class="badge badge-success">å®Œäº†</span>
                                </div>
                            </div>
                        </td>
                        <td>
                            <div class="status-indicator">
                                <span class="badge badge-success">âœ… å®Œäº†</span>
                            </div>
                        </td>
                        <td>
                            <div class="flex gap-sm">
                                <button class="btn btn-sm btn-primary" onclick="showDetailModal('doc_001')">è©³ç´°</button>
                                <button class="btn btn-sm btn-secondary" onclick="editDialogue('doc_001')">ç·¨é›†</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- ãƒšãƒ¼ã‚¸ãƒãƒ¼ã‚·ãƒ§ãƒ³ -->
        <div class="flex justify-between items-center mt-lg">
            <div class="text-sm text-muted">
                å…¨156ä»¶ä¸­ 1-10ä»¶ã‚’è¡¨ç¤º
            </div>
            <div class="flex gap-sm">
                <button class="btn btn-sm btn-secondary" disabled>å‰ã¸</button>
                <button class="btn btn-sm btn-secondary active">1</button>
                <button class="btn btn-sm btn-secondary">2</button>
                <button class="btn btn-sm btn-secondary">3</button>
                <span>...</span>
                <button class="btn btn-sm btn-secondary">16</button>
                <button class="btn btn-sm btn-secondary">æ¬¡ã¸</button>
            </div>
        </div>
    </div>
</div>

<!-- ä¸€æ‹¬æ“ä½œãƒãƒ¼ -->
<div class="fixed-bottom-bar" id="bulkActionBar" style="display: none;">
    <div class="container flex justify-between items-center">
        <div>
            <span id="selectedCount">0</span>ä»¶ã‚’é¸æŠä¸­
        </div>
        <div class="flex gap-md">
            <button class="btn btn-sm btn-secondary">ã‚¿ã‚°ä»˜ã‘</button>
            <button class="btn btn-sm btn-secondary">å…¬é–‹è¨­å®šå¤‰æ›´</button>
            <button class="btn btn-sm btn-secondary">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
            <button class="btn btn-sm btn-danger">å‰Šé™¤</button>
        </div>
    </div>
</div>

<!-- è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="detailModal" class="modal" style="display: none;">
    <div class="modal-overlay" onclick="closeDetailModal()"></div>
    <div class="modal-content" style="max-width: 90%; width: 1200px; max-height: 90vh; overflow-y: auto;">
        <div class="modal-header">
            <h2 class="text-xl font-bold">å¯¾è©±è¨˜éŒ²è©³ç´°</h2>
            <button class="btn btn-icon" onclick="closeDetailModal()">âœ•</button>
        </div>
        
        <div class="modal-body">
            <!-- å†…å®¹ã¯showDetailModal()ã§å‹•çš„ã«ç”Ÿæˆ -->
        </div>
        
        <div class="modal-footer">
            <button class="btn btn-secondary" onclick="closeDetailModal()">é–‰ã˜ã‚‹</button>
            <button class="btn btn-primary" onclick="editFromModal()">ç·¨é›†ç”»é¢ã¸</button>
        </div>
    </div>
</div>

<style>
/* ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆãƒœã‚¿ãƒ³ */
.view-toggle {
    display: flex;
    background-color: var(--gray-100);
    border-radius: var(--border-radius-md);
    padding: 2px;
}

.view-btn {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-sm) var(--space-md);
    background-color: transparent;
    border: none;
    border-radius: var(--border-radius-sm);
    cursor: pointer;
    transition: all 0.2s ease;
    font-size: var(--text-sm);
    color: var(--gray-600);
}

.view-btn:hover {
    color: var(--gray-800);
}

.view-btn.active {
    background-color: white;
    color: var(--kagami-blue);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.view-btn .icon {
    font-size: 1.2em;
}

/* ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¤ã‚³ãƒ³ */
.data-icons {
    display: flex;
    gap: 2px;
    justify-content: center;
    flex-wrap: wrap;
}

.data-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    font-size: 14px;
    border-radius: 4px;
    transition: all 0.2s ease;
}

.data-icon.active {
    background-color: rgba(21, 123, 255, 0.1);
    filter: grayscale(0);
}

.data-icon.inactive {
    background-color: var(--gray-50);
    filter: grayscale(1);
    opacity: 0.4;
}

/* AIã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ */
.ai-status {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
}

.ai-badge {
    font-size: 16px;
}

.ai-badge.ai-complete {
    filter: hue-rotate(120deg);
}

.ai-badge.ai-processing {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
}

/* AIã‚µãƒãƒªãƒ¼ */
.ai-summary {
    background-color: var(--gray-50);
    padding: var(--space-sm);
    border-radius: var(--border-radius-md);
    border-left: 3px solid var(--kagami-blue);
}

.summary-header {
    display: flex;
    align-items: center;
    gap: var(--space-xs);
}

.summary-tags {
    display: flex;
    gap: var(--space-xs);
    flex-wrap: wrap;
}

.tag-small {
    display: inline-flex;
    align-items: center;
    gap: 2px;
    padding: 2px 8px;
    background-color: white;
    border: 1px solid var(--gray-300);
    border-radius: var(--border-radius-full);
    font-size: var(--text-xs);
    color: var(--gray-700);
}

/* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
.status-indicator {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
    gap: var(--space-xs);
}

/* AIåˆ†æã‚µãƒãƒªãƒ¼ */
.ai-analysis-summary {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
}

.flex-wrap {
    flex-wrap: wrap;
}

.mt-xs {
    margin-top: var(--space-xs);
}

/* ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆ */
.table tbody tr {
    transition: all 0.3s ease;
}

/* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçŠ¶æ…‹: ã‚·ãƒ³ãƒ—ãƒ«ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º */
.table tbody tr.simple-view {
    display: table-row !important;
}

.table tbody tr.detailed-view {
    display: none !important;
}

/* è©³ç´°ãƒ¢ãƒ¼ãƒ‰æ™‚: è©³ç´°ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º */
body.detailed-mode .table tbody tr.simple-view {
    display: none !important;
}

body.detailed-mode .table tbody tr.detailed-view {
    display: table-row !important;
}

/* ãƒ˜ãƒƒãƒ€ãƒ¼ã®åˆ‡ã‚Šæ›¿ãˆ */
.table thead tr.simple-view {
    display: table-row !important;
}

.table thead tr.detailed-view {
    display: none !important;
}

body.detailed-mode .table thead tr.simple-view {
    display: none !important;
}

body.detailed-mode .table thead tr.detailed-view {
    display: table-row !important;
}

/* å›ºå®šåº•éƒ¨ãƒãƒ¼ */
.fixed-bottom-bar {
    position: fixed;
    bottom: 0;
    left: 250px; /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®å¹… */
    right: 0;
    background-color: white;
    border-top: 1px solid var(--gray-200);
    padding: var(--space-md);
    box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
    z-index: 100;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 var(--space-lg);
}

/* ãƒ¢ãƒ¼ãƒ€ãƒ« */
.modal {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
}

.modal-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
}

.modal-content {
    position: relative;
    background-color: white;
    border-radius: var(--border-radius-lg);
    box-shadow: var(--shadow-xl);
    z-index: 1001;
}

.modal-header {
    padding: var(--space-lg);
    border-bottom: 1px solid var(--gray-200);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-body {
    padding: var(--space-lg);
}

.modal-footer {
    padding: var(--space-lg);
    border-top: 1px solid var(--gray-200);
    display: flex;
    justify-content: flex-end;
    gap: var(--space-md);
}

/* ãƒ•ãƒ¬ãƒƒã‚¯ã‚¹ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ */
.flex-1 {
    flex: 1;
}

.gap-xs {
    gap: var(--space-xs);
}

.mb-0 {
    margin-bottom: 0;
}

/* ã‚µãƒãƒªãƒ¼ãƒ¡ãƒˆãƒªã‚¯ã‚¹ */
.summary-metrics {
    border-top: 1px solid var(--gray-200);
    padding-top: var(--space-sm);
}

.metric-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--space-xs);
    font-size: var(--text-xs);
}

.metric-item:last-child {
    margin-bottom: 0;
}

.metric-label {
    color: var(--gray-600);
    font-weight: var(--font-medium);
}

.metric-value {
    font-weight: var(--font-semibold);
}

.metric-value.positive {
    color: var(--success-green);
}

.metric-value.negative {
    color: var(--error-red);
}

.metric-value.high {
    color: var(--warning-yellow);
}

.metric-value.critical {
    color: var(--error-red);
}

.metric-value.medium {
    color: var(--warning-yellow);
}

.metric-value.required {
    color: var(--error-red);
    font-weight: var(--font-bold);
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ– */
@media (max-width: 768px) {
    .fixed-bottom-bar {
        left: 0;
    }
    
    .flex-wrap {
        flex-wrap: wrap;
    }
}
</style>

{% endblock %}

{% block extra_js %}
<script>
// ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã®åˆ‡ã‚Šæ›¿ãˆ
function setViewMode(mode) {
    console.log('setViewMode called with:', mode);
    
    // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
    document.querySelectorAll('.view-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    document.querySelector(`[data-view="${mode}"]`).classList.add('active');
    
    // bodyã«ã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ /å‰Šé™¤
    if (mode === 'detailed') {
        document.body.classList.add('detailed-mode');
        console.log('Added detailed-mode class to body');
    } else {
        document.body.classList.remove('detailed-mode');
        console.log('Removed detailed-mode class from body');
    }
    
    // ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®åŒæœŸ
    syncCheckboxes();
    
    // LocalStorageã«ä¿å­˜
    localStorage.setItem('dialogueViewMode', mode);
    
    // ãƒ‡ãƒãƒƒã‚°: ç¾åœ¨ã®è¡¨ç¤ºçŠ¶æ…‹ã‚’ç¢ºèª
    const simpleRows = document.querySelectorAll('tbody tr.simple-view');
    const detailedRows = document.querySelectorAll('tbody tr.detailed-view');
    console.log('Simple rows:', simpleRows.length);
    console.log('Detailed rows:', detailedRows.length);
    console.log('Body has detailed-mode class:', document.body.classList.contains('detailed-mode'));
}

// ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®åŒæœŸ
function syncCheckboxes() {
    const isDetailedMode = document.body.classList.contains('detailed-mode');
    const selectAll = isDetailedMode ? document.getElementById('selectAllDetailed') : document.getElementById('selectAll');
    const checkboxes = document.querySelectorAll(`tbody tr.${isDetailedMode ? 'detailed' : 'simple'}-view input[type="checkbox"]`);
    
    // å…¨é¸æŠãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã®çŠ¶æ…‹ã‚’æ›´æ–°
    if (selectAll) {
        selectAll.checked = Array.from(checkboxes).every(cb => cb.checked);
    }
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ä¿å­˜ã•ã‚ŒãŸãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰ã‚’é©ç”¨
window.addEventListener('DOMContentLoaded', function() {
    const savedMode = localStorage.getItem('dialogueViewMode') || 'simple';
    if (savedMode === 'detailed') {
        setViewMode('detailed');
    }
});

// ç·¨é›†ç”»é¢ã¸ã®é·ç§»
function editDialogue(recordId) {
    window.location.href = `/dialogue/edit?id=${recordId}`;
}

// ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ç®¡ç†
function setupCheckboxListeners() {
    // å…¨é¸æŠãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
    ['selectAll', 'selectAllDetailed'].forEach(id => {
        const checkbox = document.getElementById(id);
        if (checkbox) {
            checkbox.addEventListener('change', function() {
                const isDetailedMode = document.body.classList.contains('detailed-mode');
                const viewClass = isDetailedMode ? 'detailed-view' : 'simple-view';
                const checkboxes = document.querySelectorAll(`tbody tr.${viewClass} input[type="checkbox"]`);
                checkboxes.forEach(cb => cb.checked = this.checked);
                updateBulkActionBar();
            });
        }
    });
    
    // å€‹åˆ¥ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹
    document.querySelectorAll('tbody input[type="checkbox"]').forEach(cb => {
        cb.addEventListener('change', function() {
            updateBulkActionBar();
            syncCheckboxes();
        });
    });
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒªã‚¹ãƒŠãƒ¼ã‚’è¨­å®š
window.addEventListener('DOMContentLoaded', function() {
    setupCheckboxListeners();
});

// ä¸€æ‹¬æ“ä½œãƒãƒ¼ã®æ›´æ–°
function updateBulkActionBar() {
    const isDetailedMode = document.body.classList.contains('detailed-mode');
    const viewClass = isDetailedMode ? 'detailed-view' : 'simple-view';
    const checkedBoxes = document.querySelectorAll(`tbody tr.${viewClass} input[type="checkbox"]:checked`);
    const count = checkedBoxes.length;
    const bulkActionBar = document.getElementById('bulkActionBar');
    
    if (count > 0) {
        document.getElementById('selectedCount').textContent = count;
        bulkActionBar.style.display = 'block';
    } else {
        bulkActionBar.style.display = 'none';
    }
}

// è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«ã®è¡¨ç¤º
let currentRecordId = null; // ç¾åœ¨è¡¨ç¤ºä¸­ã®è¨˜éŒ²ID

function showDetailModal(recordId) {
    currentRecordId = recordId; // IDã‚’ä¿å­˜
    const modal = document.getElementById('detailModal');
    const modalBody = modal.querySelector('.modal-body');
    
    // ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒ—ã«å¿œã˜ã¦é©åˆ‡ãªå†…å®¹ã‚’è¡¨ç¤º
    if (recordId.startsWith('meeting_')) {
        modalBody.innerHTML = getMeetingDetailContent();
    } else if (recordId.startsWith('email_')) {
        modalBody.innerHTML = getEmailDetailContent();
    } else if (recordId.startsWith('voice_')) {
        modalBody.innerHTML = getVoiceDetailContent();
    } else if (recordId.startsWith('doc_')) {
        modalBody.innerHTML = getDocumentDetailContent();
    }
    
    modal.style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

// Webä¼šè­°ã®è©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
function getMeetingDetailContent() {
    return `
        <!-- åŸºæœ¬æƒ…å ± -->
        <div class="card mb-lg">
            <div class="card-header">
                <h3 class="text-lg font-semibold">ğŸ“‹ åŸºæœ¬æƒ…å ±</h3>
            </div>
            <div class="card-body">
                <div class="grid grid-cols-2 gap-md">
                    <div class="form-group">
                        <label class="form-label">ã‚¿ã‚¤ãƒˆãƒ«</label>
                        <input type="text" class="form-control" value="2024å¹´ç¬¬3å››åŠæœŸæ±ºç®—èª¬æ˜ä¼š">
                    </div>
                    <div class="form-group">
                        <label class="form-label">é–‹å‚¬æ—¥æ™‚</label>
                        <input type="datetime-local" class="form-control" value="2024-01-15T14:00">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ä¼šè­°ã‚·ã‚¹ãƒ†ãƒ </label>
                        <select class="form-control">
                            <option selected>Zoom</option>
                            <option>Teams</option>
                            <option>Webex</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å‚åŠ è€…æ•°</label>
                        <input type="number" class="form-control" value="156">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ä¸»ãªå‚åŠ è€…</label>
                    <div class="tag-input">
                        <span class="tag">CEO å±±ç”°å¤ªéƒ</span>
                        <span class="tag">CFO éˆ´æœ¨èŠ±å­</span>
                        <span class="tag">æ©Ÿé–¢æŠ•è³‡å®¶ï¼ˆ120åï¼‰</span>
                        <span class="tag">å€‹äººæŠ•è³‡å®¶ï¼ˆ30åï¼‰</span>
                        <input type="text" class="form-control" placeholder="å‚åŠ è€…ã‚’è¿½åŠ ...">
                    </div>
                    <div class="faq-candidate">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-semibold">Q: ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢æ¡ç”¨ã®å…·ä½“çš„ãªç›®æ¨™ã¯ï¼Ÿ</h4>
                                <p class="text-sm text-muted mt-sm">A: 2025å¹´åº¦æœ«ã¾ã§ã«200åä½“åˆ¶ã‚’ç›®æŒ‡ã—ã€ç¾åœ¨150åã¾ã§å¢—å¼·ã€‚æ–°å’ãƒ»ä¸­é€”æ¡ç”¨ã‚’ãƒãƒ©ãƒ³ã‚¹è‰¯ãé€²ã‚ã€ç‰¹ã«AIãƒ»æ©Ÿæ¢°å­¦ç¿’åˆ†é‡ã®ã‚¹ãƒšã‚·ãƒ£ãƒªã‚¹ãƒˆç¢ºä¿ã«æ³¨åŠ›ã—ã¦ã„ã¾ã™ã€‚</p>
                            </div>
                            <div class="flex gap-sm">
                                <span class="confidence-badge confidence-high">ä¿¡é ¼åº¦: 95%</span>
                                <label class="flex items-center gap-sm">
                                    <input type="checkbox" checked>
                                    <span>æ¡ç”¨</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="text-center mt-md">
                    <button class="btn btn-sm btn-secondary">ã™ã¹ã¦ã®FAQå€™è£œã‚’è¡¨ç¤º</button>
                </div>
            </div>
        </div>

        <!-- ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã‚¿ã‚¹ã‚¯ -->
        <div class="card mb-lg">
            <div class="card-header">
                <h3 class="text-lg font-semibold">ğŸ“‹ ãƒ•ã‚©ãƒ­ãƒ¼ã‚¢ãƒƒãƒ—ã‚¿ã‚¹ã‚¯</h3>
            </div>
            <div class="card-body">
                <div class="task-list">
                    <div class="task-item">
                        <input type="checkbox" id="task1">
                        <label for="task1">
                            <span class="task-title">ç«¶åˆåˆ†æãƒ¬ãƒãƒ¼ãƒˆã®æ›´æ–°</span>
                            <span class="task-meta">æœŸé™: 2025/01/31 â€¢ æ‹…å½“: äº‹æ¥­ä¼ç”»éƒ¨</span>
                        </label>
                    </div>
                    <div class="task-item">
                        <input type="checkbox" id="task2">
                        <label for="task2">
                            <span class="task-title">äººæç¢ºä¿æˆ¦ç•¥ã®è©³ç´°è³‡æ–™ä½œæˆ</span>
                            <span class="task-meta">æœŸé™: 2025/01/25 â€¢ æ‹…å½“: äººäº‹éƒ¨</span>
                        </label>
                    </div>
                    <div class="task-item">
                        <input type="checkbox" id="task3">
                        <label for="task3">
                            <span class="task-title">AIäº‹æ¥­ã®æˆé•·æˆ¦ç•¥ãƒ—ãƒ¬ã‚¼ãƒ³è³‡æ–™æ›´æ–°</span>
                            <span class="task-meta">æœŸé™: 2025/02/05 â€¢ æ‹…å½“: AIäº‹æ¥­éƒ¨</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- AIåˆ†æçµæœ -->
        <div class="card mb-lg">
            <div class="card-header">
                <h3 class="text-lg font-semibold">ğŸ¤– AIåˆ†æçµæœ</h3>
            </div>
            <div class="card-body">
                <div class="alert alert-info mb-md">
                    <h4 class="font-semibold mb-sm">ğŸ“ å¯¾è©±ã‚µãƒãƒªãƒ¼</h4>
                    <p>ç¬¬3å››åŠæœŸã®å¥½èª¿ãªæ¥­ç¸¾ï¼ˆå£²ä¸Šé«˜å‰å¹´åŒæœŸæ¯”15%å¢—ã€ç‰¹ã«AIäº‹æ¥­35%å¢—ï¼‰ã‚’å ±å‘Šã€‚æŠ•è³‡å®¶ã‹ã‚‰ã¯ä»Šå¾Œã®æˆé•·æˆ¦ç•¥ã€DXæŠ•è³‡è¨ˆç”»ã€ESGç›®æ¨™ã«ã¤ã„ã¦å¤šæ•°ã®è³ªå•ã€‚å…¨ä½“çš„ã«ãƒã‚¸ãƒ†ã‚£ãƒ–ãªåå¿œã‚’å¾—ãŸãŒã€ç«¶åˆä»–ç¤¾ã®å‹•å‘ã¨äººæç¢ºä¿ã«ã¤ã„ã¦ã¯æ…é‡ãªè¦‹æ–¹ã‚‚ç¤ºã•ã‚ŒãŸã€‚</p>
                </div>
                
                <div class="grid grid-cols-2 gap-md">
                    <div>
                        <h4 class="font-semibold mb-sm">ğŸ“Š ä¸»è¦ãƒˆãƒ”ãƒƒã‚¯</h4>
                        <ul class="list-disc list-inside space-y-sm">
                            <li>æµ·å¤–äº‹æ¥­ã®æˆé•·æˆ¦ç•¥ï¼ˆ35%ã®æ™‚é–“ï¼‰</li>
                            <li>DXæŠ•è³‡è¨ˆç”»ï¼ˆ25%ã®æ™‚é–“ï¼‰</li>
                            <li>ESGç›®æ¨™ã¨æ–½ç­–ï¼ˆ20%ã®æ™‚é–“ï¼‰</li>
                            <li>è²¡å‹™çŠ¶æ³ãƒ»é…å½“æ–¹é‡ï¼ˆ20%ã®æ™‚é–“ï¼‰</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold mb-sm">ğŸ˜Š æŠ•è³‡å®¶ã‚»ãƒ³ãƒãƒ¡ãƒ³ãƒˆ</h4>
                        <div class="sentiment-chart">
                            <div class="sentiment-bar positive" style="width: 75%;">ãƒã‚¸ãƒ†ã‚£ãƒ– 75%</div>
                            <div class="sentiment-bar neutral" style="width: 20%;">ä¸­ç«‹ 20%</div>
                            <div class="sentiment-bar negative" style="width: 5%;">ãƒã‚¬ãƒ†ã‚£ãƒ– 5%</div>
                        </div>
                        <div class="mt-md">
                            <h5 class="font-medium mb-sm">âš ï¸ æ¤œå‡ºã•ã‚ŒãŸèª²é¡Œãƒ»æ‡¸å¿µ</h5>
                            <ul class="concern-list-compact">
                                <li class="concern-high">ğŸ”´ äººæç¢ºä¿ã®æŒç¶šå¯èƒ½æ€§ã¸ã®æ‡¸å¿µ</li>
                                <li class="concern-medium">ğŸŸ¡ ç«¶åˆä»–ç¤¾ã®è¿½ã„ä¸Šã’ãƒªã‚¹ã‚¯</li>
                                <li class="concern-low">ğŸŸ¢ æµ·å¤–å±•é–‹ã®ã‚¹ãƒ”ãƒ¼ãƒ‰æ„Ÿ</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FAQå€™è£œ -->
        <div class="card mb-lg">
            <div class="card-header flex justify-between items-center">
                <h3 class="text-lg font-semibold">â“ FAQå€™è£œï¼ˆ12ä»¶ï¼‰</h3>
                <button class="btn btn-sm btn-primary">ã™ã¹ã¦æ¡ç”¨</button>
            </div>
            <div class="card-body">
                <div class="space-y-md">
                    <div class="faq-candidate">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-semibold">Q: AIäº‹æ¥­ã®æˆé•·ç‡35%ã®è¦å› ã¯ï¼Ÿ</h4>
                                <p class="text-sm text-muted mt-sm">A: ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºSaaSã®å¥½èª¿ã€æ–°è£½å“ã®å¸‚å ´æŠ•å…¥ã€æ—¢å­˜é¡§å®¢ã®ã‚¢ãƒƒãƒ—ã‚»ãƒ«ãŒå¯„ä¸ã—ã¾ã—ãŸã€‚ç‰¹ã«å¤§æ‰‹ä¼æ¥­å‘ã‘AIã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã®æ¡ç”¨ãŒåŠ é€Ÿã—ã¦ã„ã¾ã™ã€‚</p>
                            </div>
                            <div class="flex gap-sm">
                                <span class="confidence-badge confidence-high">ä¿¡é ¼åº¦: 98%</span>
                                <label class="flex items-center gap-sm">
                                    <input type="checkbox" checked>
                                    <span>æ¡ç”¨</span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- å…¬é–‹è¨­å®š -->
        <div class="card">
            <div class="card-header">
                <h3 class="text-lg font-semibold">ğŸ”’ å…¬é–‹è¨­å®š</h3>
            </div>
            <div class="card-body">
                <div class="grid grid-cols-2 gap-md">
                    <div class="form-group">
                        <label class="form-label">å…¬é–‹ç¯„å›²</label>
                        <select class="form-control">
                            <option>éå…¬é–‹ï¼ˆIRéƒ¨é–€ã®ã¿ï¼‰</option>
                            <option>ç¤¾å†…å…¬é–‹</option>
                            <option selected>æŠ•è³‡å®¶é™å®šå…¬é–‹</option>
                            <option>ä¸€èˆ¬å…¬é–‹</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">å…¬é–‹æ—¥æ™‚</label>
                        <input type="datetime-local" class="form-control" value="2024-01-15T18:00">
                    </div>
                </div>
            </div>
        </div>
    `;
}

// ãƒ¡ãƒ¼ãƒ«ã®è©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
function getEmailDetailContent() {
    return `
        <!-- åŸºæœ¬æƒ…å ± -->
        <div class="card mb-lg">
            <div class="card-header">
                <h3 class="text-lg font-semibold">ğŸ“§ ãƒ¡ãƒ¼ãƒ«æƒ…å ±</h3>
            </div>
            <div class="card-body">
                <div class="grid grid-cols-2 gap-md">
                    <div class="form-group">
                        <label class="form-label">é€ä¿¡è€…</label>
                        <input type="text" class="form-control" value="æ©Ÿé–¢æŠ•è³‡å®¶Aç¤¾ ç”°ä¸­æ§˜">
                    </div>
                    <div class="form-group">
                        <label class="form-label">å—ä¿¡æ—¥æ™‚</label>
                        <input type="datetime-local" class="form-control" value="2024-01-14T16:23">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ä»¶å</label>
                        <input type="text" class="form-control" value="é…å½“æ”¿ç­–ã«é–¢ã™ã‚‹è³ªå•">
                    </div>
                    <div class="form-group">
                        <label class="form-label">é‡è¦åº¦</label>
                        <select class="form-control">
                            <option>ä½</option>
                            <option selected>ä¸­</option>
                            <option>é«˜</option>
                            <option>ç·Šæ€¥</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ãƒ¡ãƒ¼ãƒ«æœ¬æ–‡</label>
                    <div class="email-content">
                        <p>ã„ã¤ã‚‚ãŠä¸–è©±ã«ãªã£ã¦ãŠã‚Šã¾ã™ã€‚</p>
                        <p>è²´ç¤¾ã®é…å½“æ”¿ç­–ã«ã¤ã„ã¦ã€ä»¥ä¸‹ã®ç‚¹ã‚’ç¢ºèªã•ã›ã¦ã„ãŸã ããŸãã”é€£çµ¡ã„ãŸã—ã¾ã—ãŸã€‚</p>
                        <ol>
                            <li>ä»ŠæœŸã®é…å½“æ€§å‘ç›®æ¨™ã«ã¤ã„ã¦</li>
                            <li>ä¸­æœŸçš„ãªæ ªä¸»é‚„å…ƒæ–¹é‡</li>
                            <li>è‡ªç¤¾æ ªè²·ã„ã®æ¤œè¨çŠ¶æ³</li>
                        </ol>
                        <p>ãŠå¿™ã—ã„ã¨ã“ã‚æç¸®ã§ã™ãŒã€ã”å›ç­”ã„ãŸã ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- AIåˆ†æãƒ»å›ç­”æ¡ˆ -->
        <div class="card mb-lg">
            <div class="card-header">
                <h3 class="text-lg font-semibold">ğŸ¤– AIåˆ†æãƒ»å›ç­”æ¡ˆ</h3>
            </div>
            <div class="card-body">
                <div class="alert alert-warning mb-md">
                    <span>âš ï¸</span>
                    <span>é…å½“æ”¿ç­–ã«é–¢ã™ã‚‹é‡è¦ãªè³ªå•ã§ã™ã€‚çµŒå–¶é™£ã®æ‰¿èªãŒå¿…è¦ãªå¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</span>
                </div>
                
                <div class="form-group">
                    <label class="form-label">å›ç­”æ¡ˆ</label>
                    <textarea class="form-control" rows="10">
ç”°ä¸­æ§˜

ãŠå•ã„åˆã‚ã›ã„ãŸã ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚
é…å½“æ”¿ç­–ã«ã¤ã„ã¦ä»¥ä¸‹ã®ã¨ãŠã‚Šå›ç­”ã„ãŸã—ã¾ã™ã€‚

1. ä»ŠæœŸã®é…å½“æ€§å‘ç›®æ¨™
   å½“ç¤¾ã¯å®‰å®šé…å½“ã‚’åŸºæœ¬æ–¹é‡ã¨ã—ã€ä»ŠæœŸã¯é…å½“æ€§å‘30%ã‚’ç›®æ¨™ã¨ã—ã¦ãŠã‚Šã¾ã™ã€‚

2. ä¸­æœŸçš„ãªæ ªä¸»é‚„å…ƒæ–¹é‡
   ä»Šå¾Œ3å¹´é–“ã§é…å½“æ€§å‘ã‚’æ®µéšçš„ã«35%ã¾ã§å¼•ãä¸Šã’ã‚‹äºˆå®šã§ã™ã€‚
   æ¥­ç¸¾å‘ä¸Šã«å¿œã˜ã¦ã€æ ªä¸»ã®çš†æ§˜ã¸ã®é‚„å…ƒã‚’å¼·åŒ–ã—ã¦ã¾ã„ã‚Šã¾ã™ã€‚

3. è‡ªç¤¾æ ªè²·ã„ã®æ¤œè¨çŠ¶æ³
   ç¾æ™‚ç‚¹ã§ã¯å…·ä½“çš„ãªè¨ˆç”»ã¯ã”ã–ã„ã¾ã›ã‚“ãŒã€è³‡æœ¬åŠ¹ç‡å‘ä¸Šã®è¦³ç‚¹ã‹ã‚‰
   ç¶™ç¶šçš„ã«æ¤œè¨ã—ã¦ã¾ã„ã‚Šã¾ã™ã€‚

ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚

IRéƒ¨ éˆ´æœ¨
                    </textarea>
                </div>
                
                <div class="flex gap-md">
                    <button class="btn btn-primary">ã“ã®å†…å®¹ã§è¿”ä¿¡</button>
                    <button class="btn btn-secondary">ä¸‹æ›¸ãä¿å­˜</button>
                    <button class="btn btn-secondary">æ‰¿èªä¾é ¼</button>
                </div>
            </div>
        </div>
    `;
}

// éŸ³å£°ã®è©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
function getVoiceDetailContent() {
    // åŸºæœ¬çš„ã«Webä¼šè­°ã¨åŒæ§˜ã®æ§‹é€ ã ãŒã€éŸ³å£°ç‰¹æœ‰ã®è¦ç´ ã‚’è¿½åŠ 
    return getMeetingDetailContent();
}

// æ–‡æ›¸ã®è©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
function getDocumentDetailContent() {
    return `
        <!-- åŸºæœ¬æƒ…å ± -->
        <div class="card mb-lg">
            <div class="card-header">
                <h3 class="text-lg font-semibold">ğŸ“„ æ–‡æ›¸æƒ…å ±</h3>
            </div>
            <div class="card-body">
                <div class="grid grid-cols-2 gap-md">
                    <div class="form-group">
                        <label class="form-label">æ–‡æ›¸å</label>
                        <input type="text" class="form-control" value="å–ç· å½¹ä¼šè­°äº‹éŒ²_20240110">
                    </div>
                    <div class="form-group">
                        <label class="form-label">æ–‡æ›¸ã‚¿ã‚¤ãƒ—</label>
                        <select class="form-control">
                            <option>æ±ºç®—è³‡æ–™</option>
                            <option>èª¬æ˜ä¼šè³‡æ–™</option>
                            <option selected>è­°äº‹éŒ²</option>
                            <option>é©æ™‚é–‹ç¤º</option>
                            <option>ãã®ä»–</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">ä½œæˆæ—¥</label>
                        <input type="date" class="form-control" value="2024-01-10">
                    </div>
                    <div class="form-group">
                        <label class="form-label">ãƒšãƒ¼ã‚¸æ•°</label>
                        <input type="number" class="form-control" value="15">
                    </div>
                </div>
            </div>
        </div>

        <!-- AIæŠ½å‡ºæƒ…å ± -->
        <div class="card mb-lg">
            <div class="card-header">
                <h3 class="text-lg font-semibold">ğŸ¤– AIæŠ½å‡ºæƒ…å ±</h3>
            </div>
            <div class="card-body">
                <h4 class="font-semibold mb-sm">ğŸ“Œ é‡è¦äº‹é …ï¼ˆ8ä»¶ï¼‰</h4>
                <div class="space-y-sm mb-md">
                    <div class="alert alert-warning">
                        <strong>ä¸­æœŸçµŒå–¶è¨ˆç”»ã®ä¿®æ­£æ‰¿èª</strong>
                        <p class="text-sm mt-sm">DXæŠ•è³‡ã‚’50å„„å††ã‹ã‚‰70å„„å††ã«å¢—é¡ã™ã‚‹ã“ã¨ã‚’æ‰¿èª</p>
                    </div>
                    <div class="alert alert-info">
                        <strong>é…å½“æ–¹é‡ã®å¤‰æ›´</strong>
                        <p class="text-sm mt-sm">é…å½“æ€§å‘ã‚’30%ã‹ã‚‰35%ã«å¼•ãä¸Šã’ã‚‹ã“ã¨ã‚’æ±ºè­°</p>
                    </div>
                </div>
                
                <h4 class="font-semibold mb-sm">ğŸ”¢ æŠ½å‡ºã•ã‚ŒãŸæ•°å€¤æƒ…å ±</h4>
                <table class="table">
                    <tr>
                        <td>DXæŠ•è³‡é¡</td>
                        <td class="font-semibold">70å„„å††</td>
                    </tr>
                    <tr>
                        <td>é…å½“æ€§å‘</td>
                        <td class="font-semibold">35%</td>
                    </tr>
                    <tr>
                        <td>å£²ä¸Šé«˜ç›®æ¨™ï¼ˆ3å¹´å¾Œï¼‰</td>
                        <td class="font-semibold">1,500å„„å††</td>
                    </tr>
                </table>
            </div>
        </div>
    `;
}

// è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‰ã˜ã‚‹
function closeDetailModal() {
    document.getElementById('detailModal').style.display = 'none';
    document.body.style.overflow = 'auto';
}

// ãƒ¢ãƒ¼ãƒ€ãƒ«ã‹ã‚‰ç·¨é›†ç”»é¢ã¸
function editFromModal() {
    if (currentRecordId) {
        window.location.href = `/dialogue/edit?id=${currentRecordId}`;
    }
}

// ã‚¿ã‚°å…¥åŠ›ã®å‡¦ç†
document.addEventListener('click', function(e) {
    if (e.target.classList.contains('tag-input') || e.target.parentElement?.classList.contains('tag-input')) {
        const input = e.target.querySelector('input') || e.target;
        if (input.tagName === 'INPUT') {
            input.focus();
        }
    }
});

// ã‚¹ã‚¿ã‚¤ãƒ«è¿½åŠ 
const style = document.createElement('style');
style.textContent = `
.email-content {
    background-color: var(--gray-50);
    padding: var(--space-md);
    border-radius: var(--border-radius-md);
    font-family: monospace;
}

.sentiment-chart {
    display: flex;
    flex-direction: column;
    gap: var(--space-xs);
}

.sentiment-bar {
    padding: var(--space-xs) var(--space-sm);
    border-radius: var(--border-radius-sm);
    font-size: var(--text-sm);
    font-weight: var(--font-medium);
    text-align: center;
}

.sentiment-bar.positive {
    background-color: rgba(16, 185, 129, 0.2);
    color: var(--success-green);
}

.sentiment-bar.neutral {
    background-color: rgba(107, 114, 128, 0.2);
    color: var(--gray-600);
}

.sentiment-bar.negative {
    background-color: rgba(239, 68, 68, 0.2);
    color: var(--error-red);
}

.tag-input {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-sm);
    align-items: center;
    padding: var(--space-sm);
    border: 1px solid var(--gray-300);
    border-radius: var(--border-radius-md);
    background-color: white;
}

.tag {
    display: inline-flex;
    align-items: center;
    padding: var(--space-xs) var(--space-sm);
    background-color: var(--kagami-blue);
    color: white;
    border-radius: var(--border-radius-full);
    font-size: var(--text-sm);
}

.tag-input input {
    flex: 1;
    min-width: 150px;
    border: none;
    outline: none;
    padding: var(--space-xs);
}

.confidence-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    padding: var(--space-xs) var(--space-sm);
    background-color: var(--gray-100);
    border-radius: var(--border-radius-full);
    font-size: var(--text-xs);
    font-weight: var(--font-medium);
}

.confidence-high {
    background-color: rgba(16, 185, 129, 0.1);
    color: var(--success-green);
}

.faq-candidate {
    padding: var(--space-md);
    background-color: var(--gray-50);
    border-radius: var(--border-radius-md);
    border: 1px solid var(--gray-200);
}

/* æ‡¸å¿µãƒªã‚¹ãƒˆï¼ˆã‚³ãƒ³ãƒ‘ã‚¯ãƒˆï¼‰ */
.concern-list-compact {
    list-style: none;
    padding: 0;
    margin: 0;
}

.concern-list-compact li {
    padding: var(--space-xs) var(--space-sm);
    margin-bottom: var(--space-xs);
    border-radius: var(--border-radius-sm);
    font-size: var(--text-sm);
}

.concern-list-compact .concern-high {
    background-color: rgba(239, 68, 68, 0.1);
    color: var(--error-red);
}

.concern-list-compact .concern-medium {
    background-color: rgba(245, 158, 11, 0.1);
    color: var(--warning-yellow);
}

.concern-list-compact .concern-low {
    background-color: rgba(16, 185, 129, 0.1);
    color: var(--success-green);
}

/* ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ */
.task-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
}

.task-item {
    display: flex;
    align-items: center;
    gap: var(--space-sm);
    padding: var(--space-sm);
    background-color: var(--gray-50);
    border-radius: var(--border-radius-sm);
}

.task-item input[type="checkbox"] {
    cursor: pointer;
}

.task-item label {
    flex: 1;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.task-title {
    font-weight: var(--font-medium);
}

.task-meta {
    font-size: var(--text-sm);
    color: var(--gray-600);
}

.task-item input[type="checkbox"]:checked + label .task-title {
    text-decoration: line-through;
    color: var(--gray-500);
}

.grid {
    display: grid;
}

.grid-cols-2 {
    grid-template-columns: repeat(2, 1fr);
}

.gap-md {
    gap: var(--space-md);
}

.space-y-sm > * + * {
    margin-top: var(--space-sm);
}

.space-y-md > * + * {
    margin-top: var(--space-md);
}
`;
document.head.appendChild(style);
</script>
{% endblock %}
