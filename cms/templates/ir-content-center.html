{% extends 'base.html' %}

{% block title %}IRæƒ…å ±çµ±åˆã‚»ãƒ³ã‚¿ãƒ¼{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="/static/css/ir-management.css">
<style>
/* IRæƒ…å ±çµ±åˆã‚»ãƒ³ã‚¿ãƒ¼å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
.ir-content-center {
    display: grid;
    grid-template-columns: 320px 1fr 400px;
    grid-template-rows: auto 1fr;
    height: calc(100vh - 140px);
    gap: 1rem;
    grid-template-areas: 
        "content-stream workspace-header insight-panel"
        "content-stream workspace-main insight-panel";
    transition: grid-template-columns 0.3s ease;
}

.ir-content-center.insight-collapsed {
    grid-template-columns: 320px 1fr 0px;
    grid-template-areas: 
        "content-stream workspace-header insight-panel"
        "content-stream workspace-main insight-panel";
}

/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆå·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ */
.content-stream {
    grid-area: content-stream;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.stream-header {
    background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
    color: white;
    padding: 1.5rem;
}

.stream-filters {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
    flex-wrap: wrap;
}

.filter-chip {
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s;
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: rgba(255, 255, 255, 0.9);
}

.filter-chip.active {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.stream-content {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
}

/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚«ãƒ¼ãƒ‰ */
.content-card {
    border: 2px solid transparent;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 0.75rem;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    background: white;
    border-left: 4px solid #e5e7eb;
}

.content-card:hover {
    border-color: #d1d5db;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.content-card.selected {
    border-color: #7c3aed;
    background: #faf5ff;
}

.content-card.faq {
    border-left-color: #3b82f6;
}

.content-card.document {
    border-left-color: #10b981;
}

.content-card.news {
    border-left-color: #f59e0b;
}

.content-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 0.5rem;
}

.content-type {
    padding: 0.125rem 0.5rem;
    border-radius: 4px;
    font-size: 0.625rem;
    font-weight: 600;
}

.content-type.faq {
    background: rgba(59, 130, 246, 0.1);
    color: #3b82f6;
}

.content-type.document {
    background: rgba(16, 185, 129, 0.1);
    color: #10b981;
}

.content-type.news {
    background: rgba(245, 158, 11, 0.1);
    color: #f59e0b;
}

.content-title {
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.25rem;
    line-height: 1.3;
}

.content-meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.75rem;
    color: #6b7280;
}

.content-status {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    margin-top: 0.5rem;
}

.status-badge {
    padding: 0.125rem 0.375rem;
    border-radius: 4px;
    font-size: 0.625rem;
    font-weight: 500;
}

.status-published {
    background: rgba(16, 185, 129, 0.1);
    color: #10b981;
}

.status-draft {
    background: rgba(245, 158, 11, 0.1);
    color: #f59e0b;
}

.status-scheduled {
    background: rgba(59, 130, 246, 0.1);
    color: #3b82f6;
}

/* ãƒ¡ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ */
.workspace-header {
    grid-area: workspace-header;
    background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
    color: white;
    padding: 1.5rem;
    border-radius: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.workspace-main {
    grid-area: workspace-main;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

/* ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ */
.toolbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.5rem;
    border-bottom: 1px solid #e5e7eb;
    background: #f9fafb;
}

.toolbar-group {
    display: flex;
    gap: 0.5rem;
}

.btn-toolbar {
    padding: 0.5rem 1rem;
    border: 1px solid #d1d5db;
    border-radius: 6px;
    background: white;
    color: #374151;
    font-size: 0.875rem;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.btn-toolbar:hover {
    background: #f3f4f6;
    border-color: #9ca3af;
}

.btn-toolbar.active {
    background: #7c3aed;
    color: white;
    border-color: #6d28d9;
}

/* ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
.view-content {
    flex: 1;
    padding: 1.5rem;
    overflow-y: auto;
}

.view-content.hidden {
    display: none;
}

/* ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ“ãƒ¥ãƒ¼ */
.dashboard-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-card {
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 8px;
    padding: 1.5rem;
    transition: all 0.2s;
}

.stat-card:hover {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: #1f2937;
    margin-bottom: 0.25rem;
}

.stat-label {
    color: #6b7280;
    font-size: 0.875rem;
}

.stat-change {
    margin-top: 0.5rem;
    font-size: 0.75rem;
    display: flex;
    align-items: center;
    gap: 0.25rem;
}

.stat-change.positive {
    color: #10b981;
}

.stat-change.negative {
    color: #ef4444;
}

/* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ« */
.lifecycle-flow {
    display: flex;
    justify-content: space-between;
    margin-bottom: 2rem;
    background: #f8fafc;
    border-radius: 12px;
    padding: 2rem;
    border: 1px solid #e2e8f0;
}

.lifecycle-stage {
    text-align: center;
    flex: 1;
    position: relative;
}

.lifecycle-stage:not(:last-child)::after {
    content: '';
    position: absolute;
    top: 20px;
    right: -25px;
    width: 50px;
    height: 2px;
    background: #e2e8f0;
}

.stage-icon {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: #e5e7eb;
    color: #6b7280;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 0.5rem;
    font-weight: 600;
}

.stage-icon.active {
    background: #7c3aed;
    color: white;
}

.stage-label {
    font-size: 0.875rem;
    color: #374151;
    font-weight: 500;
}

.stage-count {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 0.25rem;
}

/* ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ï¼ˆå³ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ */
.insight-panel {
    grid-area: insight-panel;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
    position: relative;
}

.insight-panel.collapsed {
    width: 0;
    min-width: 0;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
}

.insight-toggle {
    position: fixed;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    width: 40px;
    height: 80px;
    background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
    border-radius: 20px 0 0 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 100;
    transition: all 0.3s ease;
    box-shadow: -2px 0 8px rgba(0, 0, 0, 0.15);
    border: 2px solid rgba(255, 255, 255, 0.2);
}

.insight-toggle:hover {
    background: linear-gradient(135deg, #6d28d9 0%, #9333ea 100%);
    transform: translateY(-50%) translateX(-3px);
    box-shadow: -4px 0 12px rgba(0, 0, 0, 0.25);
}

.ir-content-center.insight-collapsed .insight-toggle {
    right: 0px;
    border-radius: 0 20px 20px 0;
    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.15);
}

.ir-content-center.insight-collapsed .insight-toggle:hover {
    transform: translateY(-50%) translateX(3px);
    box-shadow: 4px 0 12px rgba(0, 0, 0, 0.25);
}

.insight-toggle-icon {
    color: white;
    font-size: 1.4rem;
    font-weight: bold;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.insight-toggle-text {
    writing-mode: sideways-lr;
    font-size: 0.7rem;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.9);
    margin-top: 0.5rem;
    text-align: center;
}

.ir-content-center.insight-collapsed .insight-toggle-icon {
    transform: rotate(180deg);
}

.ir-content-center.insight-collapsed .insight-toggle-text {
    writing-mode: sideways-rl;
}

.insight-header {
    background: linear-gradient(135deg, #7c3aed 0%, #a855f7 100%);
    color: white;
    padding: 1.5rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.insight-content {
    flex: 1;
    padding: 1rem;
    overflow-y: auto;
}

/* é–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
.related-content {
    margin-bottom: 1.5rem;
}

.related-item {
    padding: 0.75rem;
    border: 1px solid #e5e7eb;
    border-radius: 6px;
    margin-bottom: 0.5rem;
    cursor: pointer;
    transition: all 0.2s;
}

.related-item:hover {
    background: #f9fafb;
    border-color: #d1d5db;
}

.related-title {
    font-size: 0.875rem;
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.25rem;
}

.related-meta {
    font-size: 0.75rem;
    color: #6b7280;
}

/* ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ */
.analytics-widget {
    background: #f8fafc;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.widget-title {
    font-weight: 600;
    color: #374151;
    margin-bottom: 0.75rem;
    font-size: 0.875rem;
}

.metric-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid #e5e7eb;
}

.metric-item:last-child {
    border-bottom: none;
}

.metric-label {
    font-size: 0.75rem;
    color: #6b7280;
}

.metric-value {
    font-weight: 600;
    color: #374151;
}

/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ« */
.action-item {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.75rem;
    border: 1px solid #e5e7eb;
    border-radius: 6px;
    margin-bottom: 0.5rem;
    background: white;
    cursor: pointer;
    transition: all 0.2s;
}

.action-item:hover {
    background: #f9fafb;
    border-color: #d1d5db;
}

.action-priority {
    width: 8px;
    height: 8px;
    border-radius: 50%;
}

.action-priority.high {
    background: #ef4444;
}

.action-priority.medium {
    background: #f59e0b;
}

.action-priority.low {
    background: #10b981;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
@media (max-width: 1024px) {
    .ir-content-center {
        grid-template-columns: 280px 1fr 350px;
    }
    
    .ir-content-center.insight-collapsed {
        grid-template-columns: 280px 1fr 0px;
    }
}

@media (max-width: 768px) {
    .ir-content-center {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto 1fr;
        grid-template-areas: 
            "workspace-header"
            "content-stream"
            "workspace-main";
    }
    
    .insight-panel {
        display: none;
    }
    
    .insight-toggle {
        display: none;
    }
    
    .content-stream {
        max-height: 200px;
    }
}

@media (max-width: 1024px) {
    .insight-toggle {
        width: 35px;
        height: 70px;
        right: 10px;
    }
    
    .ir-content-center.insight-collapsed .insight-toggle {
        right: -5px;
    }
    
    .insight-toggle-icon {
        font-size: 1.2rem;
    }
    
    .insight-toggle-text {
        font-size: 0.6rem;
    }
}

/* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ */
.stream-content::-webkit-scrollbar,
.view-content::-webkit-scrollbar,
.insight-content::-webkit-scrollbar {
    width: 6px;
}

.stream-content::-webkit-scrollbar-track,
.view-content::-webkit-scrollbar-track,
.insight-content::-webkit-scrollbar-track {
    background: #f1f5f9;
}

.stream-content::-webkit-scrollbar-thumb,
.view-content::-webkit-scrollbar-thumb,
.insight-content::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 3px;
}

.stream-content::-webkit-scrollbar-thumb:hover,
.view-content::-webkit-scrollbar-thumb:hover,
.insight-content::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
}
</style>
{% endblock %}

{% block content %}
<div class="ir-content-center">
    <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆå·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ -->
    <div class="content-stream">
        <div class="stream-header">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-lg font-bold">IRæƒ…å ±ã‚¹ãƒˆãƒªãƒ¼ãƒ </h3>
                <span id="streamCount" class="text-sm opacity-75">248ä»¶</span>
            </div>
            <div class="stream-filters">
                <div class="filter-chip active" onclick="filterContent('all')">å…¨ã¦</div>
                <div class="filter-chip" onclick="filterContent('faq')">FAQ (156)</div>
                <div class="filter-chip" onclick="filterContent('document')">è³‡æ–™ (67)</div>
                <div class="filter-chip" onclick="filterContent('news')">ãƒ‹ãƒ¥ãƒ¼ã‚¹ (25)</div>
                <div class="filter-chip" onclick="filterContent('urgent')">ç·Šæ€¥ (8)</div>
                <div class="filter-chip" onclick="filterContent('today')">ä»Šæ—¥ (12)</div>
            </div>
        </div>
        
        <div class="stream-content">
            <!-- FAQã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <div class="content-card faq selected" onclick="selectContent('content-001', 'faq')">
                <div class="content-header">
                    <span class="content-type faq">FAQ</span>
                    <div class="content-meta">
                        <span>2æ™‚é–“å‰</span>
                    </div>
                </div>
                <div class="content-title">2024å¹´ç¬¬3å››åŠæœŸã®æ¥­ç¸¾è¦‹é€šã—ã«ã¤ã„ã¦</div>
                <div class="content-meta">
                    <span>ğŸ“Š è²¡å‹™ãƒ»æ¥­ç¸¾</span>
                    <span>â€¢</span>
                    <span>ğŸ‘ï¸ 128å›</span>
                </div>
                <div class="content-status">
                    <span class="status-badge status-published">å…¬é–‹æ¸ˆã¿</span>
                    <div class="action-priority high"></div>
                </div>
            </div>
            
            <!-- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <div class="content-card document" onclick="selectContent('content-002', 'document')">
                <div class="content-header">
                    <span class="content-type document">è³‡æ–™</span>
                    <div class="content-meta">
                        <span>5æ™‚é–“å‰</span>
                    </div>
                </div>
                <div class="content-title">2024å¹´ç¬¬3å››åŠæœŸæ±ºç®—çŸ­ä¿¡</div>
                <div class="content-meta">
                    <span>ğŸ“„ æ±ºç®—çŸ­ä¿¡</span>
                    <span>â€¢</span>
                    <span>â¬‡ï¸ 45å›</span>
                </div>
                <div class="content-status">
                    <span class="status-badge status-published">å…¬é–‹æ¸ˆã¿</span>
                    <div class="action-priority medium"></div>
                </div>
            </div>
            
            <!-- ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <div class="content-card news" onclick="selectContent('content-003', 'news')">
                <div class="content-header">
                    <span class="content-type news">ãƒ‹ãƒ¥ãƒ¼ã‚¹</span>
                    <div class="content-meta">
                        <span>1æ—¥å‰</span>
                    </div>
                </div>
                <div class="content-title">ç¬¬3å››åŠæœŸæ±ºç®—èª¬æ˜ä¼šã®é–‹å‚¬ã«ã¤ã„ã¦</div>
                <div class="content-meta">
                    <span>ğŸ“¢ ã‚¤ãƒ™ãƒ³ãƒˆ</span>
                    <span>â€¢</span>
                    <span>ğŸ‘ï¸ 234å›</span>
                </div>
                <div class="content-status">
                    <span class="status-badge status-published">å…¬é–‹æ¸ˆã¿</span>
                    <div class="action-priority low"></div>
                </div>
            </div>
            
            <!-- ãã®ä»–ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚«ãƒ¼ãƒ‰ -->
            <div class="content-card faq" onclick="selectContent('content-004', 'faq')">
                <div class="content-header">
                    <span class="content-type faq">FAQ</span>
                    <div class="content-meta">
                        <span>2æ—¥å‰</span>
                    </div>
                </div>
                <div class="content-title">ESGçµŒå–¶ã®å–ã‚Šçµ„ã¿ã«ã¤ã„ã¦</div>
                <div class="content-meta">
                    <span>ğŸŒ± ESG</span>
                    <span>â€¢</span>
                    <span>ğŸ‘ï¸ 89å›</span>
                </div>
                <div class="content-status">
                    <span class="status-badge status-published">å…¬é–‹æ¸ˆã¿</span>
                    <div class="action-priority medium"></div>
                </div>
            </div>
            
            <div class="content-card document" onclick="selectContent('content-005', 'document')">
                <div class="content-header">
                    <span class="content-type document">è³‡æ–™</span>
                    <div class="content-meta">
                        <span>3æ—¥å‰</span>
                    </div>
                </div>
                <div class="content-title">ä¸­æœŸçµŒå–¶è¨ˆç”»èª¬æ˜è³‡æ–™</div>
                <div class="content-meta">
                    <span>ğŸ“Š èª¬æ˜ä¼šè³‡æ–™</span>
                    <span>â€¢</span>
                    <span>â¬‡ï¸ 167å›</span>
                </div>
                <div class="content-status">
                    <span class="status-badge status-published">å…¬é–‹æ¸ˆã¿</span>
                    <div class="action-priority low"></div>
                </div>
            </div>
            
            <div class="content-card news" onclick="selectContent('content-006', 'news')">
                <div class="content-header">
                    <span class="content-type news">ãƒ‹ãƒ¥ãƒ¼ã‚¹</span>
                    <div class="content-meta">
                        <span>1é€±é–“å‰</span>
                    </div>
                </div>
                <div class="content-title">æ ªä¸»å„ªå¾…åˆ¶åº¦ã®å¤‰æ›´ã«ã¤ã„ã¦</div>
                <div class="content-meta">
                    <span>ğŸ æ ªä¸»é‚„å…ƒ</span>
                    <span>â€¢</span>
                    <span>ğŸ‘ï¸ 456å›</span>
                </div>
                <div class="content-status">
                    <span class="status-badge status-published">å…¬é–‹æ¸ˆã¿</span>
                    <div class="action-priority medium"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="workspace-header">
        <div>
            <h1 class="text-2xl font-bold mb-1">IRæƒ…å ±çµ±åˆã‚»ãƒ³ã‚¿ãƒ¼</h1>
            <p class="text-blue-100">æŠ•è³‡å®¶å‘ã‘æƒ…å ±ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†</p>
        </div>
        <div class="flex items-center gap-4">
            <div class="text-right">
                <p class="text-sm text-blue-200">å…¬é–‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</p>
                <p class="text-2xl font-bold">182ä»¶</p>
            </div>
            <div class="text-right">
                <p class="text-sm text-blue-200">ä»Šæœˆæ›´æ–°</p>
                <p class="text-2xl font-bold text-yellow-300">45ä»¶</p>
            </div>
            <div class="text-right">
                <p class="text-sm text-blue-200">å¹³å‡é–²è¦§æ•°</p>
                <p class="text-2xl font-bold text-green-300">234å›</p>
            </div>
        </div>
    </div>
    
    <!-- ãƒ¡ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ -->
    <div class="workspace-main">
        <!-- ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
        <div class="toolbar">
            <div class="toolbar-group">
                <button class="btn-toolbar active" onclick="setViewMode('dashboard')">
                    <span>ğŸ“Š</span>
                    <span>ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</span>
                </button>
                <button class="btn-toolbar" onclick="setViewMode('content')">
                    <span>ğŸ“</span>
                    <span>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</span>
                </button>
                <button class="btn-toolbar" onclick="setViewMode('lifecycle')">
                    <span>ğŸ”„</span>
                    <span>ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«</span>
                </button>
                <button class="btn-toolbar" onclick="setViewMode('analytics')">
                    <span>ğŸ“ˆ</span>
                    <span>ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹</span>
                </button>
            </div>
            
            <div class="toolbar-group">
                <button class="btn-toolbar" onclick="showCreateModal()">
                    <span>â•</span>
                    <span>æ–°è¦ä½œæˆ</span>
                </button>
                <button class="btn-toolbar" onclick="showImportModal()">
                    <span>ğŸ“¥</span>
                    <span>ã‚¤ãƒ³ãƒãƒ¼ãƒˆ</span>
                </button>
                <button class="btn-toolbar" onclick="exportContent()">
                    <span>ğŸ“¤</span>
                    <span>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</span>
                </button>
            </div>
        </div>
        
        <!-- ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãƒ“ãƒ¥ãƒ¼ -->
        <div id="view-dashboard" class="view-content">
            <!-- çµ±è¨ˆã‚«ãƒ¼ãƒ‰ -->
            <div class="dashboard-stats">
                <div class="stat-card">
                    <div class="stat-value">156</div>
                    <div class="stat-label">FAQç·æ•°</div>
                    <div class="stat-change positive">
                        <span>â†—</span>
                        <span>+12% å…ˆæœˆæ¯”</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">67</div>
                    <div class="stat-label">å…¬é–‹è³‡æ–™</div>
                    <div class="stat-change positive">
                        <span>â†—</span>
                        <span>+5% å…ˆæœˆæ¯”</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">25</div>
                    <div class="stat-label">ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹</div>
                    <div class="stat-change positive">
                        <span>â†—</span>
                        <span>+8% å…ˆæœˆæ¯”</span>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">12,547</div>
                    <div class="stat-label">ç·é–²è¦§æ•°</div>
                    <div class="stat-change positive">
                        <span>â†—</span>
                        <span>+18% å…ˆæœˆæ¯”</span>
                    </div>
                </div>
            </div>
            
            <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«æ¦‚è¦ -->
            <div class="lifecycle-flow">
                <div class="lifecycle-stage">
                    <div class="stage-icon active">1</div>
                    <div class="stage-label">ä½œæˆãƒ»æº–å‚™</div>
                    <div class="stage-count">15ä»¶</div>
                </div>
                <div class="lifecycle-stage">
                    <div class="stage-icon active">2</div>
                    <div class="stage-label">ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ‰¿èª</div>
                    <div class="stage-count">8ä»¶</div>
                </div>
                <div class="lifecycle-stage">
                    <div class="stage-icon">3</div>
                    <div class="stage-label">å…¬é–‹ãƒ»é…ä¿¡</div>
                    <div class="stage-count">182ä»¶</div>
                </div>
                <div class="lifecycle-stage">
                    <div class="stage-icon">4</div>
                    <div class="stage-label">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</div>
                    <div class="stage-count">156ä»¶</div>
                </div>
                <div class="lifecycle-stage">
                    <div class="stage-icon">5</div>
                    <div class="stage-label">æ›´æ–°ãƒ»æ”¹å–„</div>
                    <div class="stage-count">23ä»¶</div>
                </div>
            </div>
            
            <!-- æœ€è¿‘ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ -->
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="font-semibold text-gray-800 mb-4">ğŸ“ˆ æœ€è¿‘ã®ãƒã‚¤ãƒ©ã‚¤ãƒˆ</h3>
                <div class="space-y-4">
                    <div class="flex items-center gap-3 p-3 bg-white rounded-lg border">
                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                        <div class="flex-1">
                            <div class="font-medium text-gray-800">ç¬¬3å››åŠæœŸæ±ºç®—FAQ 10ä»¶ã‚’å…¬é–‹</div>
                            <div class="text-sm text-gray-500">2æ™‚é–“å‰ â€¢ å¹³å‡é–²è¦§æ•°: 89å›</div>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-white rounded-lg border">
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                        <div class="flex-1">
                            <div class="font-medium text-gray-800">ä¸­æœŸçµŒå–¶è¨ˆç”»è³‡æ–™ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æ€¥å¢—</div>
                            <div class="text-sm text-gray-500">5æ™‚é–“å‰ â€¢ +167% å‰æ—¥æ¯”</div>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 p-3 bg-white rounded-lg border">
                        <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                        <div class="flex-1">
                            <div class="font-medium text-gray-800">ESGé–¢é€£ã®FAQæ›´æ–°å®Œäº†</div>
                            <div class="text-sm text-gray-500">1æ—¥å‰ â€¢ ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢: 95%</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ“ãƒ¥ãƒ¼ -->
        <div id="view-content" class="view-content hidden">
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="font-semibold text-gray-800 mb-4">é¸æŠä¸­ã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h3>
                <p class="text-gray-600">å·¦å´ã®ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‹ã‚‰ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’é¸æŠã™ã‚‹ã¨ã€ã“ã“ã«è©³ç´°ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
            </div>
        </div>
        
        <!-- ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ãƒ“ãƒ¥ãƒ¼ -->
        <div id="view-lifecycle" class="view-content hidden">
            <div class="lifecycle-flow mb-6">
                <div class="lifecycle-stage">
                    <div class="stage-icon active">ğŸ“</div>
                    <div class="stage-label">ä½œæˆãƒ»æº–å‚™</div>
                    <div class="stage-count">15ä»¶å‡¦ç†ä¸­</div>
                </div>
                <div class="lifecycle-stage">
                    <div class="stage-icon active">ğŸ‘€</div>
                    <div class="stage-label">ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ‰¿èª</div>
                    <div class="stage-count">8ä»¶å¾…æ©Ÿä¸­</div>
                </div>
                <div class="lifecycle-stage">
                    <div class="stage-icon">ğŸš€</div>
                    <div class="stage-label">å…¬é–‹ãƒ»é…ä¿¡</div>
                    <div class="stage-count">182ä»¶å…¬é–‹ä¸­</div>
                </div>
                <div class="lifecycle-stage">
                    <div class="stage-icon">ğŸ’¬</div>
                    <div class="stage-label">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</div>
                    <div class="stage-count">156ä»¶åé›†æ¸ˆ</div>
                </div>
                <div class="lifecycle-stage">
                    <div class="stage-icon">ğŸ”„</div>
                    <div class="stage-label">æ›´æ–°ãƒ»æ”¹å–„</div>
                    <div class="stage-count">23ä»¶è¨ˆç”»ä¸­</div>
                </div>
            </div>
            
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="font-semibold text-gray-800 mb-4">ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ç®¡ç†</h3>
                <p class="text-gray-600">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«å…¨ä½“ã‚’é€šã˜ãŸç®¡ç†æ©Ÿèƒ½ã‚’æä¾›ã—ã¾ã™ã€‚</p>
            </div>
        </div>
        
        <!-- ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹ãƒ“ãƒ¥ãƒ¼ -->
        <div id="view-analytics" class="view-content hidden">
            <div class="bg-gray-50 rounded-lg p-6">
                <h3 class="font-semibold text-gray-800 mb-4">ğŸ“Š è©³ç´°åˆ†æ</h3>
                <p class="text-gray-600">æŠ•è³‡å®¶ã®è¡Œå‹•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚„äººæ°—ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ†æçµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚</p>
            </div>
        </div>
    </div>
    
    <!-- ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«é–‹é–‰ãƒœã‚¿ãƒ³ï¼ˆå›ºå®šä½ç½®ï¼‰ -->
    <div class="insight-toggle" onclick="toggleInsightPanel()" title="ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã‚’é–‹é–‰">
        <div class="insight-toggle-icon">â€¹</div>
        <div class="insight-toggle-text">ã‚¤ãƒ³ã‚µã‚¤ãƒˆ</div>
    </div>
    
    <!-- ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ï¼ˆå³ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ -->
    <div class="insight-panel" id="insightPanel">
        
        <div class="insight-header">
            <h3 class="font-semibold text-white">ğŸ§  ã‚¤ãƒ³ã‚µã‚¤ãƒˆ</h3>
            <button class="text-white opacity-75 hover:opacity-100" onclick="toggleInsightPanel()" title="ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        
        <div class="insight-content">
            <!-- é–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <div class="related-content">
                <h4 class="font-semibold text-gray-800 mb-3">ğŸ”— é–¢é€£ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</h4>
                <div class="related-item">
                    <div class="related-title">åŒæœŸæ±ºç®—è³‡æ–™</div>
                    <div class="related-meta">æ±ºç®—çŸ­ä¿¡ â€¢ 3æ—¥å‰</div>
                </div>
                <div class="related-item">
                    <div class="related-title">æ¥­ç¸¾è¦‹é€šã—FAQ</div>
                    <div class="related-meta">FAQ â€¢ ä¿¡é ¼åº¦95%</div>
                </div>
                <div class="related-item">
                    <div class="related-title">æŠ•è³‡å®¶èª¬æ˜ä¼šè³‡æ–™</div>
                    <div class="related-meta">ãƒ—ãƒ¬ã‚¼ãƒ³ â€¢ 1é€±é–“å‰</div>
                </div>
            </div>
            
            <!-- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ†æ -->
            <div class="analytics-widget">
                <div class="widget-title">ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹</div>
                <div class="metric-item">
                    <span class="metric-label">é–²è¦§æ•°</span>
                    <span class="metric-value">128å›</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">å¹³å‡æ»åœ¨æ™‚é–“</span>
                    <span class="metric-value">2åˆ†45ç§’</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯</span>
                    <span class="metric-value">12ä»¶</span>
                </div>
                <div class="metric-item">
                    <span class="metric-label">ä¿¡é ¼åº¦ã‚¹ã‚³ã‚¢</span>
                    <span class="metric-value">94%</span>
                </div>
            </div>
            
            <!-- è¦å¯¾å¿œã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div>
                <h4 class="font-semibold text-gray-800 mb-3">âš¡ è¦å¯¾å¿œ</h4>
                <div class="action-item">
                    <div class="action-priority high"></div>
                    <div class="flex-1">
                        <div class="font-medium text-sm">FAQæ›´æ–°ã®ç¢ºèª</div>
                        <div class="text-xs text-gray-500">æœŸé™: ä»Šæ—¥</div>
                    </div>
                </div>
                <div class="action-item">
                    <div class="action-priority medium"></div>
                    <div class="flex-1">
                        <div class="font-medium text-sm">è³‡æ–™ã®æ‰¿èªå¾…ã¡</div>
                        <div class="text-xs text-gray-500">æœŸé™: æ˜æ—¥</div>
                    </div>
                </div>
                <div class="action-item">
                    <div class="action-priority low"></div>
                    <div class="flex-1">
                        <div class="font-medium text-sm">çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆä½œæˆ</div>
                        <div class="text-xs text-gray-500">æœŸé™: æ¥é€±</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
// ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
let currentViewMode = 'dashboard';
let selectedContent = null;
let insightPanelCollapsed = false;

// ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
function setViewMode(mode) {
    // ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹æ›´æ–°
    document.querySelectorAll('.btn-toolbar').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.closest('.btn-toolbar').classList.add('active');
    
    // ãƒ“ãƒ¥ãƒ¼ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®åˆ‡ã‚Šæ›¿ãˆ
    document.querySelectorAll('.view-content').forEach(view => {
        view.classList.add('hidden');
    });
    document.getElementById(`view-${mode}`).classList.remove('hidden');
    
    currentViewMode = mode;
    console.log('ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´:', mode);
}

// ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
function filterContent(type) {
    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒãƒ—ã®çŠ¶æ…‹æ›´æ–°
    document.querySelectorAll('.filter-chip').forEach(chip => {
        chip.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚«ãƒ¼ãƒ‰ã®è¡¨ç¤ºåˆ¶å¾¡
    const cards = document.querySelectorAll('.content-card');
    let visibleCount = 0;
    
    cards.forEach(card => {
        const shouldShow = type === 'all' || 
                          card.classList.contains(type) ||
                          (type === 'urgent' && card.querySelector('.action-priority.high')) ||
                          (type === 'today' && card.textContent.includes('æ™‚é–“å‰'));
        
        if (shouldShow) {
            card.style.display = '';
            visibleCount++;
        } else {
            card.style.display = 'none';
        }
    });
    
    // ä»¶æ•°è¡¨ç¤ºã‚’æ›´æ–°
    document.getElementById('streamCount').textContent = `${visibleCount}ä»¶`;
    
    console.log('ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨:', type, 'è¡¨ç¤ºä»¶æ•°:', visibleCount);
}

// ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é¸æŠ
function selectContent(contentId, contentType) {
    // æ—¢å­˜ã®é¸æŠçŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢
    document.querySelectorAll('.content-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // æ–°ã—ã„é¸æŠçŠ¶æ…‹ã‚’è¨­å®š
    event.target.closest('.content-card').classList.add('selected');
    
    selectedContent = { id: contentId, type: contentType };
    
    // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒ“ãƒ¥ãƒ¼ã®å ´åˆã€è©³ç´°ã‚’è¡¨ç¤º
    if (currentViewMode === 'content') {
        showContentDetails(contentId, contentType);
    }
    
    console.log('ã‚³ãƒ³ãƒ†ãƒ³ãƒ„é¸æŠ:', selectedContent);
}

// ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è©³ç´°è¡¨ç¤º
function showContentDetails(contentId, contentType) {
    const contentView = document.getElementById('view-content');
    
    // ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãè©³ç´°è¡¨ç¤º
    const mockDetails = {
        'content-001': {
            title: '2024å¹´ç¬¬3å››åŠæœŸã®æ¥­ç¸¾è¦‹é€šã—ã«ã¤ã„ã¦',
            type: 'FAQ',
            category: 'è²¡å‹™ãƒ»æ¥­ç¸¾',
            content: 'ç¬¬3å››åŠæœŸã®å£²ä¸Šé«˜ã¯å‰å¹´åŒæœŸæ¯”15%å¢—ã®è¦‹è¾¼ã¿ã§ã™ã€‚ä¸»åŠ›äº‹æ¥­ã®å¥½èª¿ãªæ¨ç§»ã«ã‚ˆã‚Šã€é€šæœŸæ¥­ç¸¾äºˆæƒ³ã‚’ä¸Šæ–¹ä¿®æ­£ã„ãŸã—ã¾ã™ã€‚',
            viewCount: 128,
            lastUpdated: '2024å¹´1æœˆ20æ—¥',
            status: 'å…¬é–‹æ¸ˆã¿'
        }
    };
    
    const details = mockDetails[contentId];
    if (details) {
        contentView.innerHTML = `
            <div class="bg-white rounded-lg border p-6">
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-3">
                        <span class="content-type ${contentType}">${details.type}</span>
                        <span class="text-sm text-gray-500">${details.category}</span>
                    </div>
                    <div class="flex gap-2">
                        <button class="btn-toolbar" onclick="editContent('${contentId}')">
                            <span>âœï¸</span>
                            <span>ç·¨é›†</span>
                        </button>
                        <button class="btn-toolbar" onclick="duplicateContent('${contentId}')">
                            <span>ğŸ“‹</span>
                            <span>è¤‡è£½</span>
                        </button>
                    </div>
                </div>
                
                <h2 class="text-xl font-bold text-gray-800 mb-4">${details.title}</h2>
                
                <div class="bg-gray-50 rounded-lg p-4 mb-4">
                    <p class="text-gray-700">${details.content}</p>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                    <div>
                        <div class="text-gray-500">é–²è¦§æ•°</div>
                        <div class="font-semibold">${details.viewCount}å›</div>
                    </div>
                    <div>
                        <div class="text-gray-500">æœ€çµ‚æ›´æ–°</div>
                        <div class="font-semibold">${details.lastUpdated}</div>
                    </div>
                    <div>
                        <div class="text-gray-500">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</div>
                        <div class="font-semibold text-green-600">${details.status}</div>
                    </div>
                    <div>
                        <div class="text-gray-500">ä¿¡é ¼åº¦</div>
                        <div class="font-semibold">94%</div>
                    </div>
                </div>
            </div>
        `;
    }
}

// ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«é–‹é–‰æ©Ÿèƒ½
function toggleInsightPanel() {
    const irContentCenter = document.querySelector('.ir-content-center');
    const insightPanel = document.getElementById('insightPanel');
    const toggleButton = document.querySelector('.insight-toggle');
    
    if (!irContentCenter || !insightPanel || !toggleButton) {
        console.error('å¿…è¦ãªè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
        return;
    }
    
    insightPanelCollapsed = !insightPanelCollapsed;
    
    if (insightPanelCollapsed) {
        irContentCenter.classList.add('insight-collapsed');
        insightPanel.classList.add('collapsed');
        toggleButton.title = 'ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã‚’é–‹ã';
        
        // æˆåŠŸé€šçŸ¥
        showNotification('ğŸ“š ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã¾ã—ãŸ', 'info');
    } else {
        irContentCenter.classList.remove('insight-collapsed');
        insightPanel.classList.remove('collapsed');
        toggleButton.title = 'ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹';
        
        // æˆåŠŸé€šçŸ¥
        showNotification('ğŸ§  ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã‚’é–‹ãã¾ã—ãŸ', 'success');
    }
    
    // çŠ¶æ…‹ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
    localStorage.setItem('insightPanelCollapsed', insightPanelCollapsed);
    
    console.log('ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«:', insightPanelCollapsed ? 'é–‰ã˜ã‚‹' : 'é–‹ã');
}

// ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«åˆæœŸåŒ–
function initializeInsightPanel() {
    console.log('ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«åˆæœŸåŒ–é–‹å§‹');
    
    // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å‰å›ã®çŠ¶æ…‹ã‚’å¾©å…ƒ
    const saved = localStorage.getItem('insightPanelCollapsed');
    console.log('ä¿å­˜ã•ã‚ŒãŸçŠ¶æ…‹:', saved);
    
    const irContentCenter = document.querySelector('.ir-content-center');
    const insightPanel = document.getElementById('insightPanel');
    const toggleButton = document.querySelector('.insight-toggle');
    
    if (!irContentCenter || !insightPanel || !toggleButton) {
        console.error('åˆæœŸåŒ–: å¿…è¦ãªè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', {
            irContentCenter: !!irContentCenter,
            insightPanel: !!insightPanel,
            toggleButton: !!toggleButton
        });
        return;
    }
    
    if (saved !== null) {
        insightPanelCollapsed = JSON.parse(saved);
        console.log('å¾©å…ƒã•ã‚ŒãŸçŠ¶æ…‹:', insightPanelCollapsed);
        
        if (insightPanelCollapsed) {
            console.log('åˆæœŸåŒ–: ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ãŸçŠ¶æ…‹ã§å¾©å…ƒ');
            irContentCenter.classList.add('insight-collapsed');
            insightPanel.classList.add('collapsed');
            toggleButton.title = 'ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã‚’é–‹ã';
        } else {
            toggleButton.title = 'ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹';
        }
    } else {
        console.log('ä¿å­˜ã•ã‚ŒãŸçŠ¶æ…‹ãªã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçŠ¶æ…‹ã‚’ä½¿ç”¨');
        toggleButton.title = 'ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹';
    }
    
    // åˆæœŸåŒ–å®Œäº†ã®é€šçŸ¥
    setTimeout(() => {
        showNotification('ğŸš€ IRæƒ…å ±çµ±åˆã‚»ãƒ³ã‚¿ãƒ¼ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ', 'success');
    }, 500);
}

// å„ç¨®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆãƒ¢ãƒƒã‚¯ï¼‰
function showCreateModal() {
    alert('æ–°è¦ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã—ã¾ã™');
}

function showImportModal() {
    alert('ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã—ã¾ã™');
}

function exportContent() {
    alert('ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã™');
}

function editContent(contentId) {
    alert(`ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ ${contentId} ã®ç·¨é›†ç”»é¢ã‚’é–‹ãã¾ã™`);
}

function duplicateContent(contentId) {
    alert(`ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ ${contentId} ã‚’è¤‡è£½ã—ã¾ã™`);
}

// é€šçŸ¥è¡¨ç¤ºæ©Ÿèƒ½
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg transform transition-all duration-500 translate-x-0 z-50`;
    
    // ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸè‰²ã‚’è¨­å®š
    if (type === 'success') {
        notification.className += ' bg-green-500 text-white';
    } else if (type === 'info') {
        notification.className += ' bg-blue-500 text-white';
    } else if (type === 'warning') {
        notification.className += ' bg-yellow-500 text-white';
    } else if (type === 'error') {
        notification.className += ' bg-red-500 text-white';
    }
    
    notification.textContent = message;
    document.body.appendChild(notification);
    
    // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    setTimeout(() => {
        notification.style.transform = 'translateX(0px)';
        notification.style.opacity = '1';
    }, 100);
    
    // 3ç§’å¾Œã«éè¡¨ç¤º
    setTimeout(() => {
        notification.style.transform = 'translateX(400px)';
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 500);
    }, 3000);
}

// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒ˜ãƒ«ãƒ—ã®è¡¨ç¤º
function showKeyboardHelp() {
    const helpModal = document.createElement('div');
    helpModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    helpModal.innerHTML = `
        <div class="bg-white rounded-lg p-6 max-w-md mx-4 shadow-xl">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-800">âŒ¨ï¸ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ</h3>
                <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="space-y-3 text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-600">ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«é–‹é–‰</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+I</kbd>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤º</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">1</kbd>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¡¨ç¤º</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">2</kbd>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«è¡¨ç¤º</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">3</kbd>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ã‚¢ãƒŠãƒªãƒ†ã‚£ã‚¯ã‚¹è¡¨ç¤º</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">4</kbd>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ã“ã®ãƒ˜ãƒ«ãƒ—</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">H</kbd>
                </div>
            </div>
        </div>
    `;
    document.body.appendChild(helpModal);
    
    // ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
    helpModal.addEventListener('click', function(e) {
        if (e.target === helpModal) {
            helpModal.remove();
        }
    });
}

// åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', function() {
    console.log('IRæƒ…å ±çµ±åˆã‚»ãƒ³ã‚¿ãƒ¼åˆæœŸåŒ–é–‹å§‹');
    
    // ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«ã®çŠ¶æ…‹ã‚’åˆæœŸåŒ–
    initializeInsightPanel();
    
    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
    document.addEventListener('keydown', function(e) {
        // Ctrl+I ã§ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ«é–‹é–‰
        if ((e.ctrlKey || e.metaKey) && e.key === 'i') {
            e.preventDefault();
            toggleInsightPanel();
            showNotification('âŒ¨ï¸ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ: Ctrl+I', 'info');
        }
        
        // 1-4ã‚­ãƒ¼ã§ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
        if (e.key >= '1' && e.key <= '4' && !e.ctrlKey && !e.altKey) {
            const modes = ['dashboard', 'content', 'lifecycle', 'analytics'];
            const mode = modes[parseInt(e.key) - 1];
            if (mode) {
                const button = document.querySelector(`[onclick="setViewMode('${mode}')"]`);
                if (button) {
                    button.click();
                    showNotification(`ğŸ”¢ ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆ: ${e.key}ã‚­ãƒ¼`, 'info');
                }
            }
        }
        
        // Hã‚­ãƒ¼ã§ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
        if (e.key === 'h' || e.key === 'H') {
            if (!e.ctrlKey && !e.altKey && !e.metaKey) {
                e.preventDefault();
                showKeyboardHelp();
            }
        }
    });
    
    console.log('åˆæœŸåŒ–å®Œäº†');
});
</script>
{% endblock %} 