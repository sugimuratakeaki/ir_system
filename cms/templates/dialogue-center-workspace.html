{% extends 'base-three-column.html' %}

{% block title %}å¤–éƒ¨MTGè­°äº‹éŒ²{% endblock %}

{% block left_sidebar_title %}å¯¾è©±è¨˜éŒ²ã‚¹ãƒˆãƒªãƒ¼ãƒ {% endblock %}
{% block right_panel_title %}ğŸ§  ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹{% endblock %}
{% block right_panel_toggle_text %}çŸ¥èƒ½åˆ†æ{% endblock %}

{% block main_title %}å¤–éƒ¨MTGè­°äº‹éŒ²{% endblock %}
{% block main_subtitle %}çµ±åˆã•ã‚ŒãŸã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¹ãƒˆãƒªãƒ¼ãƒ ç®¡ç†{% endblock %}

{% block three_column_extra_css %}
<style>
/* å¤–éƒ¨MTGè­°äº‹éŒ²å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */

/* ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚«ãƒ¼ãƒ‰å°‚ç”¨ */
.activity-card {
    /* cardåŸºæœ¬ã‚¹ã‚¿ã‚¤ãƒ«ã‹ã‚‰ç¶™æ‰¿ */
}

.activity-card:hover::after {
    content: "ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†";
    position: absolute;
    top: -10px;
    right: 8px;
    background: rgba(0, 0, 0, 0.8);
    color: white;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 10px;
    pointer-events: none;
    opacity: 0.9;
    z-index: 10;
}

.activity-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.activity-title {
    font-weight: 600;
    color: #1f2937;
    font-size: 0.875rem;
    line-height: 1.25rem;
}

.activity-time {
    font-size: 0.75rem;
    color: #6b7280;
}

.activity-meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.75rem;
    color: #6b7280;
}

.investor-badge {
    background: #f3f4f6;
    color: #374151;
    padding: 0.125rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
}

.activity-progress {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.progress-label {
    font-size: 0.75rem;
    color: #6b7280;
}

/* å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¡¨ç¤º */
.pipeline-viewer {
    background: #f8fafc;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1.5rem;
}

.pipeline-stages {
    display: flex;
    justify-content: space-between;
    position: relative;
    margin-bottom: 0.5rem;
}

.pipeline-stages::before {
    content: '';
    position: absolute;
    top: 12px;
    left: 0;
    right: 0;
    height: 2px;
    background: #e5e7eb;
    z-index: 1;
}

.pipeline-stage {
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 2;
    background: white;
    padding: 0 0.5rem;
    position: relative;
}

.stage-circle {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #e5e7eb;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
    transition: all 0.2s;
}

.stage-circle.completed {
    background: #10b981;
    color: white;
}

.stage-circle.active {
    background: #3b82f6;
    color: white;
    animation: pulse 2s infinite;
}

.stage-circle.processing {
    background: #f59e0b;
    color: white;
    position: relative;
}

.stage-label {
    font-size: 0.625rem;
    color: #6b7280;
    text-align: center;
    line-height: 1.2;
}

/* ãƒ“ãƒ¥ãƒ¼ã‚·ã‚¹ãƒ†ãƒ  */
.view-content {
    flex: 1;
    padding: 1.5rem;
    overflow-y: auto;
    display: none;
}

.view-content.active {
    display: block;
}

/* ã‚¿ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚·ã‚¹ãƒ†ãƒ  */
.workspace-tabs {
    display: flex;
    background: #f8fafc;
    border-bottom: 1px solid #e5e7eb;
}

.workspace-tab {
    padding: 0.75rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: #6b7280;
    cursor: pointer;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
}

.workspace-tab.active {
    color: #3b82f6;
    border-bottom-color: #3b82f6;
    background: white;
}

.workspace-tab:hover:not(.active) {
    color: #374151;
    background: #f3f4f6;
}

.tab-content {
    flex: 1;
    padding: 1.5rem;
    overflow-y: auto;
    display: none;
}

.tab-content.active {
    display: block;
}

/* ã‹ã‚“ã°ã‚“ãƒœãƒ¼ãƒ‰ */
.kanban-board {
    display: flex;
    gap: 1rem;
    min-height: 600px;
    overflow-x: auto;
    padding-bottom: 1rem;
}

.kanban-column {
    min-width: 280px;
    background: #f8fafc;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
}

.kanban-header {
    padding: 1rem;
    border-bottom: 1px solid #e5e7eb;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.kanban-content {
    flex: 1;
    padding: 1rem;
    overflow-y: auto;
}

.kanban-card {
    background: white;
    border-radius: 6px;
    padding: 0.75rem;
    margin-bottom: 0.75rem;
    border: 1px solid #e5e7eb;
    cursor: pointer;
    transition: all 0.2s;
}

.kanban-card:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.kanban-card.urgent {
    border-left: 4px solid #ef4444;
    background: #fef2f2;
}

.kanban-card.processing {
    border-left: 4px solid #f59e0b;
}

.kanban-card.completed {
    border-left: 4px solid #10b981;
    background: #f0fdfa;
}

/* ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ« */
.table-container {
    background: white;
    border-radius: 8px;
}

.table-controls {
    padding: 1rem;
    border-bottom: 1px solid #e5e7eb;
}

.data-table-wrapper {
    overflow-x: auto;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.875rem;
}

.data-table th {
    background: #f8fafc;
    padding: 0.75rem;
    text-align: left;
    font-weight: 600;
    color: #374151;
    border-bottom: 2px solid #e5e7eb;
    white-space: nowrap;
}

.data-table th.sortable {
    cursor: pointer;
    position: relative;
}

.data-table th.sortable:hover {
    background: #f1f5f9;
}

.sort-icon {
    margin-left: 0.25rem;
    color: #9ca3af;
    font-size: 0.75rem;
}

.data-table td {
    padding: 0.75rem;
    border-bottom: 1px solid #f3f4f6;
    vertical-align: middle;
}

.table-row {
    cursor: pointer;
    transition: background-color 0.2s;
}

.table-row:hover {
    background: #f8fafc;
}

.table-row.urgent {
    background: #fef2f2;
}

.table-row.processing {
    background: #fffbeb;
}

.table-row.completed {
    background: #f0fdfa;
}

.table-row.selected {
    background: #eff6ff;
    border-left: 4px solid #3b82f6;
}

/* ãƒãƒƒã‚¸ã¨ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ */
.status-badge {
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 500;
}

.status-badge.urgent {
    background: #fee2e2;
    color: #dc2626;
}

.status-badge.processing {
    background: #fef3c7;
    color: #d97706;
}

.status-badge.completed {
    background: #d1fae5;
    color: #059669;
}

.badge {
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
}

.badge-blue {
    background: #dbeafe;
    color: #1d4ed8;
}

.badge-green {
    background: #d1fae5;
    color: #059669;
}

.badge-red {
    background: #fee2e2;
    color: #dc2626;
}

.badge-purple {
    background: #e9d5ff;
    color: #7c3aed;
}

.badge-gray {
    background: #f3f4f6;
    color: #374151;
}

/* AIåˆ†æè¡¨ç¤º */
.ai-insights {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    border: 1px solid #0284c7;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.insight-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    color: #0c4a6e;
    margin-bottom: 0.5rem;
}

.insight-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.insight-item {
    display: flex;
    align-items: flex-start;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
    color: #0c4a6e;
}

.insight-icon {
    flex-shrink: 0;
    margin-top: 0.125rem;
}

/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ« */
.action-panel {
    background: #fefce8;
    border: 1px solid #eab308;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.action-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: 0.75rem;
}

.action-title {
    font-weight: 600;
    color: #a16207;
}

.action-count {
    background: #eab308;
    color: white;
    font-size: 0.75rem;
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
}

.action-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.action-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0.5rem;
    background: white;
    border-radius: 4px;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
}

.action-priority {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    margin-right: 0.5rem;
}

.action-priority.high {
    background: #ef4444;
}

.action-priority.medium {
    background: #f59e0b;
}

.action-priority.low {
    background: #10b981;
}

/* çµ±è¨ˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ */
.stats-widget {
    background: #f8fafc;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.stat-item {
    text-align: center;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1f2937;
}

.stat-label {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 0.25rem;
}

.stat-trend {
    font-size: 0.75rem;
    margin-top: 0.25rem;
}

.stat-trend.positive {
    color: #10b981;
}

.stat-trend.negative {
    color: #ef4444;
}

/* ãƒ•ã‚©ãƒ¼ãƒ é–¢é€£ */
.form-control-sm {
    padding: 0.375rem 0.5rem;
    font-size: 0.875rem;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    background: white;
    transition: border-color 0.2s;
}

.form-control-sm:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: 4px;
    border: 1px solid transparent;
    cursor: pointer;
    transition: all 0.2s;
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
}

.btn-sm.btn-primary {
    background: #3b82f6;
    color: white;
    border-color: #3b82f6;
}

.btn-sm.btn-primary:hover {
    background: #2563eb;
    border-color: #2563eb;
}

.btn-sm.btn-secondary {
    background: #f3f4f6;
    color: #374151;
    border-color: #d1d5db;
}

.btn-sm.btn-secondary:hover {
    background: #e5e7eb;
    border-color: #9ca3af;
}

/* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ */
.progress-bar-mini {
    height: 4px;
    background: #e5e7eb;
    border-radius: 2px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: #3b82f6;
    transition: width 0.3s ease;
}

.progress-fill.stalled {
    background: #ef4444;
    animation: pulse 1s infinite;
}

.progress-fill.processing {
    background: #f59e0b;
}

.progress-fill.completed {
    background: #10b981;
}

.progress-bar-table {
    width: 60px;
    height: 6px;
    background: #e5e7eb;
    border-radius: 3px;
    overflow: hidden;
    margin: 0 auto;
}

.ai-score-container {
    text-align: center;
}

.ai-score {
    font-weight: 600;
    font-size: 0.875rem;
}

.ai-score.high {
    color: #059669;
}

.ai-score.medium {
    color: #d97706;
}

.ai-score.low {
    color: #dc2626;
}

.action-buttons {
    display: flex;
    gap: 0.25rem;
}

.btn-action {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    border: 1px solid #d1d5db;
    background: white;
    color: #374151;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-action:hover {
    background: #f3f4f6;
    border-color: #9ca3af;
}

.bulk-action-bar {
    padding: 1rem;
    background: #f8fafc;
    border-top: 1px solid #e5e7eb;
    border-radius: 0 0 8px 8px;
}

.pagination-mini {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.btn-pagination {
    padding: 0.25rem 0.5rem;
    border: 1px solid #d1d5db;
    background: white;
    color: #374151;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.875rem;
}

.btn-pagination:hover {
    background: #f3f4f6;
}

.pagination-info {
    font-size: 0.875rem;
    color: #6b7280;
}
</style>
{% endblock %}

{% block left_sidebar_header_actions %}
<span class="text-sm opacity-75">156ä»¶</span>
{% endblock %}

{% block left_sidebar_filters %}
<div class="flex gap-0.5rem mt-4">
    <div class="filter-chip active" onclick="filterStream('all')">å…¨ã¦</div>
    <div class="filter-chip" onclick="filterStream('urgent')">ç·Šæ€¥ (3)</div>
    <div class="filter-chip" onclick="filterStream('processing')">å‡¦ç†ä¸­ (12)</div>
    <div class="filter-chip" onclick="filterStream('today')">ä»Šæ—¥ (5)</div>
</div>
{% endblock %}

{% block left_sidebar_content %}
<!-- ç·Šæ€¥å¯¾å¿œãŒå¿…è¦ãªè¨˜éŒ² -->
<div class="activity-card urgent selected card" onclick="selectActivity('activity-001')" ondblclick="editRecord('activity-001')" title="ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†">
    <div class="activity-header">
        <div class="activity-title">é‡æ‘AMæ±ºç®—èª¬æ˜ä¼š</div>
        <div class="activity-time">2æ™‚é–“å‰</div>
    </div>
    <div class="activity-meta">
        <span class="investor-badge">æ©Ÿé–¢æŠ•è³‡å®¶</span>
        <span>â€¢</span>
        <span>90åˆ†</span>
        <span>â€¢</span>
        <span class="text-red-600 font-medium">å‡¦ç†åœæ»</span>
    </div>
    <div class="activity-progress">
        <div class="progress-dots">
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
        </div>
        <div class="progress-label">AIè¦ç´„ä¸­</div>
    </div>
</div>

<!-- å‡¦ç†ä¸­ã®è¨˜éŒ² -->
<div class="activity-card processing card" onclick="selectActivity('activity-002')" ondblclick="editRecord('activity-002')" title="ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†">
    <div class="activity-header">
        <div class="activity-title">BlackRockå€‹åˆ¥é¢è«‡</div>
        <div class="activity-time">5æ™‚é–“å‰</div>
    </div>
    <div class="activity-meta">
        <span class="investor-badge">æµ·å¤–æŠ•è³‡å®¶</span>
        <span>â€¢</span>
        <span>45åˆ†</span>
        <span>â€¢</span>
        <span class="text-yellow-600 font-medium">FAQä½œæˆä¸­</span>
    </div>
    <div class="activity-progress">
        <div class="progress-dots">
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
        </div>
        <div class="progress-label">FAQç”Ÿæˆä¸­</div>
    </div>
</div>

<!-- å®Œäº†æ¸ˆã¿ã®è¨˜éŒ² -->
<div class="activity-card completed card" onclick="selectActivity('activity-003')" ondblclick="editRecord('activity-003')" title="ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†">
    <div class="activity-header">
        <div class="activity-title">å€‹äººæŠ•è³‡å®¶èª¬æ˜ä¼š</div>
        <div class="activity-time">1æ—¥å‰</div>
    </div>
    <div class="activity-meta">
        <span class="investor-badge">å€‹äººæŠ•è³‡å®¶</span>
        <span>â€¢</span>
        <span>2æ™‚é–“</span>
        <span>â€¢</span>
        <span class="text-green-600 font-medium">å…¬é–‹æ¸ˆã¿</span>
    </div>
    <div class="activity-progress">
        <div class="progress-dots">
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
        </div>
        <div class="progress-label">å®Œäº†</div>
    </div>
</div>

<!-- ä»Šæ—¥äºˆå®šã®è¨˜éŒ² -->
<div class="activity-card card" onclick="selectActivity('activity-004')" ondblclick="editRecord('activity-004')" title="ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†">
    <div class="activity-header">
        <div class="activity-title">Vanguardå®šæœŸé¢è«‡</div>
        <div class="activity-time">14:00äºˆå®š</div>
    </div>
    <div class="activity-meta">
        <span class="investor-badge">æµ·å¤–æŠ•è³‡å®¶</span>
        <span>â€¢</span>
        <span>60åˆ†</span>
        <span>â€¢</span>
        <span class="text-blue-600 font-medium">æº–å‚™å®Œäº†</span>
    </div>
    <div class="activity-progress">
        <div class="progress-dots">
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
            <div class="progress-dot"></div>
        </div>
        <div class="progress-label">å®Ÿæ–½å¾…ã¡</div>
    </div>
</div>

<!-- è¿½åŠ ã®è¨˜éŒ²... -->
<div class="activity-card card" onclick="selectActivity('activity-005')" ondblclick="editRecord('activity-005')" title="ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§ç·¨é›†">
    <div class="activity-header">
        <div class="activity-title">ã‚¢ãƒŠãƒªã‚¹ãƒˆå‘ã‘èª¬æ˜ä¼š</div>
        <div class="activity-time">2æ—¥å‰</div>
    </div>
    <div class="activity-meta">
        <span class="investor-badge">ã‚¢ãƒŠãƒªã‚¹ãƒˆ</span>
        <span>â€¢</span>
        <span>75åˆ†</span>
        <span>â€¢</span>
        <span class="text-yellow-600 font-medium">ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡</span>
    </div>
    <div class="activity-progress">
        <div class="progress-dots">
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot completed"></div>
            <div class="progress-dot active"></div>
            <div class="progress-dot"></div>
        </div>
        <div class="progress-label">æ‰¿èªå¾…ã¡</div>
    </div>
</div>
{% endblock %}

{% block main_header_stats %}
<div class="text-right">
    <p class="text-sm text-blue-200">å‡¦ç†ä¸­</p>
    <p class="text-2xl font-bold">12ä»¶</p>
</div>
<div class="text-right">
    <p class="text-sm text-blue-200">ç·Šæ€¥å¯¾å¿œ</p>
    <p class="text-2xl font-bold text-yellow-300">3ä»¶</p>
</div>
<div class="text-right">
    <p class="text-sm text-blue-200">ä»Šæ—¥å®Œäº†</p>
    <p class="text-2xl font-bold text-green-300">8ä»¶</p>
</div>
{% endblock %}

{% block main_content %}
<!-- ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
<div class="toolbar">
    <div class="toolbar-group">
        <button class="btn-toolbar" onclick="bulkProcess()">
            <span>âš¡</span>
            <span>ä¸€æ‹¬å‡¦ç†</span>
        </button>
        <button class="btn-toolbar" onclick="exportData()">
            <span>ğŸ“¥</span>
            <span>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</span>
        </button>
    </div>
    <div class="toolbar-separator"></div>
    <div class="toolbar-group">
        <button class="btn-toolbar active" onclick="setViewMode('stream')">
            <span>ğŸ“Š</span>
            <span>ã‚¹ãƒˆãƒªãƒ¼ãƒ </span>
        </button>
        <button class="btn-toolbar" onclick="setViewMode('kanban')">
            <span>ğŸ“‹</span>
            <span>ã‹ã‚“ã°ã‚“</span>
        </button>
        <button class="btn-toolbar" onclick="setViewMode('table')">
            <span>ğŸ“‘</span>
            <span>ãƒ†ãƒ¼ãƒ–ãƒ«</span>
        </button>
    </div>
    <div class="toolbar-separator"></div>
    <div class="toolbar-group">
        <button class="btn-toolbar" onclick="showFilters()">
            <span>ğŸ”</span>
            <span>è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿</span>
        </button>
    </div>
</div>

<!-- ã‚¿ãƒ–ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯éè¡¨ç¤ºã€é¸æŠè¨˜éŒ²ã®è©³ç´°æ™‚ã«è¡¨ç¤ºï¼‰ -->
<div class="workspace-tabs" id="detailTabs" style="display: none;">
    <div class="workspace-tab active" onclick="switchDetailTab('overview')">
        <span>ğŸ“Š æ¦‚è¦</span>
    </div>
    <div class="workspace-tab" onclick="switchDetailTab('transcript')">
        <span>ğŸ“ æ–‡å­—èµ·ã“ã—</span>
    </div>
    <div class="workspace-tab" onclick="switchDetailTab('analysis')">
        <span>ğŸ¤– AIåˆ†æ</span>
    </div>
    <div class="workspace-tab" onclick="switchDetailTab('timeline')">
        <span>â° ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</span>
    </div>
</div>

<!-- ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ“ãƒ¥ãƒ¼ -->
<div id="view-stream" class="view-content active">
    <!-- é¸æŠã•ã‚ŒãŸè¨˜éŒ²ã®å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ -->
    <div class="pipeline-viewer">
        <h3 class="font-semibold text-gray-800 mb-3">å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ - é‡æ‘AMæ±ºç®—èª¬æ˜ä¼š</h3>
        <div class="pipeline-stages">
            <div class="pipeline-stage">
                <div class="stage-circle completed">âœ“</div>
                <div class="stage-label">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</div>
            </div>
            <div class="pipeline-stage">
                <div class="stage-circle completed">âœ“</div>
                <div class="stage-label">æ–‡å­—èµ·ã“ã—</div>
            </div>
            <div class="pipeline-stage">
                <div class="stage-circle processing">â³</div>
                <div class="stage-label">AIè¦ç´„</div>
            </div>
            <div class="pipeline-stage">
                <div class="stage-circle">4</div>
                <div class="stage-label">FAQä½œæˆ</div>
            </div>
            <div class="pipeline-stage">
                <div class="stage-circle">5</div>
                <div class="stage-label">ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
            </div>
            <div class="pipeline-stage">
                <div class="stage-circle">6</div>
                <div class="stage-label">å…¬é–‹</div>
            </div>
        </div>
        <div class="bg-blue-50 rounded-lg p-3 mt-3">
            <div class="flex items-center gap-2">
                <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                <span class="text-sm text-blue-800 font-medium">AIè¦ç´„å‡¦ç†ä¸­...</span>
                <span class="text-sm text-blue-600">æ¨å®šæ®‹ã‚Šæ™‚é–“: 3åˆ†</span>
            </div>
            <div class="w-full bg-blue-200 rounded-full h-2 mt-2">
                <div class="bg-blue-600 h-2 rounded-full animate-pulse" style="width: 65%"></div>
            </div>
        </div>
    </div>
    
    <!-- åŸºæœ¬æƒ…å ±ã‚«ãƒ¼ãƒ‰ -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
        <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-semibold text-gray-800 mb-3">ğŸ“‹ åŸºæœ¬æƒ…å ±</h4>
            <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-600">æŠ•è³‡å®¶</span>
                    <span class="font-medium">é‡æ‘ã‚¢ã‚»ãƒƒãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ç¨®åˆ¥</span>
                    <span class="font-medium">æ±ºç®—èª¬æ˜ä¼š</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">æ—¥æ™‚</span>
                    <span class="font-medium">2024/12/26 15:00</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">æ™‚é–“</span>
                    <span class="font-medium">90åˆ†</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">å‚åŠ è€…</span>
                    <span class="font-medium">CEO, CFO, IRéƒ¨é•·</span>
                </div>
            </div>
        </div>
        
        <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-semibold text-gray-800 mb-3">ğŸ“Š å‡¦ç†çµ±è¨ˆ</h4>
            <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-600">æ–‡å­—æ•°</span>
                    <span class="font-medium">15,680æ–‡å­—</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">æ–‡å­—èµ·ã“ã—ç²¾åº¦</span>
                    <span class="font-medium text-green-600">96%</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">å‡¦ç†é–‹å§‹</span>
                    <span class="font-medium">2æ™‚é–“å‰</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">é€²æ—</span>
                    <span class="font-medium text-blue-600">65%</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">æ‹…å½“è€…</span>
                    <span class="font-medium">IRæ‹…å½“è€…A</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
        <div class="flex items-center gap-2 mb-2">
            <span class="text-xl">âš¡</span>
            <h4 class="font-semibold text-yellow-800">æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h4>
        </div>
        <p class="text-sm text-yellow-700 mb-3">AIè¦ç´„ãŒå®Œäº†æ¬¡ç¬¬ã€FAQç”Ÿæˆã«é€²ã¿ã¾ã™ã€‚æ‰‹å‹•ã§ä»‹å…¥ã™ã‚‹å ´åˆã¯ä¸‹è¨˜ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</p>
        <div class="flex gap-2">
            <button class="px-3 py-1.5 bg-yellow-500 text-white rounded text-sm font-medium hover:bg-yellow-600" onclick="forceNextStage()">
                å¼·åˆ¶çš„ã«æ¬¡ã¸é€²ã‚€
            </button>
            <button class="px-3 py-1.5 bg-white text-yellow-700 border border-yellow-300 rounded text-sm font-medium hover:bg-yellow-50" onclick="cancelProcessing()">
                å‡¦ç†ã‚’ä¸­æ–­
            </button>
        </div>
    </div>
</div>

<!-- ã‹ã‚“ã°ã‚“ãƒ“ãƒ¥ãƒ¼ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ“ãƒ¥ãƒ¼ã¯çœç•¥ï¼ˆåŒæ§˜ã«ç§»è¡Œï¼‰ -->
{% endblock %}

{% block right_panel_content %}
<!-- çµ±è¨ˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ -->
<div class="stats-widget">
    <h4 class="font-semibold text-gray-800 mb-3">ğŸ“Š ä»Šæ—¥ã®çµ±è¨ˆ</h4>
    <div class="stats-grid">
        <div class="stat-item">
            <div class="stat-value">8</div>
            <div class="stat-label">å‡¦ç†å®Œäº†</div>
            <div class="stat-trend positive">+3</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">12</div>
            <div class="stat-label">å‡¦ç†ä¸­</div>
            <div class="stat-trend positive">-2</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">96%</div>
            <div class="stat-label">AIç²¾åº¦</div>
            <div class="stat-trend positive">+1%</div>
        </div>
        <div class="stat-item">
            <div class="stat-value">2.3h</div>
            <div class="stat-label">å¹³å‡æ™‚é–“</div>
            <div class="stat-trend positive">-0.5h</div>
        </div>
    </div>
</div>

<!-- AIæ´å¯Ÿ -->
<div class="ai-insights">
    <div class="insight-header">
        <span class="text-xl">ğŸ¤–</span>
        <span>AIæ´å¯Ÿ</span>
    </div>
    <ul class="insight-list">
        <li class="insight-item">
            <span class="insight-icon">ğŸ’¡</span>
            <span>ä»Šæ—¥ã®å‡¦ç†åŠ¹ç‡ãŒ20%å‘ä¸Šã—ã¦ã„ã¾ã™</span>
        </li>
        <li class="insight-item">
            <span class="insight-icon">âš ï¸</span>
            <span>3ä»¶ã®è¨˜éŒ²ã§å‡¦ç†é…å»¶ãŒç™ºç”Ÿä¸­</span>
        </li>
        <li class="insight-item">
            <span class="insight-icon">ğŸ“ˆ</span>
            <span>ESGé–¢é€£ã®è³ªå•ãŒæ€¥å¢—ã—ã¦ã„ã¾ã™</span>
        </li>
    </ul>
</div>

<!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ« -->
<div class="action-panel">
    <div class="action-header">
        <div class="action-title">ğŸ¯ è¦å¯¾å¿œã‚¢ã‚¯ã‚·ãƒ§ãƒ³</div>
        <div class="action-count">5</div>
    </div>
    <ul class="action-list">
        <li class="action-item">
            <div class="action-priority high"></div>
            <div class="flex-1">
                <div class="font-medium">BlackRockã¸ã®å›ç­”</div>
                <div class="text-xs text-gray-500">æœŸé™: ä»Šæ—¥</div>
            </div>
        </li>
        <li class="action-item">
            <div class="action-priority medium"></div>
            <div class="flex-1">
                <div class="font-medium">FAQæ‰¿èª</div>
                <div class="text-xs text-gray-500">æœŸé™: æ˜æ—¥</div>
            </div>
        </li>
        <li class="action-item">
            <div class="action-priority low"></div>
            <div class="flex-1">
                <div class="font-medium">ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ</div>
                <div class="text-xs text-gray-500">æœŸé™: æ¥é€±</div>
            </div>
        </li>
    </ul>
</div>

<!-- æœ€è¿‘ã®æ´»å‹• -->
<div class="bg-gray-50 rounded-lg p-3">
    <h4 class="font-semibold text-gray-800 mb-2">ğŸ“ æœ€è¿‘ã®æ´»å‹•</h4>
    <div class="space-y-2 text-sm">
        <div class="flex items-center gap-2">
            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
            <span>FAQ 3ä»¶ãŒå…¬é–‹ã•ã‚Œã¾ã—ãŸ</span>
        </div>
        <div class="flex items-center gap-2">
            <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
            <span>æ–°ã—ã„éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
        </div>
        <div class="flex items-center gap-2">
            <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
            <span>ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡ãŒ2ä»¶è¿½åŠ </span>
        </div>
    </div>
</div>
{% endblock %}

{% block three_column_extra_js %}
<script>
// å¤–éƒ¨MTGè­°äº‹éŒ²å°‚ç”¨JavaScript

// ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ç®¡ç†
let selectedActivityId = 'activity-001';
let currentTab = 'overview';
let currentFilter = 'all';
let currentViewMode = 'stream';

// ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£é¸æŠ
function selectActivity(activityId) {
    // å‰ã®é¸æŠã‚’è§£é™¤
    document.querySelectorAll('.activity-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // æ–°ã—ã„é¸æŠã‚’è¨­å®š
    event.target.closest('.activity-card').classList.add('selected');
    selectedActivityId = activityId;
    
    // ãƒ¡ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®å†…å®¹ã‚’æ›´æ–°
    updateWorkspaceContent(activityId);
}

// ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å†…å®¹æ›´æ–°
function updateWorkspaceContent(activityId) {
    console.log('ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ›´æ–°:', activityId);
    
    // ãƒ‡ãƒ¢ç”¨: ç•°ãªã‚‹è¨˜éŒ²ã®å†…å®¹ã‚’è¡¨ç¤º
    const activityData = {
        'activity-002': {
            title: 'BlackRockå€‹åˆ¥é¢è«‡',
            investor: 'BlackRock Inc.',
            status: 'FAQç”Ÿæˆä¸­',
            progress: 75
        },
        'activity-003': {
            title: 'å€‹äººæŠ•è³‡å®¶èª¬æ˜ä¼š',
            investor: 'å€‹äººæŠ•è³‡å®¶',
            status: 'å…¬é–‹æ¸ˆã¿',
            progress: 100
        }
    };
    
    if (activityData[activityId]) {
        console.log('è¨˜éŒ²è©³ç´°ã‚’æ›´æ–°:', activityData[activityId]);
    }
}

// ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
function filterStream(filter) {
    document.querySelectorAll('.filter-chip').forEach(chip => {
        chip.classList.remove('active');
    });
    event.target.classList.add('active');
    
    currentFilter = filter;
    console.log('ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨:', filter);
}

// ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
function setViewMode(mode) {
    console.log('ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´:', mode);
    
    // å‰ã®ãƒ“ãƒ¥ãƒ¼ã‚’éè¡¨ç¤º
    const currentView = document.getElementById(`view-${currentViewMode}`);
    if (currentView) {
        currentView.classList.add('hidden');
        currentView.classList.remove('active');
    }
    
    // æ–°ã—ã„ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
    const newView = document.getElementById(`view-${mode}`);
    if (newView) {
        newView.classList.remove('hidden');
        newView.classList.add('active');
    }
    
    // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
    document.querySelectorAll('.btn-toolbar').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    currentViewMode = mode;
}

// è¨˜éŒ²ç·¨é›†
function editRecord(activityId) {
    console.log(`è¨˜éŒ²ç·¨é›†: ${activityId}`);
    showNotification(`ğŸ“ è¨˜éŒ²ã®ç·¨é›†ç”»é¢ã‚’é–‹ã„ã¦ã„ã¾ã™...`, 'info');
    
    setTimeout(() => {
        window.location.href = `/dialogue/edit?id=${activityId}`;
    }, 500);
}

// ãƒ—ãƒ­ã‚»ã‚¹åˆ¶å¾¡
function forceNextStage() {
    if (confirm('AIè¦ç´„ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦æ¬¡ã®æ®µéšã«é€²ã¿ã¾ã™ã‹ï¼Ÿ')) {
        showNotification('FAQç”Ÿæˆæ®µéšã«ç§»è¡Œã—ã¾ã—ãŸ', 'success');
    }
}

function cancelProcessing() {
    if (confirm('å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã‹ï¼Ÿ')) {
        showNotification('å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã—ãŸ', 'warning');
    }
}

// ä¸€æ‹¬å‡¦ç†
function bulkProcess() {
    showNotification('ä¸€æ‹¬å‡¦ç†æ©Ÿèƒ½ã‚’é–‹å§‹ã—ã¾ã™', 'info');
}

function exportData() {
    showNotification('ãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãå‡ºã—ä¸­...', 'info');
    setTimeout(function() {
        showNotification('æ›¸ãå‡ºã—ãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
    }, 2000);
}

function showFilters() {
    showNotification('è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½ã‚’é–‹ç™ºä¸­...', 'info');
}

// è©³ç´°ã‚¿ãƒ–æ©Ÿèƒ½
function switchDetailTab(tabName) {
    document.querySelectorAll('.workspace-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    event.target.classList.add('active');
    
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    
    const tabContent = document.getElementById(`tab-${tabName}`);
    if (tabContent) {
        tabContent.classList.add('active');
    }
    
    currentTab = tabName;
    console.log('è©³ç´°ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ:', tabName);
}

// åˆæœŸåŒ–å‡¦ç†è¿½åŠ 
document.addEventListener('DOMContentLoaded', function() {
    selectActivity('activity-001');
    
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    setTimeout(() => {
        const processingCircle = document.querySelector('.stage-circle.processing');
        if (processingCircle) {
            processingCircle.classList.remove('processing');
            processingCircle.classList.add('completed');
            processingCircle.innerHTML = 'âœ“';
        }
    }, 5000);
});
</script>
{% endblock %} 