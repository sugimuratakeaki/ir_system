{% extends 'base.html' %}

{% block title %}å¯¾è©±è¨˜éŒ²ã‚»ãƒ³ã‚¿ãƒ¼{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', path='/css/ir-management.css') }}">
<style>
/* æ¬¡ä¸–ä»£å¯¾è©±è¨˜éŒ²ç®¡ç†ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ */
.dialogue-center {
    display: grid;
    grid-template-columns: 320px 1fr 400px;
    grid-template-rows: auto 1fr;
    height: calc(100vh - 140px);
    gap: 1rem;
    grid-template-areas: 
        "activity-stream main-header intelligence-panel"
        "activity-stream main-content intelligence-panel";
    transition: grid-template-columns 0.3s ease;
}

.dialogue-center.intelligence-collapsed {
    grid-template-columns: 320px 1fr 0px;
    grid-template-areas: 
        "activity-stream main-header intelligence-panel"
        "activity-stream main-content intelligence-panel";
}

/* ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆå·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ */
.activity-stream {
    grid-area: activity-stream;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

.stream-header {
    background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
    color: white;
    padding: 1.5rem;
}

.stream-filters {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
}

.filter-chip {
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    cursor: pointer;
    transition: all 0.2s;
    border: 1px solid rgba(255, 255, 255, 0.3);
    color: rgba(255, 255, 255, 0.9);
}

.filter-chip.active {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.stream-content {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
}

/* ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚«ãƒ¼ãƒ‰ */
.activity-card {
    border: 2px solid transparent;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 0.75rem;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
    background: white;
    border-left: 4px solid #e5e7eb;
}

.activity-card:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.activity-card.selected {
    border-color: #3b82f6;
    background: #eff6ff;
    border-left-color: #3b82f6;
}

.activity-card.urgent {
    border-left-color: #ef4444;
    background: #fef2f2;
}

.activity-card.processing {
    border-left-color: #f59e0b;
    background: #fffbeb;
}

.activity-card.completed {
    border-left-color: #10b981;
    background: #f0fdfa;
}

.activity-header {
    display: flex;
    justify-content: between;
    align-items: center;
    margin-bottom: 0.5rem;
}

.activity-title {
    font-weight: 600;
    color: #1f2937;
    font-size: 0.875rem;
    line-height: 1.25rem;
}

.activity-time {
    font-size: 0.75rem;
    color: #6b7280;
}

.activity-meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.75rem;
    color: #6b7280;
}

.investor-badge {
    background: #f3f4f6;
    color: #374151;
    padding: 0.125rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
}

.activity-progress {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.progress-dots {
    display: flex;
    gap: 0.25rem;
}

.progress-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: #d1d5db;
}

.progress-dot.completed {
    background: #10b981;
}

.progress-dot.active {
    background: #3b82f6;
    animation: pulse 2s infinite;
}

.progress-label {
    font-size: 0.75rem;
    color: #6b7280;
}

/* ãƒ¡ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ */
.workspace-header {
    grid-area: main-header;
    background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
    color: white;
    padding: 1.5rem;
    border-radius: 12px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.workspace-main {
    grid-area: main-content;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
}

/* ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ï¼ˆå³ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ */
.intelligence-panel {
    grid-area: intelligence-panel;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    display: flex;
    flex-direction: column;
    transition: all 0.3s ease;
    position: relative;
}

.intelligence-panel.collapsed {
    width: 0;
    min-width: 0;
    overflow: hidden;
    opacity: 0;
    pointer-events: none;
}

.intelligence-header {
    background: #f8fafc;
    padding: 1rem;
    border-bottom: 1px solid #e5e7eb;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.intelligence-content {
    flex: 1;
    overflow-y: auto;
    padding: 1rem;
}

/* ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹é–‹é–‰ãƒœã‚¿ãƒ³ï¼ˆå›ºå®šä½ç½®ï¼‰ */
.intelligence-toggle {
    position: fixed;
    right: 15px;
    top: 50%;
    transform: translateY(-50%);
    width: 45px;
    height: 120px;
    background: linear-gradient(135deg, #10b981 0%, #14b8a6 100%);
    border-radius: 22px 0 0 22px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 100;
    transition: all 0.3s ease;
    box-shadow: -2px 0 8px rgba(0, 0, 0, 0.15);
    border: 2px solid rgba(255, 255, 255, 0.2);
    padding: 8px 0;
}

.intelligence-toggle:hover {
    background: linear-gradient(135deg, #047857 0%, #0f766e 100%);
    transform: translateY(-50%) translateX(-3px);
    box-shadow: -4px 0 12px rgba(0, 0, 0, 0.25);
}

.dialogue-center.intelligence-collapsed .intelligence-toggle {
    right: 0px;
    border-radius: 0 22px 22px 0;
    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.15);
}

.dialogue-center.intelligence-collapsed .intelligence-toggle:hover {
    transform: translateY(-50%) translateX(3px);
    box-shadow: 4px 0 12px rgba(0, 0, 0, 0.25);
}

.intelligence-toggle-icon {
    color: white;
    font-size: 1.6rem;
    font-weight: bold;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 0.25rem;
}

.intelligence-toggle-text {
    writing-mode: vertical-rl;
    text-orientation: mixed;
    font-size: 0.85rem;
    font-weight: 700;
    color: rgba(255, 255, 255, 0.95);
    margin-top: 0.75rem;
    text-align: center;
    letter-spacing: 0.1em;
    line-height: 1.2;
}

.dialogue-center.intelligence-collapsed .intelligence-toggle-icon {
    transform: rotate(180deg);
}

.dialogue-center.intelligence-collapsed .intelligence-toggle-text {
    writing-mode: vertical-lr;
    text-orientation: mixed;
}

/* å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³è¡¨ç¤º */
.pipeline-viewer {
    background: #f8fafc;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1.5rem;
}

.pipeline-stages {
    display: flex;
    justify-content: space-between;
    position: relative;
    margin-bottom: 0.5rem;
}

.pipeline-stages::before {
    content: '';
    position: absolute;
    top: 12px;
    left: 0;
    right: 0;
    height: 2px;
    background: #e5e7eb;
    z-index: 1;
}

.pipeline-stage {
    display: flex;
    flex-direction: column;
    align-items: center;
    z-index: 2;
    background: white;
    padding: 0 0.5rem;
    position: relative;
}

.stage-circle {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: #e5e7eb;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 0.25rem;
    transition: all 0.2s;
}

.stage-circle.completed {
    background: #10b981;
    color: white;
}

.stage-circle.active {
    background: #3b82f6;
    color: white;
    animation: pulse 2s infinite;
}

.stage-circle.processing {
    background: #f59e0b;
    color: white;
    position: relative;
}

.stage-label {
    font-size: 0.625rem;
    color: #6b7280;
    text-align: center;
    line-height: 1.2;
}

/* ãƒ“ãƒ¥ãƒ¼ã‚·ã‚¹ãƒ†ãƒ  */
.view-content {
    flex: 1;
    padding: 1.5rem;
    overflow-y: auto;
    display: none;
}

.view-content.active {
    display: block;
}

/* ã‚¿ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚·ã‚¹ãƒ†ãƒ  */
.workspace-tabs {
    display: flex;
    background: #f8fafc;
    border-bottom: 1px solid #e5e7eb;
}

.workspace-tab {
    padding: 0.75rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: #6b7280;
    cursor: pointer;
    border-bottom: 2px solid transparent;
    transition: all 0.2s;
}

.workspace-tab.active {
    color: #3b82f6;
    border-bottom-color: #3b82f6;
    background: white;
}

.workspace-tab:hover:not(.active) {
    color: #374151;
    background: #f3f4f6;
}

.tab-content {
    flex: 1;
    padding: 1.5rem;
    overflow-y: auto;
    display: none;
}

.tab-content.active {
    display: block;
}

/* ã‹ã‚“ã°ã‚“ãƒœãƒ¼ãƒ‰ */
.kanban-board {
    display: flex;
    gap: 1rem;
    min-height: 600px;
    overflow-x: auto;
    padding-bottom: 1rem;
}

.kanban-column {
    min-width: 280px;
    background: #f8fafc;
    border-radius: 8px;
    display: flex;
    flex-direction: column;
}

.kanban-header {
    padding: 1rem;
    border-bottom: 1px solid #e5e7eb;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.kanban-content {
    flex: 1;
    padding: 1rem;
    overflow-y: auto;
}

.kanban-card {
    background: white;
    border-radius: 6px;
    padding: 0.75rem;
    margin-bottom: 0.75rem;
    border: 1px solid #e5e7eb;
    cursor: pointer;
    transition: all 0.2s;
}

.kanban-card:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
}

.kanban-card.urgent {
    border-left: 4px solid #ef4444;
    background: #fef2f2;
}

.kanban-card.processing {
    border-left: 4px solid #f59e0b;
}

.kanban-card.completed {
    border-left: 4px solid #10b981;
    background: #f0fdfa;
}

.kanban-card-header {
    display: flex;
    justify-content: space-between;
    align-items: start;
    margin-bottom: 0.5rem;
}

.kanban-card-meta {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
}

.kanban-card-assignee, .kanban-card-stats {
    font-size: 0.75rem;
    color: #6b7280;
}

.progress-bar-mini {
    height: 4px;
    background: #e5e7eb;
    border-radius: 2px;
    overflow: hidden;
}

.progress-fill {
    height: 100%;
    background: #3b82f6;
    transition: width 0.3s ease;
}

.progress-fill.stalled {
    background: #ef4444;
    animation: pulse 1s infinite;
}

.progress-fill.processing {
    background: #f59e0b;
}

.progress-fill.completed {
    background: #10b981;
}

/* ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ« */
.table-container {
    background: white;
    border-radius: 8px;
}

.table-controls {
    padding: 1rem;
    border-bottom: 1px solid #e5e7eb;
}

.data-table-wrapper {
    overflow-x: auto;
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.875rem;
}

.data-table th {
    background: #f8fafc;
    padding: 0.75rem;
    text-align: left;
    font-weight: 600;
    color: #374151;
    border-bottom: 2px solid #e5e7eb;
    white-space: nowrap;
}

.data-table th.sortable {
    cursor: pointer;
    position: relative;
}

.data-table th.sortable:hover {
    background: #f1f5f9;
}

.sort-icon {
    margin-left: 0.25rem;
    color: #9ca3af;
    font-size: 0.75rem;
}

.data-table td {
    padding: 0.75rem;
    border-bottom: 1px solid #f3f4f6;
    vertical-align: middle;
}

.table-row {
    cursor: pointer;
    transition: background-color 0.2s;
}

.table-row:hover {
    background: #f8fafc;
}

.table-row.urgent {
    background: #fef2f2;
}

.table-row.processing {
    background: #fffbeb;
}

.table-row.completed {
    background: #f0fdfa;
}

.table-row.selected {
    background: #eff6ff;
    border-left: 4px solid #3b82f6;
}

.status-badge {
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-size: 0.75rem;
    font-weight: 500;
}

.status-badge.urgent {
    background: #fee2e2;
    color: #dc2626;
}

.status-badge.processing {
    background: #fef3c7;
    color: #d97706;
}

.status-badge.completed {
    background: #d1fae5;
    color: #059669;
}

.progress-bar-table {
    width: 60px;
    height: 6px;
    background: #e5e7eb;
    border-radius: 3px;
    overflow: hidden;
    margin: 0 auto;
}

.ai-score-container {
    text-align: center;
}

.ai-score {
    font-weight: 600;
    font-size: 0.875rem;
}

.ai-score.high {
    color: #059669;
}

.ai-score.medium {
    color: #d97706;
}

.ai-score.low {
    color: #dc2626;
}

.action-buttons {
    display: flex;
    gap: 0.25rem;
}

.btn-action {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    border: 1px solid #d1d5db;
    background: white;
    color: #374151;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.2s;
}

.btn-action:hover {
    background: #f3f4f6;
    border-color: #9ca3af;
}

.bulk-action-bar {
    padding: 1rem;
    background: #f8fafc;
    border-top: 1px solid #e5e7eb;
    border-radius: 0 0 8px 8px;
}

.pagination-mini {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.btn-pagination {
    padding: 0.25rem 0.5rem;
    border: 1px solid #d1d5db;
    background: white;
    color: #374151;
    border-radius: 4px;
    cursor: pointer;
    font-size: 0.875rem;
}

.btn-pagination:hover {
    background: #f3f4f6;
}

.pagination-info {
    font-size: 0.875rem;
    color: #6b7280;
}

/* ãƒãƒƒã‚¸ */
.badge {
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
}

.badge-blue {
    background: #dbeafe;
    color: #1d4ed8;
}

.badge-green {
    background: #d1fae5;
    color: #059669;
}

.badge-red {
    background: #fee2e2;
    color: #dc2626;
}

.badge-purple {
    background: #e9d5ff;
    color: #7c3aed;
}

.badge-gray {
    background: #f3f4f6;
    color: #374151;
}

/* ãƒ¢ãƒ¼ãƒ€ãƒ«ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
.export-format-option {
    position: relative;
    cursor: pointer;
}

.export-format-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    pointer-events: none;
}

.format-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 1rem;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    background: white;
    transition: all 0.2s;
}

.export-format-option input[type="radio"]:checked + .format-card {
    border-color: #3b82f6;
    background: #eff6ff;
}

.format-card:hover {
    border-color: #9ca3af;
}

.form-control-sm {
    padding: 0.375rem 0.5rem;
    font-size: 0.875rem;
    border: 1px solid #d1d5db;
    border-radius: 4px;
    background: white;
    transition: border-color 0.2s;
}

.form-control-sm:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.btn-sm {
    padding: 0.375rem 0.75rem;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: 4px;
    border: 1px solid transparent;
    cursor: pointer;
    transition: all 0.2s;
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
}

.btn-sm.btn-primary {
    background: #3b82f6;
    color: white;
    border-color: #3b82f6;
}

.btn-sm.btn-primary:hover {
    background: #2563eb;
    border-color: #2563eb;
}

.btn-sm.btn-secondary {
    background: #f3f4f6;
    color: #374151;
    border-color: #d1d5db;
}

.btn-sm.btn-secondary:hover {
    background: #e5e7eb;
    border-color: #9ca3af;
}

/* AIåˆ†æè¡¨ç¤º */
.ai-insights {
    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
    border: 1px solid #0284c7;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.insight-header {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-weight: 600;
    color: #0c4a6e;
    margin-bottom: 0.5rem;
}

.insight-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.insight-item {
    display: flex;
    align-items: start;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
    color: #0c4a6e;
}

.insight-icon {
    flex-shrink: 0;
    margin-top: 0.125rem;
}

/* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ« */
.action-panel {
    background: #fefce8;
    border: 1px solid #eab308;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.action-header {
    display: flex;
    align-items: center;
    justify-content: between;
    margin-bottom: 0.75rem;
}

.action-title {
    font-weight: 600;
    color: #a16207;
}

.action-count {
    background: #eab308;
    color: white;
    font-size: 0.75rem;
    padding: 0.125rem 0.5rem;
    border-radius: 9999px;
}

.action-list {
    list-style: none;
    padding: 0;
    margin: 0;
}

.action-item {
    display: flex;
    align-items: center;
    justify-content: between;
    padding: 0.5rem;
    background: white;
    border-radius: 4px;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
}

.action-priority {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    margin-right: 0.5rem;
}

.action-priority.high {
    background: #ef4444;
}

.action-priority.medium {
    background: #f59e0b;
}

.action-priority.low {
    background: #10b981;
}

/* çµ±è¨ˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ */
.stats-widget {
    background: #f8fafc;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.stats-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
}

.stat-item {
    text-align: center;
}

.stat-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: #1f2937;
}

.stat-label {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 0.25rem;
}

.stat-trend {
    font-size: 0.75rem;
    margin-top: 0.25rem;
}

.stat-trend.positive {
    color: #10b981;
}

.stat-trend.negative {
    color: #ef4444;
}

/* ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ */
.toolbar {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 1rem;
    background: #f8fafc;
    border-bottom: 1px solid #e5e7eb;
}

.toolbar-group {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.toolbar-separator {
    width: 1px;
    height: 1.5rem;
    background: #d1d5db;
    margin: 0 0.5rem;
}

.btn-toolbar {
    padding: 0.375rem 0.75rem;
    font-size: 0.875rem;
    font-weight: 500;
    border-radius: 6px;
    border: 1px solid #d1d5db;
    background: white;
    color: #374151;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    gap: 0.375rem;
}

.btn-toolbar:hover {
    background: #f3f4f6;
    border-color: #9ca3af;
}

.btn-toolbar.active {
    background: #3b82f6;
    border-color: #3b82f6;
    color: white;
}

/* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
@media (max-width: 1200px) {
    .dialogue-center {
        grid-template-columns: 280px 1fr 350px;
    }
    
    .dialogue-center.intelligence-collapsed {
        grid-template-columns: 280px 1fr 0px;
    }
}

@media (max-width: 992px) {
    .dialogue-center {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto 1fr;
        grid-template-areas: 
            "main-header"
            "activity-stream"
            "main-content";
    }
    
    .dialogue-center.intelligence-collapsed {
        grid-template-columns: 1fr;
        grid-template-areas: 
            "main-header"
            "activity-stream"
            "main-content";
    }
    
    .intelligence-panel {
        display: none;
    }
    
    .activity-stream {
        max-height: 200px;
    }
    
    .intelligence-toggle {
        width: 40px;
        height: 100px;
        right: 10px;
        padding: 6px 0;
    }
    
    .dialogue-center.intelligence-collapsed .intelligence-toggle {
        right: -5px;
    }
    
    .intelligence-toggle-icon {
        font-size: 1.2rem;
    }
    
    .intelligence-toggle-text {
        font-size: 0.75rem;
        margin-top: 0.5rem;
    }
}

@media (max-width: 768px) {
    .dialogue-center {
        grid-template-columns: 1fr;
        grid-template-rows: auto auto 1fr;
        height: calc(100vh - 120px);
    }
    
    .activity-stream {
        max-height: 150px;
    }
    
    .intelligence-toggle {
        display: none;
    }
}

@keyframes pulse {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.5;
    }
}

/* ã‚«ã‚¹ã‚¿ãƒ ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒãƒ¼ */
.stream-content::-webkit-scrollbar,
.intelligence-content::-webkit-scrollbar,
.tab-content::-webkit-scrollbar {
    width: 4px;
}

.stream-content::-webkit-scrollbar-track,
.intelligence-content::-webkit-scrollbar-track,
.tab-content::-webkit-scrollbar-track {
    background: #f1f5f9;
}

.stream-content::-webkit-scrollbar-thumb,
.intelligence-content::-webkit-scrollbar-thumb,
.tab-content::-webkit-scrollbar-thumb {
    background: #cbd5e1;
    border-radius: 2px;
}

.stream-content::-webkit-scrollbar-thumb:hover,
.intelligence-content::-webkit-scrollbar-thumb:hover,
.tab-content::-webkit-scrollbar-thumb:hover {
    background: #94a3b8;
}
</style>
{% endblock %}

{% block content %}
<div class="dialogue-center">
    <!-- ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¹ãƒˆãƒªãƒ¼ãƒ ï¼ˆå·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ -->
    <div class="activity-stream">
        <div class="stream-header">
            <div class="flex items-center justify-between mb-2">
                <h3 class="text-lg font-bold">å¯¾è©±è¨˜éŒ²ã‚¹ãƒˆãƒªãƒ¼ãƒ </h3>
                <span class="text-sm opacity-75">156ä»¶</span>
            </div>
            <div class="stream-filters">
                <div class="filter-chip active" onclick="filterStream('all')">å…¨ã¦</div>
                <div class="filter-chip" onclick="filterStream('urgent')">ç·Šæ€¥ (3)</div>
                <div class="filter-chip" onclick="filterStream('processing')">å‡¦ç†ä¸­ (12)</div>
                <div class="filter-chip" onclick="filterStream('today')">ä»Šæ—¥ (5)</div>
            </div>
        </div>
        
        <div class="stream-content">
            <!-- ç·Šæ€¥å¯¾å¿œãŒå¿…è¦ãªè¨˜éŒ² -->
            <div class="activity-card urgent selected" onclick="selectActivity('activity-001')">
                <div class="activity-header">
                    <div class="activity-title">é‡æ‘AMæ±ºç®—èª¬æ˜ä¼š</div>
                    <div class="activity-time">2æ™‚é–“å‰</div>
                </div>
                <div class="activity-meta">
                    <span class="investor-badge">æ©Ÿé–¢æŠ•è³‡å®¶</span>
                    <span>â€¢</span>
                    <span>90åˆ†</span>
                    <span>â€¢</span>
                    <span class="text-red-600 font-medium">å‡¦ç†åœæ»</span>
                </div>
                <div class="activity-progress">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>
                    <div class="progress-label">AIè¦ç´„ä¸­</div>
                </div>
            </div>
            
            <!-- å‡¦ç†ä¸­ã®è¨˜éŒ² -->
            <div class="activity-card processing" onclick="selectActivity('activity-002')">
                <div class="activity-header">
                    <div class="activity-title">BlackRockå€‹åˆ¥é¢è«‡</div>
                    <div class="activity-time">5æ™‚é–“å‰</div>
                </div>
                <div class="activity-meta">
                    <span class="investor-badge">æµ·å¤–æŠ•è³‡å®¶</span>
                    <span>â€¢</span>
                    <span>45åˆ†</span>
                    <span>â€¢</span>
                    <span class="text-yellow-600 font-medium">FAQä½œæˆä¸­</span>
                </div>
                <div class="activity-progress">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>
                    <div class="progress-label">FAQç”Ÿæˆä¸­</div>
                </div>
            </div>
            
            <!-- å®Œäº†æ¸ˆã¿ã®è¨˜éŒ² -->
            <div class="activity-card completed" onclick="selectActivity('activity-003')">
                <div class="activity-header">
                    <div class="activity-title">å€‹äººæŠ•è³‡å®¶èª¬æ˜ä¼š</div>
                    <div class="activity-time">1æ—¥å‰</div>
                </div>
                <div class="activity-meta">
                    <span class="investor-badge">å€‹äººæŠ•è³‡å®¶</span>
                    <span>â€¢</span>
                    <span>2æ™‚é–“</span>
                    <span>â€¢</span>
                    <span class="text-green-600 font-medium">å…¬é–‹æ¸ˆã¿</span>
                </div>
                <div class="activity-progress">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                    </div>
                    <div class="progress-label">å®Œäº†</div>
                </div>
            </div>
            
            <!-- ä»Šæ—¥äºˆå®šã®è¨˜éŒ² -->
            <div class="activity-card" onclick="selectActivity('activity-004')">
                <div class="activity-header">
                    <div class="activity-title">Vanguardå®šæœŸé¢è«‡</div>
                    <div class="activity-time">14:00äºˆå®š</div>
                </div>
                <div class="activity-meta">
                    <span class="investor-badge">æµ·å¤–æŠ•è³‡å®¶</span>
                    <span>â€¢</span>
                    <span>60åˆ†</span>
                    <span>â€¢</span>
                    <span class="text-blue-600 font-medium">æº–å‚™å®Œäº†</span>
                </div>
                <div class="activity-progress">
                    <div class="progress-dots">
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                        <div class="progress-dot"></div>
                    </div>
                    <div class="progress-label">å®Ÿæ–½å¾…ã¡</div>
                </div>
            </div>
            
            <!-- è¿½åŠ ã®è¨˜éŒ²... -->
            <div class="activity-card" onclick="selectActivity('activity-005')">
                <div class="activity-header">
                    <div class="activity-title">ã‚¢ãƒŠãƒªã‚¹ãƒˆå‘ã‘èª¬æ˜ä¼š</div>
                    <div class="activity-time">2æ—¥å‰</div>
                </div>
                <div class="activity-meta">
                    <span class="investor-badge">ã‚¢ãƒŠãƒªã‚¹ãƒˆ</span>
                    <span>â€¢</span>
                    <span>75åˆ†</span>
                    <span>â€¢</span>
                    <span class="text-yellow-600 font-medium">ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡</span>
                </div>
                <div class="activity-progress">
                    <div class="progress-dots">
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot completed"></div>
                        <div class="progress-dot active"></div>
                        <div class="progress-dot"></div>
                    </div>
                    <div class="progress-label">æ‰¿èªå¾…ã¡</div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="workspace-header">
        <div>
            <h1 class="text-2xl font-bold mb-1">å¯¾è©±è¨˜éŒ²ã‚»ãƒ³ã‚¿ãƒ¼</h1>
            <p class="text-blue-100">çµ±åˆã•ã‚ŒãŸã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ã‚¹ãƒˆãƒªãƒ¼ãƒ ç®¡ç†</p>
        </div>
        <div class="flex items-center gap-4">
            <div class="text-right">
                <p class="text-sm text-blue-200">å‡¦ç†ä¸­</p>
                <p class="text-2xl font-bold">12ä»¶</p>
            </div>
            <div class="text-right">
                <p class="text-sm text-blue-200">ç·Šæ€¥å¯¾å¿œ</p>
                <p class="text-2xl font-bold text-yellow-300">3ä»¶</p>
            </div>
            <div class="text-right">
                <p class="text-sm text-blue-200">ä»Šæ—¥å®Œäº†</p>
                <p class="text-2xl font-bold text-green-300">8ä»¶</p>
            </div>
        </div>
    </div>
    
    <!-- ãƒ¡ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ -->
    <div class="workspace-main">
        <!-- ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ -->
        <div class="toolbar">
            <div class="toolbar-group">
                <button class="btn-toolbar" onclick="bulkProcess()">
                    <span>âš¡</span>
                    <span>ä¸€æ‹¬å‡¦ç†</span>
                </button>
                <button class="btn-toolbar" onclick="exportData()">
                    <span>ğŸ“¥</span>
                    <span>ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</span>
                </button>
            </div>
            <div class="toolbar-separator"></div>
            <div class="toolbar-group">
                <button class="btn-toolbar active" onclick="setViewMode('stream')">
                    <span>ğŸ“Š</span>
                    <span>ã‚¹ãƒˆãƒªãƒ¼ãƒ </span>
                </button>
                <button class="btn-toolbar" onclick="setViewMode('kanban')">
                    <span>ğŸ“‹</span>
                    <span>ã‹ã‚“ã°ã‚“</span>
                </button>
                <button class="btn-toolbar" onclick="setViewMode('table')">
                    <span>ğŸ“‘</span>
                    <span>ãƒ†ãƒ¼ãƒ–ãƒ«</span>
                </button>
            </div>
            <div class="toolbar-separator"></div>
            <div class="toolbar-group">
                <button class="btn-toolbar" onclick="showFilters()">
                    <span>ğŸ”</span>
                    <span>è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿</span>
                </button>
            </div>
        </div>
        
        <!-- ã‚¿ãƒ–ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰æ™‚ã¯éè¡¨ç¤ºã€é¸æŠè¨˜éŒ²ã®è©³ç´°æ™‚ã«è¡¨ç¤ºï¼‰ -->
        <div class="workspace-tabs" id="detailTabs" style="display: none;">
            <div class="workspace-tab active" onclick="switchDetailTab('overview')">
                <span>ğŸ“Š æ¦‚è¦</span>
            </div>
            <div class="workspace-tab" onclick="switchDetailTab('transcript')">
                <span>ğŸ“ æ–‡å­—èµ·ã“ã—</span>
            </div>
            <div class="workspace-tab" onclick="switchDetailTab('analysis')">
                <span>ğŸ¤– AIåˆ†æ</span>
            </div>
            <div class="workspace-tab" onclick="switchDetailTab('timeline')">
                <span>â° ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</span>
            </div>
        </div>
        
        <!-- ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ“ãƒ¥ãƒ¼ -->
        <div id="view-stream" class="view-content active">
            <!-- é¸æŠã•ã‚ŒãŸè¨˜éŒ²ã®å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ -->
            <div class="pipeline-viewer">
                <h3 class="font-semibold text-gray-800 mb-3">å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ - é‡æ‘AMæ±ºç®—èª¬æ˜ä¼š</h3>
                <div class="pipeline-stages">
                    <div class="pipeline-stage">
                        <div class="stage-circle completed">âœ“</div>
                        <div class="stage-label">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</div>
                    </div>
                    <div class="pipeline-stage">
                        <div class="stage-circle completed">âœ“</div>
                        <div class="stage-label">æ–‡å­—èµ·ã“ã—</div>
                    </div>
                    <div class="pipeline-stage">
                        <div class="stage-circle processing">â³</div>
                        <div class="stage-label">AIè¦ç´„</div>
                    </div>
                    <div class="pipeline-stage">
                        <div class="stage-circle">4</div>
                        <div class="stage-label">FAQä½œæˆ</div>
                    </div>
                    <div class="pipeline-stage">
                        <div class="stage-circle">5</div>
                        <div class="stage-label">ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
                    </div>
                    <div class="pipeline-stage">
                        <div class="stage-circle">6</div>
                        <div class="stage-label">å…¬é–‹</div>
                    </div>
                </div>
                <div class="bg-blue-50 rounded-lg p-3 mt-3">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse"></div>
                        <span class="text-sm text-blue-800 font-medium">AIè¦ç´„å‡¦ç†ä¸­...</span>
                        <span class="text-sm text-blue-600">æ¨å®šæ®‹ã‚Šæ™‚é–“: 3åˆ†</span>
                    </div>
                    <div class="w-full bg-blue-200 rounded-full h-2 mt-2">
                        <div class="bg-blue-600 h-2 rounded-full animate-pulse" style="width: 65%"></div>
                    </div>
                </div>
            </div>
            
            <!-- åŸºæœ¬æƒ…å ±ã‚«ãƒ¼ãƒ‰ -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">ğŸ“‹ åŸºæœ¬æƒ…å ±</h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">æŠ•è³‡å®¶</span>
                            <span class="font-medium">é‡æ‘ã‚¢ã‚»ãƒƒãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">ç¨®åˆ¥</span>
                            <span class="font-medium">æ±ºç®—èª¬æ˜ä¼š</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">æ—¥æ™‚</span>
                            <span class="font-medium">2024/12/26 15:00</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">æ™‚é–“</span>
                            <span class="font-medium">90åˆ†</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">å‚åŠ è€…</span>
                            <span class="font-medium">CEO, CFO, IRéƒ¨é•·</span>
                        </div>
                    </div>
                </div>
                
                <div class="bg-gray-50 rounded-lg p-4">
                    <h4 class="font-semibold text-gray-800 mb-3">ğŸ“Š å‡¦ç†çµ±è¨ˆ</h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-gray-600">æ–‡å­—æ•°</span>
                            <span class="font-medium">15,680æ–‡å­—</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">æ–‡å­—èµ·ã“ã—ç²¾åº¦</span>
                            <span class="font-medium text-green-600">96%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">å‡¦ç†é–‹å§‹</span>
                            <span class="font-medium">2æ™‚é–“å‰</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">é€²æ—</span>
                            <span class="font-medium text-blue-600">65%</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">æ‹…å½“è€…</span>
                            <span class="font-medium">IRæ‹…å½“è€…A</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
            <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                <div class="flex items-center gap-2 mb-2">
                    <span class="text-xl">âš¡</span>
                    <h4 class="font-semibold text-yellow-800">æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h4>
                </div>
                <p class="text-sm text-yellow-700 mb-3">AIè¦ç´„ãŒå®Œäº†æ¬¡ç¬¬ã€FAQç”Ÿæˆã«é€²ã¿ã¾ã™ã€‚æ‰‹å‹•ã§ä»‹å…¥ã™ã‚‹å ´åˆã¯ä¸‹è¨˜ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ãã ã•ã„ã€‚</p>
                <div class="flex gap-2">
                    <button class="px-3 py-1.5 bg-yellow-500 text-white rounded text-sm font-medium hover:bg-yellow-600" onclick="forceNextStage()">
                        å¼·åˆ¶çš„ã«æ¬¡ã¸é€²ã‚€
                    </button>
                    <button class="px-3 py-1.5 bg-white text-yellow-700 border border-yellow-300 rounded text-sm font-medium hover:bg-yellow-50" onclick="cancelProcessing()">
                        å‡¦ç†ã‚’ä¸­æ–­
                    </button>
                </div>
            </div>
        </div>
        
        <!-- ã‹ã‚“ã°ã‚“ãƒ“ãƒ¥ãƒ¼ -->
        <div id="view-kanban" class="view-content hidden">
            <div class="kanban-board">
                <div class="kanban-column">
                    <div class="kanban-header">
                        <h3 class="font-semibold text-gray-700">ğŸ“¤ ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾…ã¡</h3>
                        <span class="bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs">2ä»¶</span>
                    </div>
                    <div class="kanban-content">
                        <div class="kanban-card">
                            <div class="kanban-card-header">
                                <h4 class="font-medium text-sm">Vanguardå®šæœŸé¢è«‡</h4>
                                <span class="text-xs text-gray-500">14:00äºˆå®š</span>
                            </div>
                            <div class="kanban-card-meta">
                                <span class="badge badge-blue">æµ·å¤–æŠ•è³‡å®¶</span>
                                <span class="text-xs text-gray-500">60åˆ†</span>
                            </div>
                            <div class="kanban-card-assignee">
                                <span class="text-xs text-gray-600">æ‹…å½“: IRæ‹…å½“è€…A</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="kanban-column">
                    <div class="kanban-header">
                        <h3 class="font-semibold text-gray-700">ğŸ“ æ–‡å­—èµ·ã“ã—ä¸­</h3>
                        <span class="bg-blue-100 text-blue-600 px-2 py-1 rounded-full text-xs">1ä»¶</span>
                    </div>
                    <div class="kanban-content">
                        <div class="kanban-card processing">
                            <div class="kanban-card-header">
                                <h4 class="font-medium text-sm">å€‹åˆ¥ãƒ•ã‚¡ãƒ³ãƒ‰ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h4>
                                <span class="text-xs text-blue-600">å‡¦ç†ä¸­ (85%)</span>
                            </div>
                            <div class="kanban-card-meta">
                                <span class="badge badge-green">æ©Ÿé–¢æŠ•è³‡å®¶</span>
                                <span class="text-xs text-gray-500">30åˆ†</span>
                            </div>
                            <div class="progress-bar-mini">
                                <div class="progress-fill" style="width: 85%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="kanban-column">
                    <div class="kanban-header">
                        <h3 class="font-semibold text-gray-700">ğŸ¤– AIåˆ†æä¸­</h3>
                        <span class="bg-yellow-100 text-yellow-600 px-2 py-1 rounded-full text-xs">3ä»¶</span>
                    </div>
                    <div class="kanban-content">
                        <div class="kanban-card urgent processing">
                            <div class="kanban-card-header">
                                <h4 class="font-medium text-sm">é‡æ‘AMæ±ºç®—èª¬æ˜ä¼š</h4>
                                <span class="text-xs text-red-600">å‡¦ç†åœæ»</span>
                            </div>
                            <div class="kanban-card-meta">
                                <span class="badge badge-red">ç·Šæ€¥</span>
                                <span class="text-xs text-gray-500">90åˆ†</span>
                            </div>
                            <div class="progress-bar-mini">
                                <div class="progress-fill stalled" style="width: 65%"></div>
                            </div>
                        </div>
                        
                        <div class="kanban-card processing">
                            <div class="kanban-card-header">
                                <h4 class="font-medium text-sm">ESGæŠ•è³‡å®¶æ‡‡è«‡ä¼š</h4>
                                <span class="text-xs text-blue-600">è¦ç´„ç”Ÿæˆä¸­</span>
                            </div>
                            <div class="kanban-card-meta">
                                <span class="badge badge-purple">ESGç‰¹åŒ–</span>
                                <span class="text-xs text-gray-500">2æ™‚é–“</span>
                            </div>
                            <div class="progress-bar-mini">
                                <div class="progress-fill" style="width: 45%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="kanban-column">
                    <div class="kanban-header">
                        <h3 class="font-semibold text-gray-700">â“ FAQä½œæˆä¸­</h3>
                        <span class="bg-orange-100 text-orange-600 px-2 py-1 rounded-full text-xs">2ä»¶</span>
                    </div>
                    <div class="kanban-content">
                        <div class="kanban-card processing">
                            <div class="kanban-card-header">
                                <h4 class="font-medium text-sm">BlackRockå€‹åˆ¥é¢è«‡</h4>
                                <span class="text-xs text-blue-600">FAQç”Ÿæˆä¸­ (75%)</span>
                            </div>
                            <div class="kanban-card-meta">
                                <span class="badge badge-blue">æµ·å¤–æŠ•è³‡å®¶</span>
                                <span class="text-xs text-gray-500">45åˆ†</span>
                            </div>
                            <div class="progress-bar-mini">
                                <div class="progress-fill" style="width: 75%"></div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="kanban-column">
                    <div class="kanban-header">
                        <h3 class="font-semibold text-gray-700">âœ… ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡</h3>
                        <span class="bg-purple-100 text-purple-600 px-2 py-1 rounded-full text-xs">5ä»¶</span>
                    </div>
                    <div class="kanban-content">
                        <div class="kanban-card">
                            <div class="kanban-card-header">
                                <h4 class="font-medium text-sm">ã‚¢ãƒŠãƒªã‚¹ãƒˆå‘ã‘èª¬æ˜ä¼š</h4>
                                <span class="text-xs text-gray-500">2æ—¥å‰</span>
                            </div>
                            <div class="kanban-card-meta">
                                <span class="badge badge-gray">ã‚¢ãƒŠãƒªã‚¹ãƒˆ</span>
                                <span class="text-xs text-gray-500">75åˆ†</span>
                            </div>
                            <div class="kanban-card-assignee">
                                <span class="text-xs text-purple-600">æ‰¿èªå¾…ã¡: IRéƒ¨é•·</span>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="kanban-column">
                    <div class="kanban-header">
                        <h3 class="font-semibold text-gray-700">ğŸŒ å…¬é–‹æ¸ˆã¿</h3>
                        <span class="bg-green-100 text-green-600 px-2 py-1 rounded-full text-xs">8ä»¶</span>
                    </div>
                    <div class="kanban-content">
                        <div class="kanban-card completed">
                            <div class="kanban-card-header">
                                <h4 class="font-medium text-sm">å€‹äººæŠ•è³‡å®¶èª¬æ˜ä¼š</h4>
                                <span class="text-xs text-green-600">å…¬é–‹æ¸ˆã¿</span>
                            </div>
                            <div class="kanban-card-meta">
                                <span class="badge badge-green">å€‹äººæŠ•è³‡å®¶</span>
                                <span class="text-xs text-gray-500">2æ™‚é–“</span>
                            </div>
                            <div class="kanban-card-stats">
                                <span class="text-xs text-gray-600">FAQ: 15ä»¶ä½œæˆ</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ“ãƒ¥ãƒ¼ -->
        <div id="view-table" class="view-content hidden">
            <div class="table-container">
                <div class="table-controls mb-4">
                    <div class="flex justify-between items-center">
                        <div class="flex items-center gap-2">
                            <button class="btn-sm btn-secondary" onclick="selectAllRecords()">
                                <input type="checkbox" id="selectAllTable" class="mr-1"> å…¨é¸æŠ
                            </button>
                            <span class="text-sm text-gray-600">156ä»¶ä¸­ 20ä»¶è¡¨ç¤º</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <select class="form-control-sm" onchange="changeTablePageSize(this.value)">
                                <option value="20">20ä»¶/ãƒšãƒ¼ã‚¸</option>
                                <option value="50">50ä»¶/ãƒšãƒ¼ã‚¸</option>
                                <option value="100">100ä»¶/ãƒšãƒ¼ã‚¸</option>
                            </select>
                            <div class="pagination-mini">
                                <button class="btn-pagination" onclick="previousTablePage()">â€¹</button>
                                <span class="pagination-info">1/8</span>
                                <button class="btn-pagination" onclick="nextTablePage()">â€º</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="data-table-wrapper">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th width="40px">
                                    <input type="checkbox" onclick="toggleAllTableRows(this)">
                                </th>
                                <th width="120px" class="sortable" onclick="sortTable('date')">
                                    æ—¥æ™‚ <span class="sort-icon">â†•</span>
                                </th>
                                <th width="200px" class="sortable" onclick="sortTable('title')">
                                    ã‚¿ã‚¤ãƒˆãƒ« <span class="sort-icon">â†•</span>
                                </th>
                                <th width="150px" class="sortable" onclick="sortTable('investor')">
                                    æŠ•è³‡å®¶ <span class="sort-icon">â†•</span>
                                </th>
                                <th width="100px" class="sortable" onclick="sortTable('duration')">
                                    æ™‚é–“ <span class="sort-icon">â†•</span>
                                </th>
                                <th width="120px" class="sortable" onclick="sortTable('status')">
                                    ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ <span class="sort-icon">â†•</span>
                                </th>
                                <th width="100px" class="sortable" onclick="sortTable('progress')">
                                    é€²æ— <span class="sort-icon">â†•</span>
                                </th>
                                <th width="120px" class="sortable" onclick="sortTable('assignee')">
                                    æ‹…å½“è€… <span class="sort-icon">â†•</span>
                                </th>
                                <th width="150px" class="sortable" onclick="sortTable('ai_score')">
                                    AIåˆ†æã‚¹ã‚³ã‚¢ <span class="sort-icon">â†•</span>
                                </th>
                                <th width="100px">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="table-row urgent" onclick="selectTableRow(this)">
                                <td><input type="checkbox" onclick="event.stopPropagation()"></td>
                                <td>
                                    <div class="text-sm font-medium">2024/12/26</div>
                                    <div class="text-xs text-gray-500">15:00</div>
                                </td>
                                <td>
                                    <div class="font-medium">é‡æ‘AMæ±ºç®—èª¬æ˜ä¼š</div>
                                    <div class="text-xs text-gray-500">æ±ºç®—èª¬æ˜ä¼š</div>
                                </td>
                                <td>
                                    <div class="text-sm">é‡æ‘ã‚¢ã‚»ãƒƒãƒˆ</div>
                                    <div class="badge badge-blue">æ©Ÿé–¢æŠ•è³‡å®¶</div>
                                </td>
                                <td class="text-sm">90åˆ†</td>
                                <td>
                                    <span class="status-badge urgent">å‡¦ç†åœæ»</span>
                                </td>
                                <td>
                                    <div class="progress-bar-table">
                                        <div class="progress-fill urgent" style="width: 65%"></div>
                                    </div>
                                    <div class="text-xs text-center">65%</div>
                                </td>
                                <td class="text-sm">IRæ‹…å½“è€…A</td>
                                <td>
                                    <div class="ai-score-container">
                                        <div class="ai-score high">96%</div>
                                        <div class="text-xs text-gray-500">ç²¾åº¦</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-action" onclick="editRecord('activity-001')">ç·¨é›†</button>
                                        <button class="btn-action" onclick="viewRecord('activity-001')">è©³ç´°</button>
                                    </div>
                                </td>
                            </tr>
                            
                            <tr class="table-row processing" onclick="selectTableRow(this)">
                                <td><input type="checkbox" onclick="event.stopPropagation()"></td>
                                <td>
                                    <div class="text-sm font-medium">2024/12/26</div>
                                    <div class="text-xs text-gray-500">10:00</div>
                                </td>
                                <td>
                                    <div class="font-medium">BlackRockå€‹åˆ¥é¢è«‡</div>
                                    <div class="text-xs text-gray-500">å€‹åˆ¥é¢è«‡</div>
                                </td>
                                <td>
                                    <div class="text-sm">BlackRock Inc.</div>
                                    <div class="badge badge-blue">æµ·å¤–æŠ•è³‡å®¶</div>
                                </td>
                                <td class="text-sm">45åˆ†</td>
                                <td>
                                    <span class="status-badge processing">FAQä½œæˆä¸­</span>
                                </td>
                                <td>
                                    <div class="progress-bar-table">
                                        <div class="progress-fill processing" style="width: 75%"></div>
                                    </div>
                                    <div class="text-xs text-center">75%</div>
                                </td>
                                <td class="text-sm">IRæ‹…å½“è€…B</td>
                                <td>
                                    <div class="ai-score-container">
                                        <div class="ai-score high">98%</div>
                                        <div class="text-xs text-gray-500">ç²¾åº¦</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-action" onclick="editRecord('activity-002')">ç·¨é›†</button>
                                        <button class="btn-action" onclick="viewRecord('activity-002')">è©³ç´°</button>
                                    </div>
                                </td>
                            </tr>
                            
                            <tr class="table-row completed" onclick="selectTableRow(this)">
                                <td><input type="checkbox" onclick="event.stopPropagation()"></td>
                                <td>
                                    <div class="text-sm font-medium">2024/12/25</div>
                                    <div class="text-xs text-gray-500">13:00</div>
                                </td>
                                <td>
                                    <div class="font-medium">å€‹äººæŠ•è³‡å®¶èª¬æ˜ä¼š</div>
                                    <div class="text-xs text-gray-500">èª¬æ˜ä¼š</div>
                                </td>
                                <td>
                                    <div class="text-sm">å€‹äººæŠ•è³‡å®¶</div>
                                    <div class="badge badge-green">å€‹äººæŠ•è³‡å®¶</div>
                                </td>
                                <td class="text-sm">2æ™‚é–“</td>
                                <td>
                                    <span class="status-badge completed">å…¬é–‹æ¸ˆã¿</span>
                                </td>
                                <td>
                                    <div class="progress-bar-table">
                                        <div class="progress-fill completed" style="width: 100%"></div>
                                    </div>
                                    <div class="text-xs text-center">100%</div>
                                </td>
                                <td class="text-sm">IRæ‹…å½“è€…C</td>
                                <td>
                                    <div class="ai-score-container">
                                        <div class="ai-score medium">94%</div>
                                        <div class="text-xs text-gray-500">ç²¾åº¦</div>
                                    </div>
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-action" onclick="editRecord('activity-003')">ç·¨é›†</button>
                                        <button class="btn-action" onclick="viewRecord('activity-003')">è©³ç´°</button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <!-- é¸æŠæ™‚ã®ä¸€æ‹¬æ“ä½œãƒãƒ¼ -->
                <div id="bulkActionBar" class="bulk-action-bar hidden">
                    <div class="flex justify-between items-center">
                        <div class="text-sm text-gray-700">
                            <span id="selectedCount">0</span>ä»¶ã‚’é¸æŠä¸­
                        </div>
                        <div class="flex gap-2">
                            <select class="form-control-sm" id="bulkActionSelect">
                                <option value="">ä¸€æ‹¬æ“ä½œã‚’é¸æŠ</option>
                                <option value="assign">æ‹…å½“è€…å¤‰æ›´</option>
                                <option value="status">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´</option>
                                <option value="priority">å„ªå…ˆåº¦å¤‰æ›´</option>
                                <option value="export">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</option>
                                <option value="delete">å‰Šé™¤</option>
                            </select>
                            <button class="btn-sm btn-primary" onclick="executeBulkTableAction()">å®Ÿè¡Œ</button>
                            <button class="btn-sm btn-secondary" onclick="clearTableSelection()">é¸æŠè§£é™¤</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- è©³ç´°ã‚¿ãƒ– -->
        <div id="tab-details" class="tab-content">
            <div class="space-y-4">
                <h3 class="font-semibold text-gray-800">ğŸ“ æ–‡å­—èµ·ã“ã—çµæœ</h3>
                <div class="bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto">
                    <div class="prose prose-sm max-w-none">
                        <p><strong>[00:00:15] CEO:</strong> çš†æ§˜ã€æœ¬æ—¥ã¯ãŠå¿™ã—ã„ä¸­ãŠæ™‚é–“ã‚’ã„ãŸã ãã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚ç¬¬3å››åŠæœŸæ±ºç®—ã«ã¤ã„ã¦èª¬æ˜ã•ã›ã¦ã„ãŸã ãã¾ã™ã€‚</p>
                        
                        <p><strong>[00:01:30] æŠ•è³‡å®¶A:</strong> æ¥­ç¸¾ã¯å¥½èª¿ã§ã™ãŒã€AIäº‹æ¥­ã®å…·ä½“çš„ãªåç›Šè²¢çŒ®åº¦ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚</p>
                        
                        <p><strong>[00:02:15] CEO:</strong> AIäº‹æ¥­ã¯å‰å¹´åŒæœŸæ¯”ã§150%ã®æˆé•·ã‚’ç¤ºã—ã¦ãŠã‚Šã€å…¨ç¤¾å£²ä¸Šã®ç´„8%ã‚’å ã‚ã‚‹ã¾ã§ã«ãªã‚Šã¾ã—ãŸã€‚ç‰¹ã«é‡‘èæ©Ÿé–¢å‘ã‘ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¥½èª¿ã§ã™ã€‚</p>
                        
                        <p><strong>[00:03:45] CFO:</strong> æ•°å€¤é¢ã§è£œè¶³ã„ãŸã—ã¾ã™ã€‚AIäº‹æ¥­ã®å–¶æ¥­åˆ©ç›Šç‡ã¯25%ã¨é«˜åç›Šã‚’ç¶­æŒã—ã¦ãŠã‚Šã€æŠ•è³‡å›åã‚‚é †èª¿ã«é€²ã‚“ã§ã„ã¾ã™ã€‚</p>
                        
                        <p class="text-gray-500 text-center">...æ®‹ã‚Šç´„14,000æ–‡å­—...</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- AIåˆ†æã‚¿ãƒ– -->
        <div id="tab-analysis" class="tab-content">
            <div class="space-y-4">
                <h3 class="font-semibold text-gray-800">ğŸ¤– AIåˆ†æçµæœ</h3>
                <div class="bg-blue-50 rounded-lg p-4 text-center">
                    <div class="animate-pulse">
                        <div class="w-12 h-12 bg-blue-300 rounded-full mx-auto mb-4"></div>
                        <p class="text-blue-800 font-medium">AIåˆ†æã‚’å®Ÿè¡Œä¸­...</p>
                        <p class="text-blue-600 text-sm">æ„Ÿæƒ…åˆ†æã€é‡è¦ãƒã‚¤ãƒ³ãƒˆæŠ½å‡ºã€æ‡¸å¿µäº‹é …ã®ç‰¹å®šã‚’è¡Œã£ã¦ã„ã¾ã™</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚¿ãƒ– -->
        <div id="tab-timeline" class="tab-content">
            <div class="space-y-4">
                <h3 class="font-semibold text-gray-800">â° å‡¦ç†ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</h3>
                <div class="space-y-3">
                    <div class="flex items-start gap-3">
                        <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                        <div class="flex-1">
                            <div class="flex items-center justify-between">
                                <span class="font-medium text-green-700">ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†</span>
                                <span class="text-sm text-gray-500">2æ™‚é–“å‰</span>
                            </div>
                            <p class="text-sm text-gray-600">éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ234MBï¼‰ã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãŒæ­£å¸¸ã«å®Œäº†</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start gap-3">
                        <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                        <div class="flex-1">
                            <div class="flex items-center justify-between">
                                <span class="font-medium text-green-700">æ–‡å­—èµ·ã“ã—å®Œäº†</span>
                                <span class="text-sm text-gray-500">1æ™‚é–“45åˆ†å‰</span>
                            </div>
                            <p class="text-sm text-gray-600">AIæ–‡å­—èµ·ã“ã—å®Œäº†ï¼ˆç²¾åº¦96%ã€15,680æ–‡å­—ï¼‰</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start gap-3">
                        <div class="w-2 h-2 bg-blue-500 rounded-full mt-2 animate-pulse"></div>
                        <div class="flex-1">
                            <div class="flex items-center justify-between">
                                <span class="font-medium text-blue-700">AIè¦ç´„å‡¦ç†ä¸­</span>
                                <span class="text-sm text-gray-500">ç¾åœ¨</span>
                            </div>
                            <p class="text-sm text-gray-600">é‡è¦ãƒã‚¤ãƒ³ãƒˆã®æŠ½å‡ºã¨è¦ç´„ã‚’ç”Ÿæˆä¸­ï¼ˆ65%å®Œäº†ï¼‰</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«é–‹é–‰ãƒœã‚¿ãƒ³ï¼ˆå›ºå®šä½ç½®ï¼‰ -->
    <div class="intelligence-toggle" onclick="toggleIntelligencePanel()" title="ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ã‚’é–‹é–‰">
        <div class="intelligence-toggle-icon">â€¹</div>
        <div class="intelligence-toggle-text">çŸ¥èƒ½åˆ†æ</div>
    </div>
    
    <!-- ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ï¼ˆå³ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼‰ -->
    <div class="intelligence-panel" id="intelligencePanel">
        
        <div class="intelligence-header">
            <h3 class="font-semibold text-gray-800">ğŸ§  ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹</h3>
            <button class="text-gray-400 hover:text-gray-600" onclick="toggleIntelligencePanel()" title="ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
        
        <div class="intelligence-content">
            <!-- çµ±è¨ˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆ -->
            <div class="stats-widget">
                <h4 class="font-semibold text-gray-800 mb-3">ğŸ“Š ä»Šæ—¥ã®çµ±è¨ˆ</h4>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value">8</div>
                        <div class="stat-label">å‡¦ç†å®Œäº†</div>
                        <div class="stat-trend positive">+3</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">12</div>
                        <div class="stat-label">å‡¦ç†ä¸­</div>
                        <div class="stat-trend positive">-2</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">96%</div>
                        <div class="stat-label">AIç²¾åº¦</div>
                        <div class="stat-trend positive">+1%</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">2.3h</div>
                        <div class="stat-label">å¹³å‡æ™‚é–“</div>
                        <div class="stat-trend positive">-0.5h</div>
                    </div>
                </div>
            </div>
            
            <!-- AIæ´å¯Ÿ -->
            <div class="ai-insights">
                <div class="insight-header">
                    <span class="text-xl">ğŸ¤–</span>
                    <span>AIæ´å¯Ÿ</span>
                </div>
                <ul class="insight-list">
                    <li class="insight-item">
                        <span class="insight-icon">ğŸ’¡</span>
                        <span>ä»Šæ—¥ã®å‡¦ç†åŠ¹ç‡ãŒ20%å‘ä¸Šã—ã¦ã„ã¾ã™</span>
                    </li>
                    <li class="insight-item">
                        <span class="insight-icon">âš ï¸</span>
                        <span>3ä»¶ã®è¨˜éŒ²ã§å‡¦ç†é…å»¶ãŒç™ºç”Ÿä¸­</span>
                    </li>
                    <li class="insight-item">
                        <span class="insight-icon">ğŸ“ˆ</span>
                        <span>ESGé–¢é€£ã®è³ªå•ãŒæ€¥å¢—ã—ã¦ã„ã¾ã™</span>
                    </li>
                </ul>
            </div>
            
            <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ‘ãƒãƒ« -->
            <div class="action-panel">
                <div class="action-header">
                    <div class="action-title">ğŸ¯ è¦å¯¾å¿œã‚¢ã‚¯ã‚·ãƒ§ãƒ³</div>
                    <div class="action-count">5</div>
                </div>
                <ul class="action-list">
                    <li class="action-item">
                        <div class="action-priority high"></div>
                        <div class="flex-1">
                            <div class="font-medium">BlackRockã¸ã®å›ç­”</div>
                            <div class="text-xs text-gray-500">æœŸé™: ä»Šæ—¥</div>
                        </div>
                    </li>
                    <li class="action-item">
                        <div class="action-priority medium"></div>
                        <div class="flex-1">
                            <div class="font-medium">FAQæ‰¿èª</div>
                            <div class="text-xs text-gray-500">æœŸé™: æ˜æ—¥</div>
                        </div>
                    </li>
                    <li class="action-item">
                        <div class="action-priority low"></div>
                        <div class="flex-1">
                            <div class="font-medium">ãƒ¬ãƒãƒ¼ãƒˆä½œæˆ</div>
                            <div class="text-xs text-gray-500">æœŸé™: æ¥é€±</div>
                        </div>
                    </li>
                </ul>
            </div>
            
            <!-- æœ€è¿‘ã®æ´»å‹• -->
            <div class="bg-gray-50 rounded-lg p-3">
                <h4 class="font-semibold text-gray-800 mb-2">ğŸ“ æœ€è¿‘ã®æ´»å‹•</h4>
                <div class="space-y-2 text-sm">
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                        <span>FAQ 3ä»¶ãŒå…¬é–‹ã•ã‚Œã¾ã—ãŸ</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-blue-500 rounded-full"></div>
                        <span>æ–°ã—ã„éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <div class="w-2 h-2 bg-yellow-500 rounded-full"></div>
                        <span>ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡ãŒ2ä»¶è¿½åŠ </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="exportModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold">ğŸ“¥ ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</h3>
                <button onclick="closeExportModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="space-y-6">
                <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">å‡ºåŠ›å½¢å¼</label>
                    <div class="grid grid-cols-3 gap-3">
                        <label class="export-format-option">
                            <input type="radio" name="exportFormat" value="excel" checked>
                            <div class="format-card">
                                <span class="text-2xl">ğŸ“Š</span>
                                <span class="font-medium">Excel</span>
                                <span class="text-xs text-gray-500">è©³ç´°åˆ†æç”¨</span>
                            </div>
                        </label>
                        <label class="export-format-option">
                            <input type="radio" name="exportFormat" value="pdf">
                            <div class="format-card">
                                <span class="text-2xl">ğŸ“„</span>
                                <span class="font-medium">PDF</span>
                                <span class="text-xs text-gray-500">å ±å‘Šæ›¸ç”¨</span>
                            </div>
                        </label>
                        <label class="export-format-option">
                            <input type="radio" name="exportFormat" value="csv">
                            <div class="format-card">
                                <span class="text-2xl">ğŸ“‹</span>
                                <span class="font-medium">CSV</span>
                                <span class="text-xs text-gray-500">ãƒ‡ãƒ¼ã‚¿åˆ†æç”¨</span>
                            </div>
                        </label>
                    </div>
                </div>
                
                <!-- ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå†…å®¹ -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å¯¾è±¡ãƒ‡ãƒ¼ã‚¿</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded" checked>
                                <span class="ml-2 text-sm">åŸºæœ¬æƒ…å ±ï¼ˆæ—¥æ™‚ã€æŠ•è³‡å®¶ã€ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼‰</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded" checked>
                                <span class="ml-2 text-sm">å‡¦ç†çµ±è¨ˆï¼ˆé€²æ—ã€AIç²¾åº¦ã€æ™‚é–“ï¼‰</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆ</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">AIåˆ†æçµæœ</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">FAQå†…å®¹</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æœŸé–“ãƒ•ã‚£ãƒ«ã‚¿</label>
                        <div class="space-y-2">
                            <div>
                                <label class="text-xs text-gray-600">é–‹å§‹æ—¥</label>
                                <input type="date" class="form-control-sm w-full">
                            </div>
                            <div>
                                <label class="text-xs text-gray-600">çµ‚äº†æ—¥</label>
                                <input type="date" class="form-control-sm w-full">
                            </div>
                            <div>
                                <label class="text-xs text-gray-600">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
                                <select class="form-control-sm w-full">
                                    <option>ã™ã¹ã¦</option>
                                    <option>å‡¦ç†ä¸­ã®ã¿</option>
                                    <option>å®Œäº†æ¸ˆã¿ã®ã¿</option>
                                    <option>ã‚¨ãƒ©ãƒ¼ã®ã¿</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ãƒ—ãƒªã‚»ãƒƒãƒˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ã‚¯ã‚¤ãƒƒã‚¯ãƒ—ãƒªã‚»ãƒƒãƒˆ</label>
                    <div class="flex gap-2">
                        <button class="btn-sm btn-secondary" onclick="applyExportPreset('executive')">
                            çµŒå–¶é™£å‘ã‘ã‚µãƒãƒªãƒ¼
                        </button>
                        <button class="btn-sm btn-secondary" onclick="applyExportPreset('detailed')">
                            è©³ç´°åˆ†æãƒ¬ãƒãƒ¼ãƒˆ
                        </button>
                        <button class="btn-sm btn-secondary" onclick="applyExportPreset('compliance')">
                            ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹å ±å‘Š
                        </button>
                    </div>
                </div>
                
                <div class="flex gap-3 pt-4 border-t">
                    <button class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700" onclick="executeExport()">
                        <span class="mr-2">ğŸ“¥</span>
                        ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå®Ÿè¡Œ
                    </button>
                    <button class="px-4 py-2 text-gray-600 hover:text-gray-800" onclick="closeExportModal()">
                        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="filterModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-4xl w-full p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold">ğŸ” è©³ç´°ãƒ•ã‚£ãƒ«ã‚¿</h3>
                <button onclick="closeFilterModal()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- åŸºæœ¬ãƒ•ã‚£ãƒ«ã‚¿ -->
                <div class="space-y-4">
                    <h4 class="font-semibold text-gray-800">ğŸ“‹ åŸºæœ¬æ¡ä»¶</h4>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">æœŸé–“</label>
                        <div class="space-y-2">
                            <input type="date" class="form-control-sm w-full" placeholder="é–‹å§‹æ—¥">
                            <input type="date" class="form-control-sm w-full" placeholder="çµ‚äº†æ—¥">
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">æŠ•è³‡å®¶ç¨®åˆ¥</label>
                        <div class="space-y-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded" checked>
                                <span class="ml-2 text-sm">æ©Ÿé–¢æŠ•è³‡å®¶</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded" checked>
                                <span class="ml-2 text-sm">æµ·å¤–æŠ•è³‡å®¶</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded" checked>
                                <span class="ml-2 text-sm">å€‹äººæŠ•è³‡å®¶</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded" checked>
                                <span class="ml-2 text-sm">ã‚¢ãƒŠãƒªã‚¹ãƒˆ</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ä¼šè­°ç¨®åˆ¥</label>
                        <select class="form-control-sm w-full" multiple size="4">
                            <option>æ±ºç®—èª¬æ˜ä¼š</option>
                            <option>å€‹åˆ¥é¢è«‡</option>
                            <option>ã‚¹ãƒ¢ãƒ¼ãƒ«ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°</option>
                            <option>ESGèª¬æ˜ä¼š</option>
                            <option>IR Day</option>
                        </select>
                    </div>
                </div>
                
                <!-- å‡¦ç†çŠ¶æ³ãƒ•ã‚£ãƒ«ã‚¿ -->
                <div class="space-y-4">
                    <h4 class="font-semibold text-gray-800">âš™ï¸ å‡¦ç†çŠ¶æ³</h4>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
                        <div class="space-y-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¾…ã¡</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">æ–‡å­—èµ·ã“ã—ä¸­</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded" checked>
                                <span class="ml-2 text-sm">AIåˆ†æä¸­</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">FAQä½œæˆä¸­</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">å…¬é–‹æ¸ˆã¿</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">å„ªå…ˆåº¦</label>
                        <div class="space-y-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded" checked>
                                <span class="ml-2 text-sm text-red-600">ğŸ”´ ç·Šæ€¥</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm text-yellow-600">ğŸŸ¡ ä¸­</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm text-green-600">ğŸŸ¢ ä½</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">æ‹…å½“è€…</label>
                        <select class="form-control-sm w-full">
                            <option>ã™ã¹ã¦</option>
                            <option>IRæ‹…å½“è€…A</option>
                            <option>IRæ‹…å½“è€…B</option>
                            <option>IRæ‹…å½“è€…C</option>
                            <option>IRéƒ¨é•·</option>
                        </select>
                    </div>
                </div>
                
                <!-- é«˜åº¦ãªãƒ•ã‚£ãƒ«ã‚¿ -->
                <div class="space-y-4">
                    <h4 class="font-semibold text-gray-800">ğŸ¤– AIåˆ†æ</h4>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">AIç²¾åº¦</label>
                        <div class="space-y-2">
                            <div class="flex items-center gap-2">
                                <span class="text-sm text-gray-600">æœ€å°:</span>
                                <input type="range" class="flex-1" min="0" max="100" value="80">
                                <span class="text-sm font-medium">80%</span>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="text-sm text-gray-600">æœ€å¤§:</span>
                                <input type="range" class="flex-1" min="0" max="100" value="100">
                                <span class="text-sm font-medium">100%</span>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">å‡¦ç†æ™‚é–“</label>
                        <select class="form-control-sm w-full">
                            <option>ã™ã¹ã¦</option>
                            <option>1æ™‚é–“ä»¥å†…</option>
                            <option>3æ™‚é–“ä»¥å†…</option>
                            <option>1æ—¥ä»¥å†…</option>
                            <option>1æ—¥è¶…é</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢</label>
                        <input type="text" class="form-control-sm w-full" placeholder="ã‚¿ã‚¤ãƒˆãƒ«ã€æŠ•è³‡å®¶åã€å†…å®¹ã§æ¤œç´¢">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">ã‚¿ã‚°</label>
                        <div class="space-y-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">ESG</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">DXæˆ¦ç•¥</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">M&A</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="rounded">
                                <span class="ml-2 text-sm">é…å½“æ”¿ç­–</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ—ãƒªã‚»ãƒƒãƒˆ -->
            <div class="mt-6 pt-4 border-t">
                <label class="block text-sm font-medium text-gray-700 mb-2">ã‚¯ã‚¤ãƒƒã‚¯ãƒ•ã‚£ãƒ«ã‚¿</label>
                <div class="flex flex-wrap gap-2">
                    <button class="btn-sm btn-secondary" onclick="applyFilterPreset('urgent')">
                        ğŸš¨ ç·Šæ€¥å¯¾å¿œå¿…è¦
                    </button>
                    <button class="btn-sm btn-secondary" onclick="applyFilterPreset('stalled')">
                        â¸ï¸ å‡¦ç†åœæ»ä¸­
                    </button>
                    <button class="btn-sm btn-secondary" onclick="applyFilterPreset('completed_today')">
                        âœ… æœ¬æ—¥å®Œäº†
                    </button>
                    <button class="btn-sm btn-secondary" onclick="applyFilterPreset('high_accuracy')">
                        ğŸ¯ é«˜ç²¾åº¦AIåˆ†æ
                    </button>
                    <button class="btn-sm btn-secondary" onclick="applyFilterPreset('overseas')">
                        ğŸŒ æµ·å¤–æŠ•è³‡å®¶
                    </button>
                </div>
            </div>
            
            <div class="flex gap-3 pt-4 border-t mt-4">
                <button class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700" onclick="applyFilters()">
                    <span class="mr-2">ğŸ”</span>
                    ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨
                </button>
                <button class="px-4 py-2 bg-gray-100 text-gray-700 rounded-md font-medium hover:bg-gray-200" onclick="resetFilters()">
                    ãƒªã‚»ãƒƒãƒˆ
                </button>
                <button class="px-4 py-2 text-gray-600 hover:text-gray-800" onclick="closeFilterModal()">
                    ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                </button>
            </div>
        </div>
    </div>
</div>

<!-- ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="quickActionModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg shadow-xl max-w-lg w-full p-6">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold">ä¸€æ‹¬å‡¦ç†</h3>
                <button onclick="closeQuickAction()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                    </svg>
                </button>
            </div>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">å‡¦ç†å¯¾è±¡</label>
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" class="rounded" checked>
                            <span class="ml-2 text-sm">å‡¦ç†åœæ»ä¸­ã®è¨˜éŒ²ï¼ˆ3ä»¶ï¼‰</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="rounded">
                            <span class="ml-2 text-sm">ãƒ¬ãƒ“ãƒ¥ãƒ¼å¾…ã¡ã®è¨˜éŒ²ï¼ˆ5ä»¶ï¼‰</span>
                        </label>
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">å®Ÿè¡Œã™ã‚‹å‡¦ç†</label>
                    <select class="w-full px-3 py-2 border border-gray-300 rounded-md text-sm">
                        <option>AIè¦ç´„ã®å†å®Ÿè¡Œ</option>
                        <option>FAQç”Ÿæˆã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦æ¬¡ã¸</option>
                        <option>å¼·åˆ¶çš„ã«ãƒ¬ãƒ“ãƒ¥ãƒ¼æ®µéšã¸ç§»è¡Œ</option>
                    </select>
                </div>
                
                <div class="flex gap-3 pt-4">
                    <button class="flex-1 px-4 py-2 bg-blue-600 text-white rounded-md font-medium hover:bg-blue-700" onclick="executeBulkProcess()">
                        ä¸€æ‹¬å‡¦ç†ã‚’å®Ÿè¡Œ
                    </button>
                    <button class="px-4 py-2 text-gray-600 hover:text-gray-800" onclick="closeQuickAction()">
                        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// ã‚°ãƒ­ãƒ¼ãƒãƒ«çŠ¶æ…‹ç®¡ç†
let selectedActivityId = 'activity-001';
let currentTab = 'overview';
let currentFilter = 'all';
let intelligencePanelCollapsed = false;

// ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£é¸æŠ
function selectActivity(activityId) {
    // å‰ã®é¸æŠã‚’è§£é™¤
    document.querySelectorAll('.activity-card').forEach(card => {
        card.classList.remove('selected');
    });
    
    // æ–°ã—ã„é¸æŠã‚’è¨­å®š
    event.target.closest('.activity-card').classList.add('selected');
    selectedActivityId = activityId;
    
    // ãƒ¡ã‚¤ãƒ³ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®å†…å®¹ã‚’æ›´æ–°
    updateWorkspaceContent(activityId);
}

// ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹å†…å®¹æ›´æ–°
function updateWorkspaceContent(activityId) {
    // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€activityIdã«åŸºã¥ã„ã¦APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    console.log('ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹æ›´æ–°:', activityId);
    
    // ãƒ‡ãƒ¢ç”¨: ç•°ãªã‚‹è¨˜éŒ²ã®å†…å®¹ã‚’è¡¨ç¤º
    const activityData = {
        'activity-002': {
            title: 'BlackRockå€‹åˆ¥é¢è«‡',
            investor: 'BlackRock Inc.',
            status: 'FAQç”Ÿæˆä¸­',
            progress: 75
        },
        'activity-003': {
            title: 'å€‹äººæŠ•è³‡å®¶èª¬æ˜ä¼š',
            investor: 'å€‹äººæŠ•è³‡å®¶',
            status: 'å…¬é–‹æ¸ˆã¿',
            progress: 100
        }
    };
    
    if (activityData[activityId]) {
        // UIã‚’å‹•çš„ã«æ›´æ–°
        console.log('è¨˜éŒ²è©³ç´°ã‚’æ›´æ–°:', activityData[activityId]);
    }
}

// ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨
function filterStream(filter) {
    // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
    document.querySelectorAll('.filter-chip').forEach(chip => {
        chip.classList.remove('active');
    });
    event.target.classList.add('active');
    
    currentFilter = filter;
    console.log('ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼é©ç”¨:', filter);
    
    // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã«åŸºã¥ã„ã¦ã‚¢ã‚¯ãƒ†ã‚£ãƒ“ãƒ†ã‚£ãƒªã‚¹ãƒˆã‚’æ›´æ–°
}

// ãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œæ©Ÿèƒ½
let selectedTableRows = new Set();

function selectTableRow(row) {
    row.classList.toggle('selected');
    const checkbox = row.querySelector('input[type="checkbox"]');
    checkbox.checked = !checkbox.checked;
    
    const activityId = row.dataset.activityId || 'activity-001';
    if (checkbox.checked) {
        selectedTableRows.add(activityId);
    } else {
        selectedTableRows.delete(activityId);
    }
    
    updateTableSelection();
}

function toggleAllTableRows(masterCheckbox) {
    const rows = document.querySelectorAll('.table-row');
    rows.forEach(row => {
        const checkbox = row.querySelector('input[type="checkbox"]');
        checkbox.checked = masterCheckbox.checked;
        
        if (masterCheckbox.checked) {
            row.classList.add('selected');
            selectedTableRows.add(row.dataset.activityId || 'activity-001');
        } else {
            row.classList.remove('selected');
            selectedTableRows.clear();
        }
    });
    
    updateTableSelection();
}

function updateTableSelection() {
    const count = selectedTableRows.size;
    document.getElementById('selectedCount').textContent = count;
    
    const bulkActionBar = document.getElementById('bulkActionBar');
    if (count > 0) {
        bulkActionBar.classList.remove('hidden');
    } else {
        bulkActionBar.classList.add('hidden');
    }
}

function clearTableSelection() {
    selectedTableRows.clear();
    document.querySelectorAll('.table-row').forEach(row => {
        row.classList.remove('selected');
        row.querySelector('input[type="checkbox"]').checked = false;
    });
    document.getElementById('selectAllTable').checked = false;
    updateTableSelection();
}

function executeBulkTableAction() {
    const action = document.getElementById('bulkActionSelect').value;
    if (!action) {
        alert('æ“ä½œã‚’é¸æŠã—ã¦ãã ã•ã„');
        return;
    }
    
    const count = selectedTableRows.size;
    console.log(`ä¸€æ‹¬æ“ä½œå®Ÿè¡Œ: ${action}, å¯¾è±¡: ${count}ä»¶`);
    
    switch (action) {
        case 'assign':
            showAssigneeChangeModal();
            break;
        case 'status':
            showStatusChangeModal();
            break;
        case 'priority':
            showPriorityChangeModal();
            break;
        case 'export':
            exportSelectedRecords();
            break;
        case 'delete':
            if (confirm(`é¸æŠã—ãŸ${count}ä»¶ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
                deleteSelectedRecords();
            }
            break;
    }
}

function sortTable(column) {
    console.log(`ãƒ†ãƒ¼ãƒ–ãƒ«ã‚½ãƒ¼ãƒˆ: ${column}`);
    // å®Ÿè£…: ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡Œã‚’ã‚½ãƒ¼ãƒˆ
    showNotification(`${column}ã§ã‚½ãƒ¼ãƒˆã—ã¾ã—ãŸ`);
}

function changeTablePageSize(size) {
    console.log(`ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚ºå¤‰æ›´: ${size}`);
    showNotification(`${size}ä»¶/ãƒšãƒ¼ã‚¸ã«å¤‰æ›´ã—ã¾ã—ãŸ`);
}

function previousTablePage() {
    console.log('å‰ã®ãƒšãƒ¼ã‚¸');
}

function nextTablePage() {
    console.log('æ¬¡ã®ãƒšãƒ¼ã‚¸');
}

function editRecord(activityId) {
    console.log(`è¨˜éŒ²ç·¨é›†: ${activityId}`);
    showNotification('ç·¨é›†ç”»é¢ã‚’é–‹ãã¾ã™');
}

function viewRecord(activityId) {
    console.log(`è¨˜éŒ²è©³ç´°: ${activityId}`);
    selectActivity(activityId);
}

// è©³ç´°ã‚¿ãƒ–æ©Ÿèƒ½
function switchDetailTab(tabName) {
    // ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
    document.querySelectorAll('.workspace-tab').forEach(tab => {
        tab.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // ã‚¿ãƒ–ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    
    const tabContent = document.getElementById(`tab-${tabName}`);
    if (tabContent) {
        tabContent.classList.add('active');
    }
    
    currentTab = tabName;
    console.log('è©³ç´°ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ:', tabName);
    
    // ã‚¿ãƒ–åˆ¥ã®è¿½åŠ å‡¦ç†
    switch (tabName) {
        case 'analysis':
            loadAIAnalysis();
            break;
        case 'transcript':
            loadTranscriptData();
            break;
        case 'timeline':
            loadTimelineData();
            break;
    }
}

function loadAIAnalysis() {
    // AIåˆ†æãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
    console.log('AIåˆ†æãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...');
}

function loadTranscriptData() {
    // æ–‡å­—èµ·ã“ã—ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
    console.log('æ–‡å­—èµ·ã“ã—ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...');
}

function loadTimelineData() {
    // ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿
    console.log('ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...');
}

// é€šçŸ¥è¡¨ç¤º
function showNotification(message, type = 'success') {
    const notification = document.createElement('div');
    
    const bgColor = {
        'success': 'bg-green-500',
        'info': 'bg-blue-500', 
        'warning': 'bg-yellow-500',
        'error': 'bg-red-500'
    }[type] || 'bg-green-500';
    
    notification.className = `fixed bottom-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg transform transition-all duration-500 translate-y-0 z-50`;
    notification.innerHTML = `
        <div class="flex items-center gap-2">
            <span>${message}</span>
            <button onclick="this.parentElement.parentElement.remove()" class="ml-2 text-white hover:text-gray-200">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                </svg>
            </button>
        </div>
    `;
    
    document.body.appendChild(notification);
    
    // è‡ªå‹•ã§æ¶ˆå»
    setTimeout(() => {
        if (notification.parentElement) {
            notification.style.transform = 'translateY(100px)';
            notification.style.opacity = '0';
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 500);
        }
    }, 5000);
}

// ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰åˆ‡ã‚Šæ›¿ãˆ
let currentViewMode = 'stream';

function setViewMode(mode) {
    console.log('ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´:', mode);
    
    // å‰ã®ãƒ“ãƒ¥ãƒ¼ã‚’éè¡¨ç¤º
    const currentView = document.getElementById(`view-${currentViewMode}`);
    if (currentView) {
        currentView.classList.add('hidden');
        currentView.classList.remove('active');
    }
    
    // æ–°ã—ã„ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º
    const newView = document.getElementById(`view-${mode}`);
    if (newView) {
        newView.classList.remove('hidden');
        newView.classList.add('active');
    }
    
    // ãƒœã‚¿ãƒ³ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
    document.querySelectorAll('.btn-toolbar').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');
    
    // è©³ç´°ã‚¿ãƒ–ã®è¡¨ç¤º/éè¡¨ç¤ºåˆ¶å¾¡
    const detailTabs = document.getElementById('detailTabs');
    if (mode === 'stream' && selectedActivityId) {
        detailTabs.style.display = 'flex';
    } else {
        detailTabs.style.display = 'none';
    }
    
    currentViewMode = mode;
    
    // ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ¼ãƒ‰å¤‰æ›´æ™‚ã®è¿½åŠ å‡¦ç†
    switch (mode) {
        case 'kanban':
            initializeKanbanView();
            break;
        case 'table':
            initializeTableView();
            break;
        case 'stream':
            updateStreamView();
            break;
    }
}

// ã‹ã‚“ã°ã‚“ãƒ“ãƒ¥ãƒ¼åˆæœŸåŒ–
function initializeKanbanView() {
    console.log('ã‹ã‚“ã°ã‚“ãƒ“ãƒ¥ãƒ¼ã‚’åˆæœŸåŒ–');
    // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½ã®åˆæœŸåŒ–ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯è¿½åŠ ï¼‰
    
    // ã‚«ãƒ¼ãƒ‰ã‚¯ãƒªãƒƒã‚¯æ™‚ã®è©³ç´°è¡¨ç¤º
    document.querySelectorAll('.kanban-card').forEach(card => {
        card.onclick = function() {
            const activityId = this.dataset.activityId || 'activity-001';
            selectActivity(activityId);
        };
    });
}

// ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ“ãƒ¥ãƒ¼åˆæœŸåŒ–
function initializeTableView() {
    console.log('ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ“ãƒ¥ãƒ¼ã‚’åˆæœŸåŒ–');
    updateTableSelection();
}

// ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ“ãƒ¥ãƒ¼æ›´æ–°
function updateStreamView() {
    console.log('ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°');
}

// ä¸€æ‹¬å‡¦ç†
function bulkProcess() {
    document.getElementById('quickActionModal').classList.remove('hidden');
}

function closeQuickAction() {
    document.getElementById('quickActionModal').classList.add('hidden');
}

function executeBulkProcess() {
    alert('ä¸€æ‹¬å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã—ãŸ');
    closeQuickAction();
    
    // UIã‚’æ›´æ–°ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯å‡¦ç†çŠ¶æ³ã‚’åæ˜ ï¼‰
    updateProcessingStatus();
}

// å‡¦ç†çŠ¶æ³æ›´æ–°
function updateProcessingStatus() {
    // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æœ€æ–°çŠ¶æ³ã‚’å–å¾—ã—ã¦UIã‚’æ›´æ–°
    console.log('å‡¦ç†çŠ¶æ³ã‚’æ›´æ–°');
}

// ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆæ©Ÿèƒ½
function exportData() {
    document.getElementById('exportModal').classList.remove('hidden');
}

function closeExportModal() {
    document.getElementById('exportModal').classList.add('hidden');
}

function applyExportPreset(type) {
    const formatInputs = document.querySelectorAll('input[name="exportFormat"]');
    const checkboxes = document.querySelectorAll('#exportModal input[type="checkbox"]');
    
    // ãƒ—ãƒªã‚»ãƒƒãƒˆã«å¿œã˜ã¦è¨­å®šã‚’å¤‰æ›´
    switch (type) {
        case 'executive':
            // çµŒå–¶é™£å‘ã‘: PDFã€åŸºæœ¬æƒ…å ±ã¨ã‚µãƒãƒªãƒ¼ã®ã¿
            formatInputs[1].checked = true; // PDF
            checkboxes[0].checked = true;   // åŸºæœ¬æƒ…å ±
            checkboxes[1].checked = true;   // å‡¦ç†çµ±è¨ˆ
            checkboxes[2].checked = false;  // æ–‡å­—èµ·ã“ã—
            checkboxes[3].checked = true;   // AIåˆ†æ
            checkboxes[4].checked = false;  // FAQ
            break;
        case 'detailed':
            // è©³ç´°åˆ†æ: Excelã€ã™ã¹ã¦ã®ãƒ‡ãƒ¼ã‚¿
            formatInputs[0].checked = true; // Excel
            checkboxes.forEach(cb => cb.checked = true);
            break;
        case 'compliance':
            // ã‚³ãƒ³ãƒ—ãƒ©ã‚¤ã‚¢ãƒ³ã‚¹: PDFã€åŸºæœ¬æƒ…å ±ã¨æ–‡å­—èµ·ã“ã—
            formatInputs[1].checked = true; // PDF
            checkboxes[0].checked = true;   // åŸºæœ¬æƒ…å ±
            checkboxes[1].checked = false;  // å‡¦ç†çµ±è¨ˆ
            checkboxes[2].checked = true;   // æ–‡å­—èµ·ã“ã—
            checkboxes[3].checked = false;  // AIåˆ†æ
            checkboxes[4].checked = true;   // FAQ
            break;
    }
}

function executeExport() {
    const format = document.querySelector('input[name="exportFormat"]:checked').value;
    const selectedData = [];
    
    document.querySelectorAll('#exportModal input[type="checkbox"]:checked').forEach(cb => {
        selectedData.push(cb.nextElementSibling.textContent);
    });
    
    console.log(`ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå®Ÿè¡Œ: ${format}å½¢å¼, ãƒ‡ãƒ¼ã‚¿: ${selectedData.join(', ')}`);
    
    // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ã‚µãƒ¼ãƒãƒ¼ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆè¦æ±‚ã‚’é€ä¿¡
    showNotification(`${format.toUpperCase()}å½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã‚’é–‹å§‹ã—ã¾ã—ãŸ`);
    closeExportModal();
    
    // ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆé€²æ—ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    setTimeout(() => {
        showNotification('ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãŒå®Œäº†ã—ã¾ã—ãŸã€‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã™ã€‚');
    }, 3000);
}

// ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½
function showFilters() {
    document.getElementById('filterModal').classList.remove('hidden');
}

function closeFilterModal() {
    document.getElementById('filterModal').classList.add('hidden');
}

function applyFilterPreset(type) {
    const checkboxes = document.querySelectorAll('#filterModal input[type="checkbox"]');
    
    // ã¾ãšã™ã¹ã¦ã‚’ãƒªã‚»ãƒƒãƒˆ
    checkboxes.forEach(cb => cb.checked = false);
    
    switch (type) {
        case 'urgent':
            // ç·Šæ€¥å¯¾å¿œå¿…è¦: ç·Šæ€¥å„ªå…ˆåº¦ã®ã¿
            document.querySelector('#filterModal input[type="checkbox"][checked]').checked = true; // AIåˆ†æä¸­
            document.querySelectorAll('#filterModal input[type="checkbox"]')[10].checked = true; // ç·Šæ€¥å„ªå…ˆåº¦
            break;
        case 'stalled':
            // å‡¦ç†åœæ»ä¸­: AIåˆ†æä¸­ã§é•·æ™‚é–“çµŒé
            document.querySelectorAll('#filterModal input[type="checkbox"]')[6].checked = true; // AIåˆ†æä¸­
            break;
        case 'completed_today':
            // æœ¬æ—¥å®Œäº†: å…¬é–‹æ¸ˆã¿ + æœ¬æ—¥ã®æ—¥ä»˜
            document.querySelectorAll('#filterModal input[type="checkbox"]')[9].checked = true; // å…¬é–‹æ¸ˆã¿
            break;
        case 'high_accuracy':
            // é«˜ç²¾åº¦AIåˆ†æ: AIç²¾åº¦90%ä»¥ä¸Š
            document.querySelector('#filterModal input[type="range"]').value = 90;
            break;
        case 'overseas':
            // æµ·å¤–æŠ•è³‡å®¶ã®ã¿
            document.querySelectorAll('#filterModal input[type="checkbox"]')[1].checked = true; // æµ·å¤–æŠ•è³‡å®¶
            break;
    }
}

function applyFilters() {
    const filters = collectFilterSettings();
    console.log('ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨:', filters);
    
    // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€ãƒ•ã‚£ãƒ«ã‚¿ã«åŸºã¥ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°
    showNotification('ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨ã—ã¾ã—ãŸ');
    closeFilterModal();
    
    // ç¾åœ¨ã®ãƒ“ãƒ¥ãƒ¼ã‚’æ›´æ–°
    switch (currentViewMode) {
        case 'table':
            updateTableWithFilters(filters);
            break;
        case 'kanban':
            updateKanbanWithFilters(filters);
            break;
        case 'stream':
            updateStreamWithFilters(filters);
            break;
    }
}

function resetFilters() {
    // ã™ã¹ã¦ã®ãƒ•ã‚£ãƒ«ã‚¿è¨­å®šã‚’ãƒªã‚»ãƒƒãƒˆ
    document.querySelectorAll('#filterModal input[type="checkbox"]').forEach(cb => {
        cb.checked = cb.hasAttribute('checked');
    });
    document.querySelectorAll('#filterModal input[type="date"]').forEach(input => {
        input.value = '';
    });
    document.querySelectorAll('#filterModal select').forEach(select => {
        select.selectedIndex = 0;
    });
    document.querySelectorAll('#filterModal input[type="range"]').forEach(range => {
        range.value = range.getAttribute('value') || range.min;
    });
    document.querySelector('#filterModal input[type="text"]').value = '';
}

function collectFilterSettings() {
    return {
        dateRange: {
            start: document.querySelectorAll('#filterModal input[type="date"]')[0].value,
            end: document.querySelectorAll('#filterModal input[type="date"]')[1].value
        },
        investorTypes: Array.from(document.querySelectorAll('#filterModal input[type="checkbox"]:checked'))
            .map(cb => cb.nextElementSibling.textContent.trim()),
        keyword: document.querySelector('#filterModal input[type="text"]').value,
        accuracyRange: {
            min: document.querySelectorAll('#filterModal input[type="range"]')[0].value,
            max: document.querySelectorAll('#filterModal input[type="range"]')[1].value
        }
    };
}

function updateTableWithFilters(filters) {
    console.log('ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ“ãƒ¥ãƒ¼ã«ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨:', filters);
    // å®Ÿè£…: ãƒ†ãƒ¼ãƒ–ãƒ«ã®è¡Œã‚’æ¡ä»¶ã«åŸºã¥ã„ã¦è¡¨ç¤º/éè¡¨ç¤º
}

function updateKanbanWithFilters(filters) {
    console.log('ã‹ã‚“ã°ã‚“ãƒ“ãƒ¥ãƒ¼ã«ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨:', filters);
    // å®Ÿè£…: ã‹ã‚“ã°ã‚“ã‚«ãƒ¼ãƒ‰ã‚’æ¡ä»¶ã«åŸºã¥ã„ã¦è¡¨ç¤º/éè¡¨ç¤º
}

function updateStreamWithFilters(filters) {
    console.log('ã‚¹ãƒˆãƒªãƒ¼ãƒ ãƒ“ãƒ¥ãƒ¼ã«ãƒ•ã‚£ãƒ«ã‚¿ã‚’é©ç”¨:', filters);
    // å®Ÿè£…: ã‚¹ãƒˆãƒªãƒ¼ãƒ ã‚¢ã‚¤ãƒ†ãƒ ã‚’æ¡ä»¶ã«åŸºã¥ã„ã¦è¡¨ç¤º/éè¡¨ç¤º
}

// ä¸€æ‹¬å‡¦ç†ã§ä½¿ç”¨ã•ã‚Œã‚‹è£œåŠ©é–¢æ•°
function showAssigneeChangeModal() {
    showNotification('æ‹…å½“è€…å¤‰æ›´ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãã¾ã™', 'info');
}

function showStatusChangeModal() {
    showNotification('ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å¤‰æ›´ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãã¾ã™', 'info');
}

function showPriorityChangeModal() {
    showNotification('å„ªå…ˆåº¦å¤‰æ›´ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãã¾ã™', 'info');
}

function exportSelectedRecords() {
    const count = selectedTableRows.size;
    showNotification(`é¸æŠã—ãŸ${count}ä»¶ã®è¨˜éŒ²ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã™`, 'success');
}

function deleteSelectedRecords() {
    const count = selectedTableRows.size;
    selectedTableRows.clear();
    updateTableSelection();
    showNotification(`${count}ä»¶ã®è¨˜éŒ²ã‚’å‰Šé™¤ã—ã¾ã—ãŸ`, 'warning');
}

function selectAllRecords() {
    const allCheckboxes = document.querySelectorAll('.table-row input[type="checkbox"]');
    const masterCheckbox = document.getElementById('selectAllTable');
    toggleAllTableRows(masterCheckbox);
}

// å¼·åˆ¶æ¬¡ã‚¹ãƒ†ãƒ¼ã‚¸
function forceNextStage() {
    if (confirm('AIè¦ç´„ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦æ¬¡ã®æ®µéšã«é€²ã¿ã¾ã™ã‹ï¼Ÿ')) {
        alert('FAQç”Ÿæˆæ®µéšã«ç§»è¡Œã—ã¾ã—ãŸ');
        updateProcessingStatus();
    }
}

// å‡¦ç†ä¸­æ–­
function cancelProcessing() {
    if (confirm('å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã™ã‹ï¼Ÿ')) {
        alert('å‡¦ç†ã‚’ä¸­æ–­ã—ã¾ã—ãŸ');
        updateProcessingStatus();
    }
}

// ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
function startRealtimeUpdates() {
    // å®Ÿéš›ã®å®Ÿè£…ã§ã¯ã€WebSocketã‚„SSEã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
    setInterval(() => {
        updateProcessingStatus();
    }, 30000); // 30ç§’ã”ã¨ã«æ›´æ–°
}

// ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«é–‹é–‰æ©Ÿèƒ½
function toggleIntelligencePanel() {
    const dialogueCenter = document.querySelector('.dialogue-center');
    const intelligencePanel = document.getElementById('intelligencePanel');
    const toggleButton = document.querySelector('.intelligence-toggle');
    
    if (!dialogueCenter || !intelligencePanel || !toggleButton) {
        console.error('å¿…è¦ãªè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
        return;
    }
    
    intelligencePanelCollapsed = !intelligencePanelCollapsed;
    
    if (intelligencePanelCollapsed) {
        dialogueCenter.classList.add('intelligence-collapsed');
        intelligencePanel.classList.add('collapsed');
        toggleButton.title = 'ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ã‚’é–‹ã';
        
        // æˆåŠŸé€šçŸ¥
        showNotification('ğŸ” çŸ¥èƒ½åˆ†æãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã¾ã—ãŸ', 'info');
    } else {
        dialogueCenter.classList.remove('intelligence-collapsed');
        intelligencePanel.classList.remove('collapsed');
        toggleButton.title = 'ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹';
        
        // æˆåŠŸé€šçŸ¥
        showNotification('ğŸ§  çŸ¥èƒ½åˆ†æãƒ‘ãƒãƒ«ã‚’é–‹ãã¾ã—ãŸ', 'success');
    }
    
    // çŠ¶æ…‹ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¿å­˜
    localStorage.setItem('intelligencePanelCollapsed', intelligencePanelCollapsed);
    
    console.log('ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«:', intelligencePanelCollapsed ? 'é–‰ã˜ã‚‹' : 'é–‹ã');
}

// é€šçŸ¥è¡¨ç¤ºæ©Ÿèƒ½
function showNotification(message, type = 'info') {
    const notification = document.createElement('div');
    notification.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg transform transition-all duration-500 translate-x-0 z-50`;
    
    // ã‚¿ã‚¤ãƒ—ã«å¿œã˜ãŸè‰²ã‚’è¨­å®š
    if (type === 'success') {
        notification.className += ' bg-green-500 text-white';
    } else if (type === 'info') {
        notification.className += ' bg-blue-500 text-white';
    } else if (type === 'warning') {
        notification.className += ' bg-yellow-500 text-white';
    } else if (type === 'error') {
        notification.className += ' bg-red-500 text-white';
    }
    
    notification.textContent = message;
    document.body.appendChild(notification);
    
    // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    setTimeout(() => {
        notification.style.transform = 'translateX(0px)';
        notification.style.opacity = '1';
    }, 100);
    
    // 3ç§’å¾Œã«éè¡¨ç¤º
    setTimeout(() => {
        notification.style.transform = 'translateX(400px)';
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 500);
    }, 3000);
}

// ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒ˜ãƒ«ãƒ—ã®è¡¨ç¤º
function showKeyboardHelp() {
    const helpModal = document.createElement('div');
    helpModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
    helpModal.innerHTML = `
        <div class="bg-white rounded-lg p-6 max-w-md mx-4 shadow-xl">
            <div class="flex items-center justify-between mb-4">
                <h3 class="text-lg font-semibold text-gray-800">âŒ¨ï¸ ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ</h3>
                <button onclick="this.closest('.fixed').remove()" class="text-gray-400 hover:text-gray-600">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div class="space-y-3 text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-600">ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«é–‹é–‰</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">Ctrl+I</kbd>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ä¸€æ‹¬å‡¦ç†</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">B</kbd>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ã“ã®ãƒ˜ãƒ«ãƒ—</span>
                    <kbd class="px-2 py-1 bg-gray-100 rounded">H</kbd>
                </div>
            </div>
        </div>
    `;
    document.body.appendChild(helpModal);
    
    // ã‚¯ãƒªãƒƒã‚¯ã§é–‰ã˜ã‚‹
    helpModal.addEventListener('click', function(e) {
        if (e.target === helpModal) {
            helpModal.remove();
        }
    });
}

function initializeIntelligencePanel() {
    console.log('ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«åˆæœŸåŒ–é–‹å§‹');
    
    // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å‰å›ã®çŠ¶æ…‹ã‚’å¾©å…ƒ
    const saved = localStorage.getItem('intelligencePanelCollapsed');
    console.log('ä¿å­˜ã•ã‚ŒãŸçŠ¶æ…‹:', saved);
    
    const dialogueCenter = document.querySelector('.dialogue-center');
    const intelligencePanel = document.getElementById('intelligencePanel');
    const toggleButton = document.querySelector('.intelligence-toggle');
    
    if (!dialogueCenter || !intelligencePanel || !toggleButton) {
        console.error('åˆæœŸåŒ–: å¿…è¦ãªè¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“', {
            dialogueCenter: !!dialogueCenter,
            intelligencePanel: !!intelligencePanel,
            toggleButton: !!toggleButton
        });
        return;
    }
    
    if (saved !== null) {
        intelligencePanelCollapsed = JSON.parse(saved);
        console.log('å¾©å…ƒã•ã‚ŒãŸçŠ¶æ…‹:', intelligencePanelCollapsed);
        
        if (intelligencePanelCollapsed) {
            console.log('åˆæœŸåŒ–: ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ãŸçŠ¶æ…‹ã§å¾©å…ƒ');
            dialogueCenter.classList.add('intelligence-collapsed');
            intelligencePanel.classList.add('collapsed');
            toggleButton.title = 'ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ã‚’é–‹ã';
        } else {
            toggleButton.title = 'ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹';
        }
    } else {
        console.log('ä¿å­˜ã•ã‚ŒãŸçŠ¶æ…‹ãªã—ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆçŠ¶æ…‹ã‚’ä½¿ç”¨');
        toggleButton.title = 'ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ã‚’é–‰ã˜ã‚‹';
    }
    
    // åˆæœŸåŒ–å®Œäº†ã®é€šçŸ¥
    setTimeout(() => {
        showNotification('ğŸ’¬ å¯¾è©±è¨˜éŒ²ã‚»ãƒ³ã‚¿ãƒ¼ãŒèª­ã¿è¾¼ã¾ã‚Œã¾ã—ãŸ', 'success');
    }, 500);
}

// åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', function() {
    console.log('ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿å®Œäº†ã€åˆæœŸåŒ–é–‹å§‹');
    
    // ãƒ‡ãƒãƒƒã‚°ç”¨: ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’ã‚¯ãƒªã‚¢ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
    localStorage.removeItem('intelligencePanelCollapsed');
    
    // ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ã‚¹ãƒ‘ãƒãƒ«ã®çŠ¶æ…‹ã‚’åˆæœŸåŒ–
    initializeIntelligencePanel();
    
    // åˆæœŸé¸æŠçŠ¶æ…‹ã‚’è¨­å®š
    selectActivity('activity-001');
    
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã‚’é–‹å§‹
    startRealtimeUpdates();
    
    // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey || e.metaKey) {
            switch(e.key) {
                case 'f':
                    e.preventDefault();
                    showFilters();
                    break;
                case 'e':
                    e.preventDefault();
                    exportData();
                    break;
                case 'b':
                    e.preventDefault();
                    bulkProcess();
                    break;
                case 'i':
                    e.preventDefault();
                    toggleIntelligencePanel();
                    break;
            }
        }
    });
});

// è‡ªå‹•æ›´æ–°ã«ã‚ˆã‚‹ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹æ›´æ–°ï¼ˆãƒ‡ãƒ¢ç”¨ï¼‰
setTimeout(() => {
    document.querySelector('.stage-circle.processing').classList.remove('processing');
    document.querySelector('.stage-circle.processing').classList.add('completed');
    document.querySelector('.stage-circle.processing').innerHTML = 'âœ“';
}, 5000);
</script>
{% endblock %} 