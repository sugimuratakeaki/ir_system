{% extends "base.html" %}

{% block title %}AIæˆ¦ç•¥åˆ†æãƒ»ç·¨é›†{% endblock %}
{% block page_icon %}ğŸ¤–{% endblock %}
{% block page_title %}AIæˆ¦ç•¥åˆ†æãƒ»ç·¨é›†{% endblock %}
{% block breadcrumb_current %}AIæˆ¦ç•¥åˆ†æãƒ»ç·¨é›†{% endblock %}

{% block extra_css %}
<style>
    /* AIåˆ†æãƒ•ãƒ­ãƒ¼å…¨ä½“ã®ã‚³ãƒ³ãƒ†ãƒŠ */
    .ai-analysis-workflow {
        background: linear-gradient(135deg, #f9fafb 0%, #e5e7eb 100%);
        border-radius: 16px;
        padding: 32px;
        margin-bottom: 32px;
        position: relative;
        overflow: hidden;
    }
    
    .ai-analysis-workflow::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -10%;
        width: 500px;
        height: 500px;
        background: radial-gradient(circle, rgba(20, 184, 166, 0.1) 0%, transparent 70%);
        border-radius: 50%;
    }
    
    /* ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ */
    .workflow-steps {
        display: flex;
        justify-content: space-between;
        margin-bottom: 32px;
        position: relative;
        z-index: 1;
    }
    
    .workflow-step {
        flex: 1;
        text-align: center;
        position: relative;
    }
    
    .workflow-step::after {
        content: '';
        position: absolute;
        top: 20px;
        left: 50%;
        width: calc(100% - 40px);
        height: 2px;
        background: var(--gray-300);
        z-index: -1;
    }
    
    .workflow-step:last-child::after {
        display: none;
    }
    
    .step-circle {
        width: 40px;
        height: 40px;
        background: white;
        border: 2px solid var(--gray-300);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 8px;
        position: relative;
        transition: all 0.3s ease;
    }
    
    .step-circle.active {
        background: var(--accent-teal);
        border-color: var(--accent-teal);
        color: white;
        transform: scale(1.1);
        box-shadow: 0 0 0 8px rgba(20, 184, 166, 0.1);
    }
    
    .step-circle.completed {
        background: var(--success);
        border-color: var(--success);
        color: white;
    }
    
    .step-label {
        font-size: var(--text-sm);
        color: var(--gray-600);
        font-weight: var(--font-medium);
    }
    
    .step-label.active {
        color: var(--accent-teal);
        font-weight: var(--font-semibold);
    }
    
    /* ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹é¸æŠ */
    .data-source-selector {
        background: white;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .source-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 16px;
        margin-top: 16px;
    }
    
    .source-item {
        border: 2px solid var(--gray-200);
        border-radius: 8px;
        padding: 16px;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        overflow: hidden;
    }
    
    .source-item:hover {
        border-color: var(--accent-teal);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }
    
    .source-item.selected {
        border-color: var(--accent-teal);
        background: linear-gradient(135deg, #f0fdfa 0%, #e6fffa 100%);
    }
    
    .source-item.selected::after {
        content: 'âœ“';
        position: absolute;
        top: 12px;
        right: 12px;
        width: 24px;
        height: 24px;
        background: var(--accent-teal);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: bold;
    }
    
    .source-type {
        display: inline-block;
        padding: 4px 8px;
        background: var(--gray-100);
        border-radius: 4px;
        font-size: var(--text-xs);
        font-weight: var(--font-medium);
        text-transform: uppercase;
        margin-bottom: 8px;
    }
    
    .source-type.kessan {
        background: #dbeafe;
        color: #1e40af;
    }
    
    .source-type.tekiji {
        background: #fef3c7;
        color: #92400e;
    }
    
    .source-title {
        font-weight: var(--font-semibold);
        color: var(--gray-900);
        margin-bottom: 4px;
    }
    
    .source-meta {
        font-size: var(--text-sm);
        color: var(--gray-600);
    }
    
    /* AIåˆ†æãƒ—ãƒ­ã‚»ã‚¹ */
    .analysis-process {
        background: white;
        border-radius: 12px;
        padding: 32px;
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .process-header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .ai-avatar {
        width: 48px;
        height: 48px;
        background: linear-gradient(135deg, var(--accent-teal) 0%, var(--info) 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.05); opacity: 0.9; }
    }
    
    .process-title {
        font-size: var(--text-xl);
        font-weight: var(--font-bold);
        color: var(--gray-900);
    }
    
    .process-status {
        margin-left: auto;
        padding: 6px 16px;
        background: var(--info-light);
        color: white;
        border-radius: 20px;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
    }
    
    /* åˆ†æã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ */
    .analysis-tasks {
        space-y: 12px;
    }
    
    .task-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px;
        background: var(--gray-50);
        border-radius: 8px;
        transition: all 0.3s ease;
    }
    
    .task-item.processing {
        background: linear-gradient(135deg, #dbeafe 0%, #e0f2fe 100%);
        transform: translateX(8px);
    }
    
    .task-item.completed {
        background: linear-gradient(135deg, #d1fae5 0%, #ecfccb 100%);
    }
    
    .task-icon {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: white;
        box-shadow: var(--shadow-sm);
    }
    
    .task-icon.pending {
        color: var(--gray-400);
    }
    
    .task-icon.processing {
        color: var(--info);
        animation: spin 1s linear infinite;
    }
    
    .task-icon.completed {
        color: var(--success);
    }
    
    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }
    
    .task-content {
        flex: 1;
    }
    
    .task-name {
        font-weight: var(--font-medium);
        color: var(--gray-900);
        margin-bottom: 2px;
    }
    
    .task-description {
        font-size: var(--text-sm);
        color: var(--gray-600);
    }
    
    .task-progress {
        width: 120px;
        height: 6px;
        background: var(--gray-200);
        border-radius: 3px;
        overflow: hidden;
    }
    
    .task-progress-bar {
        height: 100%;
        background: var(--accent-teal);
        transition: width 0.3s ease;
    }
    
    /* æ¯”è¼ƒãƒ“ãƒ¥ãƒ¼ */
    .comparison-view {
        background: white;
        border-radius: 12px;
        padding: 32px;
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .comparison-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 24px;
    }
    
    .comparison-toggle {
        display: flex;
        background: var(--gray-100);
        border-radius: 8px;
        padding: 4px;
    }
    
    .toggle-option {
        padding: 8px 16px;
        border-radius: 6px;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        color: var(--gray-600);
        background: transparent;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .toggle-option.active {
        background: white;
        color: var(--gray-900);
        box-shadow: var(--shadow-sm);
    }
    
    /* å·®åˆ†è¡¨ç¤º */
    .diff-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
    }
    
    .diff-column {
        border: 1px solid var(--gray-200);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .diff-header {
        padding: 16px;
        background: var(--gray-50);
        border-bottom: 1px solid var(--gray-200);
        font-weight: var(--font-semibold);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .diff-header.previous {
        background: #fef3c7;
        color: #92400e;
    }
    
    .diff-header.current {
        background: #dbeafe;
        color: #1e40af;
    }
    
    .diff-content {
        padding: 24px;
    }
    
    .diff-section {
        margin-bottom: 24px;
    }
    
    .diff-section-title {
        font-weight: var(--font-semibold);
        color: var(--gray-900);
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .diff-item {
        padding: 12px;
        background: var(--gray-50);
        border-radius: 6px;
        margin-bottom: 8px;
        position: relative;
    }
    
    .diff-item.changed {
        background: #fef3c7;
        border-left: 4px solid #f59e0b;
    }
    
    .diff-item.added {
        background: #d1fae5;
        border-left: 4px solid #10b981;
    }
    
    .diff-item.removed {
        background: #fee2e2;
        border-left: 4px solid #ef4444;
        opacity: 0.7;
        text-decoration: line-through;
    }
    
    .diff-value {
        font-size: var(--text-xl);
        font-weight: var(--font-bold);
        color: var(--kagami-blue);
        margin-bottom: 4px;
    }
    
    .diff-label {
        font-size: var(--text-sm);
        color: var(--gray-600);
    }
    
    .diff-reason {
        margin-top: 8px;
        padding: 8px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 4px;
        font-size: var(--text-sm);
        color: var(--gray-700);
        display: flex;
        align-items: start;
        gap: 8px;
    }
    
    .diff-reason-icon {
        color: var(--accent-teal);
        flex-shrink: 0;
        margin-top: 2px;
    }
    
    /* AIã‚¤ãƒ³ã‚µã‚¤ãƒˆ */
    .ai-insights {
        background: linear-gradient(135deg, #f0fdfa 0%, #e6fffa 100%);
        border: 1px solid var(--accent-teal);
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        position: relative;
        overflow: hidden;
    }
    
    .ai-insights::before {
        content: 'ğŸ’¡';
        position: absolute;
        top: -20px;
        right: -20px;
        font-size: 80px;
        opacity: 0.1;
    }
    
    .insights-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
    }
    
    .insights-title {
        font-size: var(--text-lg);
        font-weight: var(--font-bold);
        color: var(--accent-teal-dark);
    }
    
    .insight-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 16px;
    }
    
    .insight-card {
        background: white;
        border-radius: 8px;
        padding: 16px;
        box-shadow: var(--shadow-sm);
        transition: all 0.2s ease;
        cursor: pointer;
    }
    
    .insight-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }
    
    .insight-type {
        display: inline-block;
        padding: 4px 8px;
        background: var(--accent-teal);
        color: white;
        border-radius: 4px;
        font-size: var(--text-xs);
        font-weight: var(--font-medium);
        margin-bottom: 8px;
    }
    
    .insight-content {
        font-size: var(--text-sm);
        color: var(--gray-700);
        line-height: var(--leading-relaxed);
    }
    
    .insight-action {
        margin-top: 12px;
        display: flex;
        align-items: center;
        gap: 4px;
        color: var(--accent-teal);
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
    }
    
    /* ç·¨é›†ã‚¨ãƒªã‚¢ */
    .edit-section {
        background: white;
        border-radius: 12px;
        padding: 32px;
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .edit-tabs {
        display: flex;
        gap: 4px;
        background: var(--gray-100);
        padding: 4px;
        border-radius: 8px;
        margin-bottom: 24px;
    }
    
    .edit-tab {
        flex: 1;
        padding: 10px;
        border-radius: 6px;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        color: var(--gray-600);
        background: transparent;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }
    
    .edit-tab.active {
        background: white;
        color: var(--gray-900);
        box-shadow: var(--shadow-sm);
    }
    
    .edit-form {
        display: grid;
        gap: 24px;
    }
    
    .form-group {
        display: grid;
        gap: 8px;
    }
    
    .form-label {
        font-weight: var(--font-medium);
        color: var(--gray-700);
        font-size: var(--text-sm);
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .form-label .required {
        color: var(--error);
    }
    
    .form-input {
        width: 100%;
        padding: 10px 14px;
        border: 1px solid var(--gray-300);
        border-radius: 6px;
        font-size: var(--text-sm);
        transition: all 0.2s ease;
        background: white;
    }
    
    .form-input:focus {
        outline: none;
        border-color: var(--accent-teal);
        box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
    }
    
    .form-input.ai-suggested {
        border-color: var(--accent-teal);
        background: linear-gradient(to right, white 0%, #f0fdfa 100%);
    }
    
    .form-textarea {
        width: 100%;
        padding: 10px 14px;
        border: 1px solid var(--gray-300);
        border-radius: 6px;
        font-size: var(--text-sm);
        transition: all 0.2s ease;
        resize: vertical;
        min-height: 100px;
    }
    
    .form-textarea:focus {
        outline: none;
        border-color: var(--accent-teal);
        box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
    }
    
    .ai-suggestion-box {
        background: var(--gray-50);
        border: 1px solid var(--gray-200);
        border-radius: 6px;
        padding: 12px;
        margin-top: 8px;
        font-size: var(--text-sm);
        color: var(--gray-700);
        display: flex;
        align-items: start;
        gap: 8px;
    }
    
    .suggestion-icon {
        color: var(--accent-teal);
        flex-shrink: 0;
        margin-top: 2px;
    }
    
    .suggestion-text {
        flex: 1;
    }
    
    .suggestion-actions {
        display: flex;
        gap: 8px;
        margin-top: 8px;
    }
    
    .suggestion-btn {
        padding: 4px 12px;
        border-radius: 4px;
        font-size: var(--text-xs);
        font-weight: var(--font-medium);
        border: 1px solid var(--gray-300);
        background: white;
        color: var(--gray-700);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .suggestion-btn:hover {
        background: var(--gray-50);
        border-color: var(--gray-400);
    }
    
    .suggestion-btn.primary {
        background: var(--accent-teal);
        border-color: var(--accent-teal);
        color: white;
    }
    
    .suggestion-btn.primary:hover {
        background: var(--accent-teal-dark);
        border-color: var(--accent-teal-dark);
    }
    
    /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒ¼ */
    .action-bar {
        position: sticky;
        bottom: 0;
        background: white;
        border-top: 1px solid var(--gray-200);
        padding: 16px 32px;
        margin: 0 -32px -32px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        z-index: 10;
        box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.05);
    }
    
    .action-info {
        font-size: var(--text-sm);
        color: var(--gray-600);
    }
    
    .action-buttons {
        display: flex;
        gap: 12px;
    }
    
    .btn {
        padding: 10px 20px;
        border-radius: 6px;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        border: none;
    }
    
    .btn-secondary {
        background: white;
        border: 1px solid var(--gray-300);
        color: var(--gray-700);
    }
    
    .btn-secondary:hover {
        background: var(--gray-50);
        border-color: var(--gray-400);
    }
    
    .btn-primary {
        background: var(--kagami-blue);
        color: white;
    }
    
    .btn-primary:hover {
        background: var(--kagami-blue-dark);
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }
    
    .btn-success {
        background: var(--accent-teal);
        color: white;
    }
    
    .btn-success:hover {
        background: var(--accent-teal-dark);
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }
    
    /* ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–èª¿æ•´ */
    @media (max-width: 1024px) {
        .diff-container {
            grid-template-columns: 1fr;
        }
        
        .insight-cards {
            grid-template-columns: 1fr;
        }
    }
    
    /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .animate-in {
        animation: slideIn 0.5s ease-out forwards;
    }
</style>
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- ãƒšãƒ¼ã‚¸ãƒ˜ãƒƒãƒ€ãƒ¼ -->
    <div class="mb-8">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">AIæˆ¦ç•¥åˆ†æãƒ»ç·¨é›†</h1>
                <p class="text-gray-600">æ±ºç®—çŸ­ä¿¡ãƒ»é©æ™‚é–‹ç¤ºã‹ã‚‰æˆ¦ç•¥ã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆã‚’è‡ªå‹•æŠ½å‡º</p>
            </div>
            <a href="/strategy-planning" class="btn btn-secondary">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                æˆ¦ç•¥ç®¡ç†ç”»é¢ã¸æˆ»ã‚‹
            </a>
        </div>
    </div>
    
    <!-- AIåˆ†æãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ -->
    <div class="ai-analysis-workflow">
        <div class="workflow-steps">
            <div class="workflow-step">
                <div class="step-circle active" id="step1">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                </div>
                <div class="step-label active">ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹é¸æŠ</div>
            </div>
            <div class="workflow-step">
                <div class="step-circle" id="step2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                    </svg>
                </div>
                <div class="step-label">AIåˆ†æå®Ÿè¡Œ</div>
            </div>
            <div class="workflow-step">
                <div class="step-circle" id="step3">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                </div>
                <div class="step-label">å·®åˆ†ç¢ºèª</div>
            </div>
            <div class="workflow-step">
                <div class="step-circle" id="step4">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                </div>
                <div class="step-label">ç·¨é›†ãƒ»æ‰¿èª</div>
            </div>
        </div>
    </div>
    
    <!-- ã‚¹ãƒ†ãƒƒãƒ—1: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹é¸æŠ -->
    <div id="step1-content" class="data-source-selector">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">åˆ†æã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’é¸æŠ</h2>
        <p class="text-sm text-gray-600 mb-6">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚»ãƒ³ã‚¿ãƒ¼ã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸæœ€æ–°ã®é–‹ç¤ºè³‡æ–™ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„ã€‚</p>
        
        <div class="source-grid">
            <div class="source-item" onclick="toggleSource(this)" data-source-id="kessan-q3-2024">
                <span class="source-type kessan">æ±ºç®—çŸ­ä¿¡</span>
                <h3 class="source-title">2024å¹´3æœˆæœŸ ç¬¬3å››åŠæœŸæ±ºç®—çŸ­ä¿¡</h3>
                <p class="source-meta">2024/01/22 ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â€¢ 45ãƒšãƒ¼ã‚¸ â€¢ 2.8MB</p>
            </div>
            
            <div class="source-item" onclick="toggleSource(this)" data-source-id="tekiji-strategy-2024">
                <span class="source-type tekiji">é©æ™‚é–‹ç¤º</span>
                <h3 class="source-title">ä¸­æœŸçµŒå–¶è¨ˆç”»ã®é€²æ—ã«ã¤ã„ã¦</h3>
                <p class="source-meta">2024/01/15 é–‹ç¤º â€¢ 12ãƒšãƒ¼ã‚¸ â€¢ 856KB</p>
            </div>
            
            <div class="source-item" onclick="toggleSource(this)" data-source-id="tekiji-overseas-2024">
                <span class="source-type tekiji">é©æ™‚é–‹ç¤º</span>
                <h3 class="source-title">æµ·å¤–äº‹æ¥­å±•é–‹ã«é–¢ã™ã‚‹ãŠçŸ¥ã‚‰ã›</h3>
                <p class="source-meta">2024/01/10 é–‹ç¤º â€¢ 8ãƒšãƒ¼ã‚¸ â€¢ 524KB</p>
            </div>
            
            <div class="source-item" onclick="toggleSource(this)" data-source-id="kessan-q2-2024">
                <span class="source-type kessan">æ±ºç®—çŸ­ä¿¡</span>
                <h3 class="source-title">2024å¹´3æœˆæœŸ ç¬¬2å››åŠæœŸæ±ºç®—çŸ­ä¿¡</h3>
                <p class="source-meta">2023/10/25 ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ â€¢ 42ãƒšãƒ¼ã‚¸ â€¢ 2.6MB</p>
            </div>
            
            <div class="source-item" onclick="toggleSource(this)" data-source-id="tekiji-dx-2024">
                <span class="source-type tekiji">é©æ™‚é–‹ç¤º</span>
                <h3 class="source-title">DXæŠ•è³‡è¨ˆç”»ã®æ‹¡å……ã«ã¤ã„ã¦</h3>
                <p class="source-meta">2024/01/05 é–‹ç¤º â€¢ 15ãƒšãƒ¼ã‚¸ â€¢ 1.2MB</p>
            </div>
        </div>
        
        <div class="mt-6 flex justify-between items-center">
            <p class="text-sm text-gray-600">
                <span id="selected-count">0</span>ä»¶é¸æŠä¸­
            </p>
            <button onclick="proceedToAnalysis()" class="btn btn-primary" disabled id="proceed-btn">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                AIåˆ†æã‚’é–‹å§‹
            </button>
        </div>
    </div>
    
    <!-- ã‚¹ãƒ†ãƒƒãƒ—2: AIåˆ†æå®Ÿè¡Œ -->
    <div id="step2-content" class="analysis-process" style="display: none;">
        <div class="process-header">
            <div class="ai-avatar">ğŸ¤–</div>
            <h2 class="process-title">AIæˆ¦ç•¥åˆ†æã‚’å®Ÿè¡Œä¸­</h2>
            <span class="process-status">å‡¦ç†ä¸­...</span>
        </div>
        
        <div class="analysis-tasks">
            <div class="task-item" id="task-1">
                <div class="task-icon processing">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                </div>
                <div class="task-content">
                    <div class="task-name">ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ãƒ»å‰å‡¦ç†</div>
                    <div class="task-description">é¸æŠã•ã‚ŒãŸè³‡æ–™ã‹ã‚‰ãƒ†ã‚­ã‚¹ãƒˆã‚’æŠ½å‡ºã—ã¦ã„ã¾ã™...</div>
                </div>
                <div class="task-progress">
                    <div class="task-progress-bar" style="width: 45%;"></div>
                </div>
            </div>
            
            <div class="task-item" id="task-2">
                <div class="task-icon pending">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                </div>
                <div class="task-content">
                    <div class="task-name">å®šé‡ç›®æ¨™ã®æŠ½å‡º</div>
                    <div class="task-description">å£²ä¸Šé«˜ã€åˆ©ç›Šç‡ã€ãã®ä»–KPIã‚’è­˜åˆ¥ä¸­...</div>
                </div>
                <div class="task-progress">
                    <div class="task-progress-bar" style="width: 0%;"></div>
                </div>
            </div>
            
            <div class="task-item" id="task-3">
                <div class="task-icon pending">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                    </svg>
                </div>
                <div class="task-content">
                    <div class="task-name">é‡ç‚¹æ–½ç­–ã®ç‰¹å®š</div>
                    <div class="task-description">æˆ¦ç•¥çš„å–ã‚Šçµ„ã¿ã¨æ–°è¦æ–½ç­–ã‚’åˆ†é¡ä¸­...</div>
                </div>
                <div class="task-progress">
                    <div class="task-progress-bar" style="width: 0%;"></div>
                </div>
            </div>
            
            <div class="task-item" id="task-4">
                <div class="task-icon pending">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
                    </svg>
                </div>
                <div class="task-content">
                    <div class="task-name">å‰å›ã¨ã®å·®åˆ†åˆ†æ</div>
                    <div class="task-description">å¤‰æ›´ç‚¹ã¨æ›´æ–°ç†ç”±ã‚’æ¨æ¸¬ä¸­...</div>
                </div>
                <div class="task-progress">
                    <div class="task-progress-bar" style="width: 0%;"></div>
                </div>
            </div>
        </div>
        
        <div class="mt-6 p-4 bg-blue-50 rounded-lg">
            <div class="flex items-center gap-2 text-sm text-blue-700">
                <svg class="w-4 h-4 animate-pulse" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
                <span>AIãŒéå»ã®é–‹ç¤ºè³‡æ–™ã¨ç…§åˆã—ãªãŒã‚‰ã€æœ€é©ãªæˆ¦ç•¥æ›´æ–°æ¡ˆã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™...</span>
            </div>
        </div>
    </div>
    
    <!-- ã‚¹ãƒ†ãƒƒãƒ—3: å·®åˆ†ç¢ºèª -->
    <div id="step3-content" style="display: none;">
        <!-- AIã‚¤ãƒ³ã‚µã‚¤ãƒˆ -->
        <div class="ai-insights">
            <div class="insights-header">
                <svg class="w-6 h-6 text-accent-teal" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                </svg>
                <h3 class="insights-title">AIãŒæ¤œå‡ºã—ãŸé‡è¦ãªå¤‰æ›´ç‚¹</h3>
            </div>
            <div class="insight-cards">
                <div class="insight-card" onclick="applyInsight('overseas')">
                    <span class="insight-type">ä¸Šæ–¹ä¿®æ­£</span>
                    <p class="insight-content">
                        æµ·å¤–å£²ä¸Šæ¯”ç‡ã®ç›®æ¨™ãŒ35%ã‹ã‚‰<strong>38%ã«ä¸Šæ–¹ä¿®æ­£</strong>ã•ã‚Œã¦ã„ã¾ã™ã€‚
                        ã‚¢ã‚¸ã‚¢å¸‚å ´ã§ã®æƒ³å®šä»¥ä¸Šã®æˆé•·ãŒè¦å› ã¨æ¨æ¸¬ã•ã‚Œã¾ã™ã€‚
                    </p>
                    <div class="insight-action">
                        è©³ç´°ã‚’ç¢ºèª
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </div>
                </div>
                
                <div class="insight-card" onclick="applyInsight('dx')">
                    <span class="insight-type">æŠ•è³‡å¢—é¡</span>
                    <p class="insight-content">
                        DXæŠ•è³‡é¡ãŒ300å„„å††ã‹ã‚‰<strong>320å„„å††ã«å¢—é¡</strong>ã€‚
                        AIãƒ»ãƒ‡ãƒ¼ã‚¿åˆ†æåŸºç›¤ã®è¿½åŠ æŠ•è³‡ãŒä¸»ãªè¦å› ã§ã™ã€‚
                    </p>
                    <div class="insight-action">
                        è©³ç´°ã‚’ç¢ºèª
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </div>
                </div>
                
                <div class="insight-card" onclick="applyInsight('new-initiative')">
                    <span class="insight-type">æ–°è¦æ–½ç­–</span>
                    <p class="insight-content">
                        <strong>2ã¤ã®æ–°è¦æ–½ç­–</strong>ã‚’æ¤œå‡ºï¼šâ‘ AIéœ€è¦äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ å°å…¥ã€
                        â‘¡æ±å—ã‚¢ã‚¸ã‚¢çµ±æ‹¬ä¼šç¤¾è¨­ç«‹ï¼ˆã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ï¼‰
                    </p>
                    <div class="insight-action">
                        è©³ç´°ã‚’ç¢ºèª
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ¯”è¼ƒãƒ“ãƒ¥ãƒ¼ -->
        <div class="comparison-view">
            <div class="comparison-header">
                <h2 class="text-xl font-semibold text-gray-900">æˆ¦ç•¥ç›®æ¨™ã®å¤‰æ›´ç¢ºèª</h2>
                <div class="comparison-toggle">
                    <button class="toggle-option active" onclick="switchView('side-by-side')">ä¸¦ã¹ã¦è¡¨ç¤º</button>
                    <button class="toggle-option" onclick="switchView('unified')">çµ±åˆè¡¨ç¤º</button>
                    <button class="toggle-option" onclick="switchView('changes-only')">å¤‰æ›´ã®ã¿</button>
                </div>
            </div>
            
            <div class="diff-container">
                <!-- å‰å›ã®å†…å®¹ -->
                <div class="diff-column">
                    <div class="diff-header previous">
                        <span>å‰å›ã®ä¸­æœŸçµŒå–¶è¨ˆç”»</span>
                        <span class="text-xs">2023å¹´11æœˆæ›´æ–°</span>
                    </div>
                    <div class="diff-content">
                        <div class="diff-section">
                            <h3 class="diff-section-title">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                                å®šé‡ç›®æ¨™
                            </h3>
                            <div class="diff-item">
                                <div class="diff-value">35%</div>
                                <div class="diff-label">æµ·å¤–å£²ä¸Šæ¯”ç‡ï¼ˆ2026å¹´åº¦ï¼‰</div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-value">300å„„å††</div>
                                <div class="diff-label">DXæŠ•è³‡é¡ï¼ˆ3å¹´é–“ï¼‰</div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-value">15.0%</div>
                                <div class="diff-label">å–¶æ¥­åˆ©ç›Šç‡ï¼ˆ2026å¹´åº¦ï¼‰</div>
                            </div>
                        </div>
                        
                        <div class="diff-section">
                            <h3 class="diff-section-title">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                                é‡ç‚¹æ–½ç­–
                            </h3>
                            <div class="diff-item">
                                <div class="diff-label">ã‚¢ã‚¸ã‚¢5ã‚«å›½ã¸ã®å±•é–‹</div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-label">åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ åˆ·æ–°</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- æ–°ã—ã„å†…å®¹ -->
                <div class="diff-column">
                    <div class="diff-header current">
                        <span>æ›´æ–°å¾Œã®ä¸­æœŸçµŒå–¶è¨ˆç”»</span>
                        <span class="text-xs">2024å¹´1æœˆï¼ˆAIææ¡ˆï¼‰</span>
                    </div>
                    <div class="diff-content">
                        <div class="diff-section">
                            <h3 class="diff-section-title">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                                å®šé‡ç›®æ¨™
                            </h3>
                            <div class="diff-item changed">
                                <div class="diff-value">38%</div>
                                <div class="diff-label">æµ·å¤–å£²ä¸Šæ¯”ç‡ï¼ˆ2026å¹´åº¦ï¼‰</div>
                                <div class="diff-reason">
                                    <svg class="diff-reason-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span>AIæ¨æ¸¬ç†ç”±ï¼šã‚¢ã‚¸ã‚¢å¸‚å ´ã®æˆé•·ç‡ãŒå½“åˆæƒ³å®šã®å¹´15%ã‹ã‚‰22%ã«ä¸ŠæŒ¯ã‚Œ</span>
                                </div>
                            </div>
                            <div class="diff-item changed">
                                <div class="diff-value">320å„„å††</div>
                                <div class="diff-label">DXæŠ•è³‡é¡ï¼ˆ3å¹´é–“ï¼‰</div>
                                <div class="diff-reason">
                                    <svg class="diff-reason-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span>AIæ¨æ¸¬ç†ç”±ï¼šAIãƒ»ãƒ‡ãƒ¼ã‚¿åˆ†æåŸºç›¤ã¸ã®è¿½åŠ æŠ•è³‡20å„„å††ãŒæ‰¿èª</span>
                                </div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-value">15.0%</div>
                                <div class="diff-label">å–¶æ¥­åˆ©ç›Šç‡ï¼ˆ2026å¹´åº¦ï¼‰</div>
                            </div>
                        </div>
                        
                        <div class="diff-section">
                            <h3 class="diff-section-title">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                                é‡ç‚¹æ–½ç­–
                            </h3>
                            <div class="diff-item">
                                <div class="diff-label">ã‚¢ã‚¸ã‚¢5ã‚«å›½ã¸ã®å±•é–‹</div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-label">åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ åˆ·æ–°</div>
                            </div>
                            <div class="diff-item added">
                                <div class="diff-label">AIéœ€è¦äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ å°å…¥ï¼ˆæ–°è¦ï¼‰</div>
                                <div class="diff-reason">
                                    <svg class="diff-reason-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                    </svg>
                                    <span>2024å¹´Q2ã‚ˆã‚Šå°å…¥é–‹å§‹ã€å–¶æ¥­åˆ©ç›Šç‡0.5ptæ”¹å–„ã‚’è¦‹è¾¼ã‚€</span>
                                </div>
                            </div>
                            <div class="diff-item added">
                                <div class="diff-label">æ±å—ã‚¢ã‚¸ã‚¢çµ±æ‹¬ä¼šç¤¾è¨­ç«‹ï¼ˆæ–°è¦ï¼‰</div>
                                <div class="diff-reason">
                                    <svg class="diff-reason-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                    </svg>
                                    <span>ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã«2024å¹´7æœˆè¨­ç«‹äºˆå®šã€åœ°åŸŸçµ±æ‹¬æ©Ÿèƒ½ã‚’é›†ç´„</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-6 flex justify-end">
            <button onclick="proceedToEdit()" class="btn btn-success">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                å¤‰æ›´ã‚’ç¢ºèªã—ã¦ç·¨é›†ã¸é€²ã‚€
            </button>
        </div>
    </div>
    
    <!-- ã‚¹ãƒ†ãƒƒãƒ—4: ç·¨é›†ãƒ»æ‰¿èª -->
    <div id="step4-content" style="display: none;">
        <div class="edit-section">
            <h2 class="text-xl font-semibold text-gray-900 mb-6">æˆ¦ç•¥æ›´æ–°ã®ç·¨é›†</h2>
            
            <div class="edit-tabs">
                <button class="edit-tab active" onclick="switchEditTab('quantitative')">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                    å®šé‡ç›®æ¨™
                </button>
                <button class="edit-tab" onclick="switchEditTab('strategies')">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                    é‡ç‚¹æ–½ç­–
                </button>
                <button class="edit-tab" onclick="switchEditTab('reasons')">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    å¤‰æ›´ç†ç”±
                </button>
            </div>
            
            <!-- å®šé‡ç›®æ¨™ã‚¿ãƒ– -->
            <div id="tab-quantitative" class="edit-form">
                <div class="form-group">
                    <label class="form-label">
                        æµ·å¤–å£²ä¸Šæ¯”ç‡ï¼ˆ2026å¹´åº¦ç›®æ¨™ï¼‰
                        <span class="required">*</span>
                    </label>
                    <input type="text" class="form-input ai-suggested" value="38%" id="overseas-ratio">
                    <div class="ai-suggestion-box">
                        <svg class="suggestion-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <div>
                            <div class="suggestion-text">
                                AIãŒã‚¢ã‚¸ã‚¢å¸‚å ´ã®æˆé•·ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’åˆ†æã—ãŸçµæœã€38%ã¸ã®ä¸Šæ–¹ä¿®æ­£ã‚’æ¨å¥¨ã—ã¾ã™ã€‚
                                ç‰¹ã«ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢ãƒ»ãƒ™ãƒˆãƒŠãƒ ã§ã®éœ€è¦æ‹¡å¤§ãŒé¡•è‘—ã§ã™ã€‚
                            </div>
                            <div class="suggestion-actions">
                                <button class="suggestion-btn primary" onclick="acceptSuggestion('overseas-ratio')">æ¡ç”¨</button>
                                <button class="suggestion-btn" onclick="rejectSuggestion('overseas-ratio')">å…ƒã®å€¤ï¼ˆ35%ï¼‰ã«æˆ»ã™</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        DXæŠ•è³‡é¡ï¼ˆ3å¹´é–“ï¼‰
                        <span class="required">*</span>
                    </label>
                    <input type="text" class="form-input ai-suggested" value="320å„„å††" id="dx-investment">
                    <div class="ai-suggestion-box">
                        <svg class="suggestion-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <div>
                            <div class="suggestion-text">
                                AIãƒ»ãƒ‡ãƒ¼ã‚¿åˆ†æåŸºç›¤ã¸ã®è¿½åŠ æŠ•è³‡20å„„å††ãŒé©æ™‚é–‹ç¤ºã§ç™ºè¡¨ã•ã‚Œã¦ã„ã¾ã™ã€‚
                                ã“ã‚Œã«ã‚ˆã‚Šç«¶åˆå„ªä½æ€§ã®ç¢ºä¿ãŒæœŸå¾…ã•ã‚Œã¾ã™ã€‚
                            </div>
                            <div class="suggestion-actions">
                                <button class="suggestion-btn primary" onclick="acceptSuggestion('dx-investment')">æ¡ç”¨</button>
                                <button class="suggestion-btn" onclick="viewDetails('dx-breakdown')">å†…è¨³ã‚’ç¢ºèª</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        å–¶æ¥­åˆ©ç›Šç‡ï¼ˆ2026å¹´åº¦ç›®æ¨™ï¼‰
                        <span class="required">*</span>
                    </label>
                    <input type="text" class="form-input" value="15.0%" id="operating-margin">
                </div>
            </div>
            
            <!-- é‡ç‚¹æ–½ç­–ã‚¿ãƒ– -->
            <div id="tab-strategies" class="edit-form" style="display: none;">
                <div class="form-group">
                    <label class="form-label">æ—¢å­˜æ–½ç­–</label>
                    <div class="space-y-2">
                        <div class="flex items-center gap-2">
                            <input type="checkbox" checked id="strategy-1">
                            <label for="strategy-1">ã‚¢ã‚¸ã‚¢5ã‚«å›½ã¸ã®å±•é–‹</label>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="checkbox" checked id="strategy-2">
                            <label for="strategy-2">åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ åˆ·æ–°</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        æ–°è¦æ–½ç­–â‘ 
                        <span class="text-xs text-accent-teal ml-2">AIãŒæŠ½å‡º</span>
                    </label>
                    <input type="text" class="form-input ai-suggested" value="AIéœ€è¦äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ å°å…¥">
                    <textarea class="form-textarea mt-2" placeholder="è©³ç´°èª¬æ˜">2024å¹´Q2ã‚ˆã‚Šæ®µéšçš„ã«å°å…¥ã€‚åœ¨åº«æœ€é©åŒ–ã«ã‚ˆã‚Šå–¶æ¥­åˆ©ç›Šç‡0.5ptæ”¹å–„ã‚’è¦‹è¾¼ã‚€ã€‚åˆæœŸæŠ•è³‡é¡ã¯15å„„å††ã€å¹´é–“é‹ç”¨ã‚³ã‚¹ãƒˆ2å„„å††ã‚’æƒ³å®šã€‚</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        æ–°è¦æ–½ç­–â‘¡
                        <span class="text-xs text-accent-teal ml-2">AIãŒæŠ½å‡º</span>
                    </label>
                    <input type="text" class="form-input ai-suggested" value="æ±å—ã‚¢ã‚¸ã‚¢çµ±æ‹¬ä¼šç¤¾è¨­ç«‹">
                    <textarea class="form-textarea mt-2" placeholder="è©³ç´°èª¬æ˜">ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«ã«åœ°åŸŸçµ±æ‹¬æ©Ÿèƒ½ã‚’é›†ç´„ã€‚2024å¹´7æœˆè¨­ç«‹äºˆå®šã€‚ç¾åœ°æ³•äºº5ç¤¾ã‚’çµ±æ‹¬ã—ã€æ„æ€æ±ºå®šã‚¹ãƒ”ãƒ¼ãƒ‰ã‚’å‘ä¸Šã€‚æŠ•è³‡é¡50å„„å††ã€‚</textarea>
                </div>
            </div>
            
            <!-- å¤‰æ›´ç†ç”±ã‚¿ãƒ– -->
            <div id="tab-reasons" class="edit-form" style="display: none;">
                <div class="form-group">
                    <label class="form-label">æµ·å¤–å£²ä¸Šæ¯”ç‡ä¸Šæ–¹ä¿®æ­£ã®ç†ç”±</label>
                    <textarea class="form-textarea" rows="4">ã‚¢ã‚¸ã‚¢å¸‚å ´ã€ç‰¹ã«ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢ãƒ»ãƒ™ãƒˆãƒŠãƒ ã«ãŠã‘ã‚‹éœ€è¦ãŒæƒ³å®šã‚’ä¸Šå›ã‚‹ãƒšãƒ¼ã‚¹ã§æ‹¡å¤§ã€‚ç¾åœ°ãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã¨ã®ææºã‚‚é †èª¿ã«é€²å±•ã—ã€2023å¹´åº¦ã®æµ·å¤–å£²ä¸Šé«˜ãŒå‰å¹´æ¯”+28%ã¨å¤§å¹…ã«æˆé•·ã—ãŸã“ã¨ã‚’è¸ã¾ãˆã€ç›®æ¨™ã‚’35%ã‹ã‚‰38%ã«ä¸Šæ–¹ä¿®æ­£ã€‚</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">DXæŠ•è³‡å¢—é¡ã®ç†ç”±</label>
                    <textarea class="form-textarea" rows="4">ç«¶åˆä»–ç¤¾ã®ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–é€²å±•ã«å¯¾å¿œã—ã€ç«¶äº‰å„ªä½æ€§ã‚’ç¢ºä¿ã™ã‚‹ãŸã‚ã€AIãƒ»ãƒ‡ãƒ¼ã‚¿åˆ†æåŸºç›¤ã¸ã®æŠ•è³‡ã‚’è¿½åŠ ã€‚ç‰¹ã«éœ€è¦äºˆæ¸¬ç²¾åº¦ã®å‘ä¸Šã¨ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³æœ€é©åŒ–ã«ã‚ˆã‚Šã€åç›Šæ€§æ”¹å–„ã‚’åŠ é€Ÿã•ã›ã‚‹ã€‚å–ç· å½¹ä¼šã«ã¦20å„„å††ã®è¿½åŠ æŠ•è³‡ã‚’æ‰¿èªï¼ˆ2024å¹´1æœˆï¼‰ã€‚</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">æŠ•è³‡å®¶å‘ã‘èª¬æ˜ãƒã‚¤ãƒ³ãƒˆ</label>
                    <textarea class="form-textarea" rows="4">1. æµ·å¤–å±•é–‹ã®åŠ é€Ÿã¯ã€å›½å†…å¸‚å ´ã®æˆç†ŸåŒ–ãƒªã‚¹ã‚¯ã¸ã®å¯¾å¿œç­–
2. DXæŠ•è³‡ã¯çŸ­æœŸçš„ãªã‚³ã‚¹ãƒˆå¢—ã¨ãªã‚‹ãŒã€ä¸­é•·æœŸçš„ãªROIæ”¹å–„ã«å¯„ä¸
3. æ–°è¦æ–½ç­–ã¯ã„ãšã‚Œã‚‚æ—¢å­˜äº‹æ¥­ã¨ã®ã‚·ãƒŠã‚¸ãƒ¼ãŒé«˜ãã€å®Ÿç¾å¯èƒ½æ€§ã‚’ç²¾æŸ»æ¸ˆã¿</textarea>
                </div>
            </div>
            
            <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
            <div class="action-bar">
                <div class="action-info">
                    <span class="text-sm text-gray-500">æœ€çµ‚æ›´æ–°ï¼š</span>
                    <span class="text-sm font-medium">2024å¹´1æœˆ22æ—¥ 14:35ï¼ˆAIåˆ†æï¼‰</span>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="saveDraft()">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                        </svg>
                        ä¸‹æ›¸ãä¿å­˜
                    </button>
                    <button class="btn btn-primary" onclick="submitForApproval()">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        æ‰¿èªç”³è«‹
                    </button>
                    <button class="btn btn-success" onclick="applyToStrategy()">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        æˆ¦ç•¥è¨ˆç”»ã«é©ç”¨
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
    let selectedSources = [];
    let currentStep = 1;
    let analysisInterval;
    
    // ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹é¸æŠ
    function toggleSource(element) {
        element.classList.toggle('selected');
        const sourceId = element.getAttribute('data-source-id');
        
        if (element.classList.contains('selected')) {
            selectedSources.push(sourceId);
        } else {
            selectedSources = selectedSources.filter(id => id !== sourceId);
        }
        
        updateSelectedCount();
    }
    
    function updateSelectedCount() {
        document.getElementById('selected-count').textContent = selectedSources.length;
        const proceedBtn = document.getElementById('proceed-btn');
        
        if (selectedSources.length > 0) {
            proceedBtn.disabled = false;
            proceedBtn.classList.add('hover:bg-kagami-blue-dark');
        } else {
            proceedBtn.disabled = true;
            proceedBtn.classList.remove('hover:bg-kagami-blue-dark');
        }
    }
    
    // åˆ†æé–‹å§‹
    function proceedToAnalysis() {
        if (selectedSources.length === 0) {
            showNotification('ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’é¸æŠã—ã¦ãã ã•ã„', 'warning');
            return;
        }
        
        // ã‚¹ãƒ†ãƒƒãƒ—2ã¸ç§»è¡Œ
        moveToStep(2);
        
        // åˆ†æãƒ—ãƒ­ã‚»ã‚¹ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        simulateAnalysis();
    }
    
    // ã‚¹ãƒ†ãƒƒãƒ—é·ç§»
    function moveToStep(step) {
        // å‰ã®ã‚¹ãƒ†ãƒƒãƒ—ã‚’éè¡¨ç¤º
        document.getElementById(`step${currentStep}-content`).style.display = 'none';
        
        // æ–°ã—ã„ã‚¹ãƒ†ãƒƒãƒ—ã‚’è¡¨ç¤º
        document.getElementById(`step${step}-content`).style.display = 'block';
        
        // ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ã‚’æ›´æ–°
        updateStepIndicators(step);
        
        currentStep = step;
        
        // ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    // ã‚¹ãƒ†ãƒƒãƒ—ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼æ›´æ–°
    function updateStepIndicators(activeStep) {
        for (let i = 1; i <= 4; i++) {
            const circle = document.getElementById(`step${i}`);
            const label = circle.nextElementSibling;
            
            circle.classList.remove('active', 'completed');
            label.classList.remove('active');
            
            if (i < activeStep) {
                circle.classList.add('completed');
                circle.innerHTML = `
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                `;
            } else if (i === activeStep) {
                circle.classList.add('active');
                label.classList.add('active');
            }
        }
    }
    
    // AIåˆ†æã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    function simulateAnalysis() {
        const tasks = [
            { id: 'task-1', duration: 2000 },
            { id: 'task-2', duration: 2500 },
            { id: 'task-3', duration: 2000 },
            { id: 'task-4', duration: 3000 }
        ];
        
        let currentTask = 0;
        
        function processTask() {
            if (currentTask < tasks.length) {
                const task = tasks[currentTask];
                const taskElement = document.getElementById(task.id);
                const icon = taskElement.querySelector('.task-icon');
                const progressBar = taskElement.querySelector('.task-progress-bar');
                
                // ã‚¿ã‚¹ã‚¯ã‚’å‡¦ç†ä¸­ã«å¤‰æ›´
                icon.classList.remove('pending');
                icon.classList.add('processing');
                taskElement.classList.add('processing');
                
                // ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += 5;
                    progressBar.style.width = `${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(progressInterval);
                        
                        // ã‚¿ã‚¹ã‚¯å®Œäº†
                        icon.classList.remove('processing');
                        icon.classList.add('completed');
                        icon.innerHTML = `
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                        `;
                        taskElement.classList.remove('processing');
                        taskElement.classList.add('completed');
                        
                        currentTask++;
                        
                        if (currentTask < tasks.length) {
                            setTimeout(processTask, 500);
                        } else {
                            // ã™ã¹ã¦ã®ã‚¿ã‚¹ã‚¯ãŒå®Œäº†
                            setTimeout(() => {
                                showNotification('AIåˆ†æãŒå®Œäº†ã—ã¾ã—ãŸ', 'success');
                                moveToStep(3);
                            }, 1000);
                        }
                    }
                }, task.duration / 20);
            }
        }
        
        processTask();
    }
    
    // ç·¨é›†ã¸é€²ã‚€
    function proceedToEdit() {
        moveToStep(4);
    }
    
    // ãƒ“ãƒ¥ãƒ¼åˆ‡ã‚Šæ›¿ãˆ
    function switchView(view) {
        const buttons = document.querySelectorAll('.toggle-option');
        buttons.forEach(btn => {
            btn.classList.remove('active');
            if (btn.getAttribute('onclick').includes(view)) {
                btn.classList.add('active');
            }
        });
        
        // ãƒ“ãƒ¥ãƒ¼ã«å¿œã˜ãŸè¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆï¼ˆå®Ÿè£…ã¯çœç•¥ï¼‰
        showNotification(`${view}ãƒ“ãƒ¥ãƒ¼ã«åˆ‡ã‚Šæ›¿ãˆã¾ã—ãŸ`, 'info');
    }
    
    // ç·¨é›†ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
    function switchEditTab(tab) {
        // ã‚¿ãƒ–ãƒœã‚¿ãƒ³ã®æ›´æ–°
        const tabs = document.querySelectorAll('.edit-tab');
        tabs.forEach(t => t.classList.remove('active'));
        event.target.closest('.edit-tab').classList.add('active');
        
        // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®è¡¨ç¤ºåˆ‡ã‚Šæ›¿ãˆ
        document.querySelectorAll('[id^="tab-"]').forEach(content => {
            content.style.display = 'none';
        });
        document.getElementById(`tab-${tab}`).style.display = 'grid';
    }
    
    // AIææ¡ˆã®æ¡ç”¨
    function acceptSuggestion(field) {
        showNotification('AIææ¡ˆã‚’æ¡ç”¨ã—ã¾ã—ãŸ', 'success');
        document.getElementById(field).classList.add('animate-in');
    }
    
    // AIææ¡ˆã®å´ä¸‹
    function rejectSuggestion(field) {
        if (field === 'overseas-ratio') {
            document.getElementById(field).value = '35%';
        } else if (field === 'dx-investment') {
            document.getElementById(field).value = '300å„„å††';
        }
        showNotification('å…ƒã®å€¤ã«æˆ»ã—ã¾ã—ãŸ', 'info');
    }
    
    // è©³ç´°è¡¨ç¤º
    function viewDetails(type) {
        showModal({
            title: 'DXæŠ•è³‡å†…è¨³',
            content: `
                <div class="space-y-4">
                    <h4 class="font-semibold text-gray-900">æŠ•è³‡é¡å†…è¨³ï¼ˆç·é¡320å„„å††ï¼‰</h4>
                    <div class="space-y-2">
                        <div class="flex justify-between py-2 border-b">
                            <span>åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ åˆ·æ–°</span>
                            <span class="font-medium">180å„„å††</span>
                        </div>
                        <div class="flex justify-between py-2 border-b">
                            <span>AIãƒ»ãƒ‡ãƒ¼ã‚¿åˆ†æåŸºç›¤ï¼ˆè¿½åŠ ï¼‰</span>
                            <span class="font-medium text-accent-teal">80å„„å††</span>
                        </div>
                        <div class="flex justify-between py-2 border-b">
                            <span>ã‚¯ãƒ©ã‚¦ãƒ‰ç§»è¡Œ</span>
                            <span class="font-medium">40å„„å††</span>
                        </div>
                        <div class="flex justify-between py-2">
                            <span>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–</span>
                            <span class="font-medium">20å„„å††</span>
                        </div>
                    </div>
                </div>
            `,
            confirmText: 'ç¢ºèª',
            showCancel: false
        });
    }
    
    // ã‚¤ãƒ³ã‚µã‚¤ãƒˆé©ç”¨
    function applyInsight(type) {
        // è©²å½“ã™ã‚‹å·®åˆ†ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
        const targetElement = document.querySelector(`.diff-item.changed, .diff-item.added`);
        if (targetElement) {
            targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            targetElement.classList.add('animate-in');
        }
    }
    
    // ä¸‹æ›¸ãä¿å­˜
    function saveDraft() {
        showNotification('ä¸‹æ›¸ãã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
    }
    
    // æ‰¿èªç”³è«‹
    function submitForApproval() {
        showModal({
            title: 'æ‰¿èªç”³è«‹ã®ç¢ºèª',
            content: `
                <div class="space-y-4">
                    <p class="text-gray-600">ä»¥ä¸‹ã®å¤‰æ›´å†…å®¹ã§æ‰¿èªç”³è«‹ã‚’è¡Œã„ã¾ã™ã€‚</p>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900 mb-2">ä¸»ãªå¤‰æ›´ç‚¹</h4>
                        <ul class="space-y-1 text-sm text-gray-700">
                            <li>â€¢ æµ·å¤–å£²ä¸Šæ¯”ç‡ï¼š35% â†’ 38%</li>
                            <li>â€¢ DXæŠ•è³‡é¡ï¼š300å„„å†† â†’ 320å„„å††</li>
                            <li>â€¢ æ–°è¦æ–½ç­–ï¼šAIéœ€è¦äºˆæ¸¬ã‚·ã‚¹ãƒ†ãƒ ã€æ±å—ã‚¢ã‚¸ã‚¢çµ±æ‹¬ä¼šç¤¾</li>
                        </ul>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ‰¿èªè€…</label>
                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option>CFO - å±±ç”°å¤ªéƒ</option>
                            <option>CEO - ä½è—¤èŠ±å­</option>
                            <option>å–ç· å½¹ä¼š</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ã‚³ãƒ¡ãƒ³ãƒˆï¼ˆä»»æ„ï¼‰</label>
                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg" rows="3"
                            placeholder="æ‰¿èªè€…ã¸ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"></textarea>
                    </div>
                </div>
            `,
            confirmText: 'ç”³è«‹ã™ã‚‹',
            onConfirm: () => {
                showNotification('æ‰¿èªç”³è«‹ã‚’é€ä¿¡ã—ã¾ã—ãŸ', 'success');
            }
        });
    }
    
    // æˆ¦ç•¥è¨ˆç”»ã«é©ç”¨
    function applyToStrategy() {
        showModal({
            title: 'æˆ¦ç•¥è¨ˆç”»ã¸ã®é©ç”¨ç¢ºèª',
            content: `
                <div class="space-y-4">
                    <p class="text-gray-600">
                        AIåˆ†æçµæœã‚’ä¸­æœŸçµŒå–¶è¨ˆç”»ã«é©ç”¨ã—ã¾ã™ã€‚
                        ã“ã®æ“ä½œã«ã‚ˆã‚Šã€æŠ•è³‡å®¶å‘ã‘ãƒšãƒ¼ã‚¸ã‚‚è‡ªå‹•æ›´æ–°ã•ã‚Œã¾ã™ã€‚
                    </p>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex items-start gap-2">
                            <svg class="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                            <div class="text-sm text-yellow-800">
                                <p class="font-medium mb-1">é‡è¦</p>
                                <p>é©ç”¨å¾Œã¯é–¢é€£ã™ã‚‹æŠ•è³‡å®¶ã¸ã®é€šçŸ¥ãŒå¿…è¦ã§ã™ã€‚</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" checked class="mr-2">
                            <span class="text-sm">é–¢é€£ã™ã‚‹æŠ•è³‡å®¶ã¸æ›´æ–°é€šçŸ¥ã‚’é€ä¿¡</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" checked class="mr-2">
                            <span class="text-sm">FAQã‚’è‡ªå‹•ç”Ÿæˆã—ã¦å…¬é–‹</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">
                            <span class="text-sm">æ±ºç®—èª¬æ˜ä¼šã§ä½¿ç”¨ã™ã‚‹è³‡æ–™ã‚’æ›´æ–°</span>
                        </label>
                    </div>
                </div>
            `,
            confirmText: 'é©ç”¨ã™ã‚‹',
            onConfirm: () => {
                showNotification('æˆ¦ç•¥è¨ˆç”»ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'success');
                setTimeout(() => {
                    window.location.href = '/strategy-planning';
                }, 2000);
            }
        });
    }
    
    // é€šçŸ¥è¡¨ç¤ºï¼ˆæ—¢å­˜ã®ã‚·ã‚¹ãƒ†ãƒ ã¨çµ±åˆï¼‰
    function showNotification(message, type = 'info') {
        // æ—¢å­˜ã®notifications.jsã‚’ä½¿ç”¨
        if (typeof window.showNotification === 'function') {
            window.showNotification(message, type);
        } else {
            console.log(`${type}: ${message}`);
        }
    }
    
    // ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºï¼ˆæ—¢å­˜ã®ã‚·ã‚¹ãƒ†ãƒ ã¨çµ±åˆï¼‰
    function showModal(options) {
        // æ—¢å­˜ã®modals.jsã‚’ä½¿ç”¨
        if (typeof window.showModal === 'function') {
            window.showModal(options);
        } else {
            if (confirm(options.content)) {
                options.onConfirm && options.onConfirm();
            }
        }
    }
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', function() {
        // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é©ç”¨
        document.querySelectorAll('.animate-in').forEach((el, index) => {
            el.style.animationDelay = `${index * 0.1}s`;
        });
    });
</script>
{% endblock %}