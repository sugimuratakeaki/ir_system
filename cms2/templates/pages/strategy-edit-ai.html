{% extends "base.html" %}

{% block title %}AIÊà¶Áï•ÂàÜÊûê„ÉªÁ∑®ÈõÜ{% endblock %}
{% block page_icon %}ü§ñ{% endblock %}
{% block page_title %}AIÊà¶Áï•ÂàÜÊûê„ÉªÁ∑®ÈõÜ{% endblock %}
{% block breadcrumb_current %}AIÊà¶Áï•ÂàÜÊûê„ÉªÁ∑®ÈõÜ{% endblock %}

{% block extra_css %}
<style>
    /* AIÂàÜÊûê„Éï„É≠„ÉºÂÖ®‰Ωì„ÅÆ„Ç≥„É≥„ÉÜ„Éä */
    .ai-analysis-workflow {
        background: linear-gradient(135deg, #f9fafb 0%, #e5e7eb 100%);
        border-radius: 16px;
        padding: 32px;
        margin-bottom: 32px;
        position: relative;
        overflow: hidden;
    }
    
    .ai-analysis-workflow::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -10%;
        width: 500px;
        height: 500px;
        background: radial-gradient(circle, rgba(20, 184, 166, 0.1) 0%, transparent 70%);
        border-radius: 50%;
    }
    
    /* „Çπ„ÉÜ„ÉÉ„Éó„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº */
    .workflow-steps {
        display: flex;
        justify-content: space-between;
        margin-bottom: 32px;
        position: relative;
        z-index: 1;
    }
    
    .workflow-step {
        flex: 1;
        text-align: center;
        position: relative;
    }
    
    .workflow-step::after {
        content: '';
        position: absolute;
        top: 20px;
        left: 50%;
        width: calc(100% - 40px);
        height: 2px;
        background: var(--gray-300);
        z-index: -1;
    }
    
    .workflow-step:last-child::after {
        display: none;
    }
    
    .step-circle {
        width: 40px;
        height: 40px;
        background: white;
        border: 2px solid var(--gray-300);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 8px;
        position: relative;
        transition: all 0.3s ease;
    }
    
    .step-circle.active {
        background: var(--accent-teal);
        border-color: var(--accent-teal);
        color: white;
        transform: scale(1.1);
        box-shadow: 0 0 0 8px rgba(20, 184, 166, 0.1);
    }
    
    .step-circle.completed {
        background: var(--success);
        border-color: var(--success);
        color: white;
    }
    
    .step-label {
        font-size: var(--text-sm);
        color: var(--gray-600);
        font-weight: var(--font-medium);
    }
    
    .step-label.active {
        color: var(--accent-teal);
        font-weight: var(--font-semibold);
    }
    
    /* „Éá„Éº„Çø„ÇΩ„Éº„ÇπÈÅ∏Êäû */
    .data-source-selector {
        background: white;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .source-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 16px;
        margin-top: 16px;
    }
    
    .source-item {
        border: 2px solid var(--gray-200);
        border-radius: 8px;
        padding: 16px;
        cursor: pointer;
        transition: all 0.2s ease;
        position: relative;
        overflow: hidden;
    }
    
    .source-item:hover {
        border-color: var(--accent-teal);
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }
    
    .source-item.selected {
        border-color: var(--accent-teal);
        background: linear-gradient(135deg, #f0fdfa 0%, #e6fffa 100%);
    }
    
    .source-item.selected::after {
        content: '‚úì';
        position: absolute;
        top: 12px;
        right: 12px;
        width: 24px;
        height: 24px;
        background: var(--accent-teal);
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 14px;
        font-weight: bold;
    }
    
    .source-type {
        display: inline-block;
        padding: 4px 8px;
        background: var(--gray-100);
        border-radius: 4px;
        font-size: var(--text-xs);
        font-weight: var(--font-medium);
        text-transform: uppercase;
        margin-bottom: 8px;
    }
    
    .source-type.kessan {
        background: #dbeafe;
        color: #1e40af;
    }
    
    .source-type.tekiji {
        background: #fef3c7;
        color: #92400e;
    }
    
    .source-title {
        font-weight: var(--font-semibold);
        color: var(--gray-900);
        margin-bottom: 4px;
    }
    
    .source-meta {
        font-size: var(--text-sm);
        color: var(--gray-600);
    }
    
    /* AIÂàÜÊûê„Éó„É≠„Çª„Çπ */
    .analysis-process {
        background: white;
        border-radius: 12px;
        padding: 32px;
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .process-header {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .ai-avatar {
        width: 48px;
        height: 48px;
        background: linear-gradient(135deg, var(--accent-teal) 0%, var(--info) 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.05); opacity: 0.9; }
    }
    
    .process-title {
        font-size: var(--text-xl);
        font-weight: var(--font-bold);
        color: var(--gray-900);
    }
    
    .process-status {
        margin-left: auto;
        padding: 6px 16px;
        background: var(--info-light);
        color: white;
        border-radius: 20px;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
    }
    
    /* ÂàÜÊûê„Çø„Çπ„ÇØ„É™„Çπ„Éà */
    .analysis-tasks {
        space-y: 12px;
    }
    
    .task-item {
        display: flex;
        align-items: center;
        gap: 16px;
        padding: 16px;
        background: var(--gray-50);
        border-radius: 8px;
        transition: all 0.3s ease;
    }
    
    .task-item.processing {
        background: linear-gradient(135deg, #dbeafe 0%, #e0f2fe 100%);
        transform: translateX(8px);
    }
    
    .task-item.completed {
        background: linear-gradient(135deg, #d1fae5 0%, #ecfccb 100%);
    }
    
    .task-icon {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 50%;
        background: white;
        box-shadow: var(--shadow-sm);
    }
    
    .task-icon.pending {
        color: var(--gray-400);
    }
    
    .task-icon.processing {
        color: var(--info);
        animation: spin 1s linear infinite;
    }
    
    .task-icon.completed {
        color: var(--success);
    }
    
    @keyframes spin {
        from { transform: rotate(0deg); }
        to { transform: rotate(360deg); }
    }
    
    .task-content {
        flex: 1;
    }
    
    .task-name {
        font-weight: var(--font-medium);
        color: var(--gray-900);
        margin-bottom: 2px;
    }
    
    .task-description {
        font-size: var(--text-sm);
        color: var(--gray-600);
    }
    
    .task-progress {
        width: 120px;
        height: 6px;
        background: var(--gray-200);
        border-radius: 3px;
        overflow: hidden;
    }
    
    .task-progress-bar {
        height: 100%;
        background: var(--accent-teal);
        transition: width 0.3s ease;
    }
    
    /* ÊØîËºÉ„Éì„É•„Éº */
    .comparison-view {
        background: white;
        border-radius: 12px;
        padding: 32px;
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .comparison-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 24px;
    }
    
    .comparison-toggle {
        display: flex;
        background: var(--gray-100);
        border-radius: 8px;
        padding: 4px;
    }
    
    .toggle-option {
        padding: 8px 16px;
        border-radius: 6px;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        color: var(--gray-600);
        background: transparent;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .toggle-option.active {
        background: white;
        color: var(--gray-900);
        box-shadow: var(--shadow-sm);
    }
    
    /* Â∑ÆÂàÜË°®Á§∫ */
    .diff-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 24px;
    }
    
    .diff-column {
        border: 1px solid var(--gray-200);
        border-radius: 8px;
        overflow: hidden;
    }
    
    .diff-header {
        padding: 16px;
        background: var(--gray-50);
        border-bottom: 1px solid var(--gray-200);
        font-weight: var(--font-semibold);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }
    
    .diff-header.previous {
        background: #fef3c7;
        color: #92400e;
    }
    
    .diff-header.current {
        background: #dbeafe;
        color: #1e40af;
    }
    
    .diff-content {
        padding: 24px;
    }
    
    .diff-section {
        margin-bottom: 24px;
    }
    
    .diff-section-title {
        font-weight: var(--font-semibold);
        color: var(--gray-900);
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .diff-item {
        padding: 12px;
        background: var(--gray-50);
        border-radius: 6px;
        margin-bottom: 8px;
        position: relative;
    }
    
    .diff-item.changed {
        background: #fef3c7;
        border-left: 4px solid #f59e0b;
    }
    
    .diff-item.added {
        background: #d1fae5;
        border-left: 4px solid #10b981;
    }
    
    .diff-item.removed {
        background: #fee2e2;
        border-left: 4px solid #ef4444;
        opacity: 0.7;
        text-decoration: line-through;
    }
    
    .diff-value {
        font-size: var(--text-xl);
        font-weight: var(--font-bold);
        color: var(--kagami-blue);
        margin-bottom: 4px;
    }
    
    .diff-label {
        font-size: var(--text-sm);
        color: var(--gray-600);
    }
    
    .diff-reason {
        margin-top: 8px;
        padding: 8px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 4px;
        font-size: var(--text-sm);
        color: var(--gray-700);
        display: flex;
        align-items: start;
        gap: 8px;
    }
    
    .diff-reason-icon {
        color: var(--accent-teal);
        flex-shrink: 0;
        margin-top: 2px;
    }
    
    /* AI„Ç§„É≥„Çµ„Ç§„Éà */
    .ai-insights {
        background: linear-gradient(135deg, #f0fdfa 0%, #e6fffa 100%);
        border: 1px solid var(--accent-teal);
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        position: relative;
        overflow: hidden;
    }
    
    .ai-insights::before {
        content: 'üí°';
        position: absolute;
        top: -20px;
        right: -20px;
        font-size: 80px;
        opacity: 0.1;
    }
    
    .insights-header {
        display: flex;
        align-items: center;
        gap: 12px;
        margin-bottom: 16px;
    }
    
    .insights-title {
        font-size: var(--text-lg);
        font-weight: var(--font-bold);
        color: var(--accent-teal-dark);
    }
    
    .insight-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 16px;
    }
    
    .insight-card {
        background: white;
        border-radius: 8px;
        padding: 16px;
        box-shadow: var(--shadow-sm);
        transition: all 0.2s ease;
        cursor: pointer;
    }
    
    .insight-card:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
    }
    
    .insight-type {
        display: inline-block;
        padding: 4px 8px;
        background: var(--accent-teal);
        color: white;
        border-radius: 4px;
        font-size: var(--text-xs);
        font-weight: var(--font-medium);
        margin-bottom: 8px;
    }
    
    .insight-content {
        font-size: var(--text-sm);
        color: var(--gray-700);
        line-height: var(--leading-relaxed);
    }
    
    .insight-action {
        margin-top: 12px;
        display: flex;
        align-items: center;
        gap: 4px;
        color: var(--accent-teal);
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
    }
    
    /* Á∑®ÈõÜ„Ç®„É™„Ç¢ */
    .edit-section {
        background: white;
        border-radius: 12px;
        padding: 32px;
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .edit-tabs {
        display: flex;
        gap: 4px;
        background: var(--gray-100);
        padding: 4px;
        border-radius: 8px;
        margin-bottom: 24px;
    }
    
    .edit-tab {
        flex: 1;
        padding: 10px;
        border-radius: 6px;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        color: var(--gray-600);
        background: transparent;
        border: none;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }
    
    .edit-tab.active {
        background: white;
        color: var(--gray-900);
        box-shadow: var(--shadow-sm);
    }
    
    .edit-form {
        display: grid;
        gap: 24px;
    }
    
    .form-group {
        display: grid;
        gap: 8px;
    }
    
    .form-label {
        font-weight: var(--font-medium);
        color: var(--gray-700);
        font-size: var(--text-sm);
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .form-label .required {
        color: var(--error);
    }
    
    .form-input {
        width: 100%;
        padding: 10px 14px;
        border: 1px solid var(--gray-300);
        border-radius: 6px;
        font-size: var(--text-sm);
        transition: all 0.2s ease;
        background: white;
    }
    
    .form-input:focus {
        outline: none;
        border-color: var(--accent-teal);
        box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
    }
    
    .form-input.ai-suggested {
        border-color: var(--accent-teal);
        background: linear-gradient(to right, white 0%, #f0fdfa 100%);
    }
    
    .form-textarea {
        width: 100%;
        padding: 10px 14px;
        border: 1px solid var(--gray-300);
        border-radius: 6px;
        font-size: var(--text-sm);
        transition: all 0.2s ease;
        resize: vertical;
        min-height: 100px;
    }
    
    .form-textarea:focus {
        outline: none;
        border-color: var(--accent-teal);
        box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
    }
    
    .ai-suggestion-box {
        background: var(--gray-50);
        border: 1px solid var(--gray-200);
        border-radius: 6px;
        padding: 12px;
        margin-top: 8px;
        font-size: var(--text-sm);
        color: var(--gray-700);
        display: flex;
        align-items: start;
        gap: 8px;
    }
    
    .suggestion-icon {
        color: var(--accent-teal);
        flex-shrink: 0;
        margin-top: 2px;
    }
    
    .suggestion-text {
        flex: 1;
    }
    
    .suggestion-actions {
        display: flex;
        gap: 8px;
        margin-top: 8px;
    }
    
    .suggestion-btn {
        padding: 4px 12px;
        border-radius: 4px;
        font-size: var(--text-xs);
        font-weight: var(--font-medium);
        border: 1px solid var(--gray-300);
        background: white;
        color: var(--gray-700);
        cursor: pointer;
        transition: all 0.2s ease;
    }
    
    .suggestion-btn:hover {
        background: var(--gray-50);
        border-color: var(--gray-400);
    }
    
    .suggestion-btn.primary {
        background: var(--accent-teal);
        border-color: var(--accent-teal);
        color: white;
    }
    
    .suggestion-btn.primary:hover {
        background: var(--accent-teal-dark);
        border-color: var(--accent-teal-dark);
    }
    
    /* „Ç¢„ÇØ„Ç∑„Éß„É≥„Éê„Éº */
    .action-bar {
        position: sticky;
        bottom: 0;
        background: white;
        border-top: 1px solid var(--gray-200);
        padding: 16px 32px;
        margin: 0 -32px -32px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 16px;
        z-index: 10;
        box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.05);
    }
    
    .action-info {
        font-size: var(--text-sm);
        color: var(--gray-600);
    }
    
    .action-buttons {
        display: flex;
        gap: 12px;
    }
    
    .btn {
        padding: 10px 20px;
        border-radius: 6px;
        font-size: var(--text-sm);
        font-weight: var(--font-medium);
        cursor: pointer;
        transition: all 0.2s ease;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        border: none;
    }
    
    .btn-secondary {
        background: white;
        border: 1px solid var(--gray-300);
        color: var(--gray-700);
    }
    
    .btn-secondary:hover {
        background: var(--gray-50);
        border-color: var(--gray-400);
    }
    
    .btn-primary {
        background: var(--kagami-blue);
        color: white;
    }
    
    .btn-primary:hover {
        background: var(--kagami-blue-dark);
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }
    
    .btn-success {
        background: var(--accent-teal);
        color: white;
    }
    
    .btn-success:hover {
        background: var(--accent-teal-dark);
        transform: translateY(-1px);
        box-shadow: var(--shadow-md);
    }
    
    /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñË™øÊï¥ */
    @media (max-width: 1024px) {
        .diff-container {
            grid-template-columns: 1fr;
        }
        
        .insight-cards {
            grid-template-columns: 1fr;
        }
    }
    
    /* „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .animate-in {
        animation: slideIn 0.5s ease-out forwards;
    }
</style>
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- „Éö„Éº„Ç∏„Éò„ÉÉ„ÉÄ„Éº -->
    <div class="mb-8">
        <div class="flex items-center justify-between">
            <div>
                <h1 class="text-3xl font-bold text-gray-900 mb-2">AIÊà¶Áï•ÂàÜÊûê„ÉªÁ∑®ÈõÜ</h1>
                <p class="text-gray-600">Ê±∫ÁÆóÁü≠‰ø°„ÉªÈÅ©ÊôÇÈñãÁ§∫„Åã„ÇâÊà¶Áï•„Ç¢„ÉÉ„Éó„Éá„Éº„Éà„ÇíËá™ÂãïÊäΩÂá∫</p>
            </div>
            <a href="/strategy-planning" class="btn btn-secondary">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                </svg>
                Êà¶Áï•ÁÆ°ÁêÜÁîªÈù¢„Å∏Êàª„Çã
            </a>
        </div>
    </div>
    
    <!-- AIÂàÜÊûê„ÉØ„Éº„ÇØ„Éï„É≠„Éº -->
    <div class="ai-analysis-workflow">
        <div class="workflow-steps">
            <div class="workflow-step">
                <div class="step-circle active" id="step1">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                </div>
                <div class="step-label active">„Éá„Éº„Çø„ÇΩ„Éº„ÇπÈÅ∏Êäû</div>
            </div>
            <div class="workflow-step">
                <div class="step-circle" id="step2">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                    </svg>
                </div>
                <div class="step-label">AIÂàÜÊûêÂÆüË°å</div>
            </div>
            <div class="workflow-step">
                <div class="step-circle" id="step3">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                </div>
                <div class="step-label">Â∑ÆÂàÜÁ¢∫Ë™ç</div>
            </div>
            <div class="workflow-step">
                <div class="step-circle" id="step4">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                    </svg>
                </div>
                <div class="step-label">Á∑®ÈõÜ„ÉªÊâøË™ç</div>
            </div>
        </div>
    </div>
    
    <!-- „Çπ„ÉÜ„ÉÉ„Éó1: „Éá„Éº„Çø„ÇΩ„Éº„ÇπÈÅ∏Êäû -->
    <div id="step1-content" class="data-source-selector">
        <h2 class="text-xl font-semibold text-gray-900 mb-4">ÂàÜÊûê„Åô„Çã„Éá„Éº„Çø„ÇΩ„Éº„Çπ„ÇíÈÅ∏Êäû</h2>
        <p class="text-sm text-gray-600 mb-6">„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Çª„É≥„Çø„Éº„Å´„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„Åï„Çå„ÅüÊúÄÊñ∞„ÅÆÈñãÁ§∫Ë≥áÊñô„Åã„ÇâÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ</p>
        
        <div class="source-grid">
            <div class="source-item" onclick="toggleSource(this)" data-source-id="kessan-q3-2024">
                <span class="source-type kessan">Ê±∫ÁÆóÁü≠‰ø°</span>
                <h3 class="source-title">2024Âπ¥3ÊúàÊúü Á¨¨3ÂõõÂçäÊúüÊ±∫ÁÆóÁü≠‰ø°</h3>
                <p class="source-meta">2024/01/22 „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ ‚Ä¢ 45„Éö„Éº„Ç∏ ‚Ä¢ 2.8MB</p>
            </div>
            
            <div class="source-item" onclick="toggleSource(this)" data-source-id="tekiji-strategy-2024">
                <span class="source-type tekiji">ÈÅ©ÊôÇÈñãÁ§∫</span>
                <h3 class="source-title">‰∏≠ÊúüÁµåÂñ∂Ë®àÁîª„ÅÆÈÄ≤Êçó„Å´„Å§„ÅÑ„Å¶</h3>
                <p class="source-meta">2024/01/15 ÈñãÁ§∫ ‚Ä¢ 12„Éö„Éº„Ç∏ ‚Ä¢ 856KB</p>
            </div>
            
            <div class="source-item" onclick="toggleSource(this)" data-source-id="tekiji-overseas-2024">
                <span class="source-type tekiji">ÈÅ©ÊôÇÈñãÁ§∫</span>
                <h3 class="source-title">Êµ∑Â§ñ‰∫ãÊ•≠Â±ïÈñã„Å´Èñ¢„Åô„Çã„ÅäÁü•„Çâ„Åõ</h3>
                <p class="source-meta">2024/01/10 ÈñãÁ§∫ ‚Ä¢ 8„Éö„Éº„Ç∏ ‚Ä¢ 524KB</p>
            </div>
            
            <div class="source-item" onclick="toggleSource(this)" data-source-id="kessan-q2-2024">
                <span class="source-type kessan">Ê±∫ÁÆóÁü≠‰ø°</span>
                <h3 class="source-title">2024Âπ¥3ÊúàÊúü Á¨¨2ÂõõÂçäÊúüÊ±∫ÁÆóÁü≠‰ø°</h3>
                <p class="source-meta">2023/10/25 „Ç¢„ÉÉ„Éó„É≠„Éº„Éâ ‚Ä¢ 42„Éö„Éº„Ç∏ ‚Ä¢ 2.6MB</p>
            </div>
            
            <div class="source-item" onclick="toggleSource(this)" data-source-id="tekiji-dx-2024">
                <span class="source-type tekiji">ÈÅ©ÊôÇÈñãÁ§∫</span>
                <h3 class="source-title">DXÊäïË≥áË®àÁîª„ÅÆÊã°ÂÖÖ„Å´„Å§„ÅÑ„Å¶</h3>
                <p class="source-meta">2024/01/05 ÈñãÁ§∫ ‚Ä¢ 15„Éö„Éº„Ç∏ ‚Ä¢ 1.2MB</p>
            </div>
        </div>
        
        <div class="mt-6 flex justify-between items-center">
            <p class="text-sm text-gray-600">
                <span id="selected-count">0</span>‰ª∂ÈÅ∏Êäû‰∏≠
            </p>
            <button onclick="proceedToAnalysis()" class="btn btn-primary" disabled id="proceed-btn">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                AIÂàÜÊûê„ÇíÈñãÂßã
            </button>
        </div>
    </div>
    
    <!-- „Çπ„ÉÜ„ÉÉ„Éó2: AIÂàÜÊûêÂÆüË°å -->
    <div id="step2-content" class="analysis-process" style="display: none;">
        <div class="process-header">
            <div class="ai-avatar">ü§ñ</div>
            <h2 class="process-title">AIÊà¶Áï•ÂàÜÊûê„ÇíÂÆüË°å‰∏≠</h2>
            <span class="process-status">Âá¶ÁêÜ‰∏≠...</span>
        </div>
        
        <div class="analysis-tasks">
            <div class="task-item" id="task-1">
                <div class="task-icon processing">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                </div>
                <div class="task-content">
                    <div class="task-name">„Éá„Éº„ÇøË™≠„ÅøËæº„Åø„ÉªÂâçÂá¶ÁêÜ</div>
                    <div class="task-description">ÈÅ∏Êäû„Åï„Çå„ÅüË≥áÊñô„Åã„Çâ„ÉÜ„Ç≠„Çπ„Éà„ÇíÊäΩÂá∫„Åó„Å¶„ÅÑ„Åæ„Åô...</div>
                </div>
                <div class="task-progress">
                    <div class="task-progress-bar" style="width: 45%;"></div>
                </div>
            </div>
            
            <div class="task-item" id="task-2">
                <div class="task-icon pending">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                </div>
                <div class="task-content">
                    <div class="task-name">ÂÆöÈáèÁõÆÊ®ô„ÅÆÊäΩÂá∫</div>
                    <div class="task-description">Â£≤‰∏äÈ´ò„ÄÅÂà©ÁõäÁéá„ÄÅ„Åù„ÅÆ‰ªñKPI„ÇíË≠òÂà•‰∏≠...</div>
                </div>
                <div class="task-progress">
                    <div class="task-progress-bar" style="width: 0%;"></div>
                </div>
            </div>
            
            <div class="task-item" id="task-3">
                <div class="task-icon pending">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
                    </svg>
                </div>
                <div class="task-content">
                    <div class="task-name">ÈáçÁÇπÊñΩÁ≠ñ„ÅÆÁâπÂÆö</div>
                    <div class="task-description">Êà¶Áï•ÁöÑÂèñ„ÇäÁµÑ„Åø„Å®Êñ∞Ë¶èÊñΩÁ≠ñ„ÇíÂàÜÈ°û‰∏≠...</div>
                </div>
                <div class="task-progress">
                    <div class="task-progress-bar" style="width: 0%;"></div>
                </div>
            </div>
            
            <div class="task-item" id="task-4">
                <div class="task-icon pending">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
                    </svg>
                </div>
                <div class="task-content">
                    <div class="task-name">ÂâçÂõû„Å®„ÅÆÂ∑ÆÂàÜÂàÜÊûê</div>
                    <div class="task-description">Â§âÊõ¥ÁÇπ„Å®Êõ¥Êñ∞ÁêÜÁî±„ÇíÊé®Ê∏¨‰∏≠...</div>
                </div>
                <div class="task-progress">
                    <div class="task-progress-bar" style="width: 0%;"></div>
                </div>
            </div>
        </div>
        
        <div class="mt-6 p-4 bg-blue-50 rounded-lg">
            <div class="flex items-center gap-2 text-sm text-blue-700">
                <svg class="w-4 h-4 animate-pulse" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" />
                </svg>
                <span>AI„ÅåÈÅéÂéª„ÅÆÈñãÁ§∫Ë≥áÊñô„Å®ÁÖßÂêà„Åó„Å™„Åå„Çâ„ÄÅÊúÄÈÅ©„Å™Êà¶Áï•Êõ¥Êñ∞Ê°à„ÇíÁîüÊàê„Åó„Å¶„ÅÑ„Åæ„Åô...</span>
            </div>
        </div>
    </div>
    
    <!-- „Çπ„ÉÜ„ÉÉ„Éó3: Â∑ÆÂàÜÁ¢∫Ë™ç -->
    <div id="step3-content" style="display: none;">
        <!-- AI„Ç§„É≥„Çµ„Ç§„Éà -->
        <div class="ai-insights">
            <div class="insights-header">
                <svg class="w-6 h-6 text-accent-teal" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                </svg>
                <h3 class="insights-title">AI„ÅåÊ§úÂá∫„Åó„ÅüÈáçË¶Å„Å™Â§âÊõ¥ÁÇπ</h3>
            </div>
            <div class="insight-cards">
                <div class="insight-card" onclick="applyInsight('overseas')">
                    <span class="insight-type">‰∏äÊñπ‰øÆÊ≠£</span>
                    <p class="insight-content">
                        Êµ∑Â§ñÂ£≤‰∏äÊØîÁéá„ÅÆÁõÆÊ®ô„Åå35%„Åã„Çâ<strong>38%„Å´‰∏äÊñπ‰øÆÊ≠£</strong>„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ
                        „Ç¢„Ç∏„Ç¢Â∏ÇÂ†¥„Åß„ÅÆÊÉ≥ÂÆö‰ª•‰∏ä„ÅÆÊàêÈï∑„ÅåË¶ÅÂõ†„Å®Êé®Ê∏¨„Åï„Çå„Åæ„Åô„ÄÇ
                    </p>
                    <div class="insight-action">
                        Ë©≥Á¥∞„ÇíÁ¢∫Ë™ç
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </div>
                </div>
                
                <div class="insight-card" onclick="applyInsight('dx')">
                    <span class="insight-type">ÊäïË≥áÂ¢óÈ°ç</span>
                    <p class="insight-content">
                        DXÊäïË≥áÈ°ç„Åå300ÂÑÑÂÜÜ„Åã„Çâ<strong>320ÂÑÑÂÜÜ„Å´Â¢óÈ°ç</strong>„ÄÇ
                        AI„Éª„Éá„Éº„ÇøÂàÜÊûêÂü∫Áõ§„ÅÆËøΩÂä†ÊäïË≥á„Åå‰∏ª„Å™Ë¶ÅÂõ†„Åß„Åô„ÄÇ
                    </p>
                    <div class="insight-action">
                        Ë©≥Á¥∞„ÇíÁ¢∫Ë™ç
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </div>
                </div>
                
                <div class="insight-card" onclick="applyInsight('new-initiative')">
                    <span class="insight-type">Êñ∞Ë¶èÊñΩÁ≠ñ</span>
                    <p class="insight-content">
                        <strong>2„Å§„ÅÆÊñ∞Ë¶èÊñΩÁ≠ñ</strong>„ÇíÊ§úÂá∫Ôºö‚ë†AIÈúÄË¶Å‰∫àÊ∏¨„Ç∑„Çπ„ÉÜ„É†Â∞éÂÖ•„ÄÅ
                        ‚ë°Êù±Âçó„Ç¢„Ç∏„Ç¢Áµ±Êã¨‰ºöÁ§æË®≠Á´ãÔºà„Ç∑„É≥„Ç¨„Éù„Éº„É´Ôºâ
                    </p>
                    <div class="insight-action">
                        Ë©≥Á¥∞„ÇíÁ¢∫Ë™ç
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                        </svg>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ÊØîËºÉ„Éì„É•„Éº -->
        <div class="comparison-view">
            <div class="comparison-header">
                <h2 class="text-xl font-semibold text-gray-900">Êà¶Áï•ÁõÆÊ®ô„ÅÆÂ§âÊõ¥Á¢∫Ë™ç</h2>
                <div class="comparison-toggle">
                    <button class="toggle-option active" onclick="switchView('side-by-side')">‰∏¶„Åπ„Å¶Ë°®Á§∫</button>
                    <button class="toggle-option" onclick="switchView('unified')">Áµ±ÂêàË°®Á§∫</button>
                    <button class="toggle-option" onclick="switchView('changes-only')">Â§âÊõ¥„ÅÆ„Åø</button>
                </div>
            </div>
            
            <div class="diff-container">
                <!-- ÂâçÂõû„ÅÆÂÜÖÂÆπ -->
                <div class="diff-column">
                    <div class="diff-header previous">
                        <span>ÂâçÂõû„ÅÆ‰∏≠ÊúüÁµåÂñ∂Ë®àÁîª</span>
                        <span class="text-xs">2023Âπ¥11ÊúàÊõ¥Êñ∞</span>
                    </div>
                    <div class="diff-content">
                        <div class="diff-section">
                            <h3 class="diff-section-title">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                                ÂÆöÈáèÁõÆÊ®ô
                            </h3>
                            <div class="diff-item">
                                <div class="diff-value">35%</div>
                                <div class="diff-label">Êµ∑Â§ñÂ£≤‰∏äÊØîÁéáÔºà2026Âπ¥Â∫¶Ôºâ</div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-value">300ÂÑÑÂÜÜ</div>
                                <div class="diff-label">DXÊäïË≥áÈ°çÔºà3Âπ¥ÈñìÔºâ</div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-value">15.0%</div>
                                <div class="diff-label">Âñ∂Ê•≠Âà©ÁõäÁéáÔºà2026Âπ¥Â∫¶Ôºâ</div>
                            </div>
                        </div>
                        
                        <div class="diff-section">
                            <h3 class="diff-section-title">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                                ÈáçÁÇπÊñΩÁ≠ñ
                            </h3>
                            <div class="diff-item">
                                <div class="diff-label">„Ç¢„Ç∏„Ç¢5„Ç´ÂõΩ„Å∏„ÅÆÂ±ïÈñã</div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-label">Âü∫Âππ„Ç∑„Çπ„ÉÜ„É†Âà∑Êñ∞</div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Êñ∞„Åó„ÅÑÂÜÖÂÆπ -->
                <div class="diff-column">
                    <div class="diff-header current">
                        <span>Êõ¥Êñ∞Âæå„ÅÆ‰∏≠ÊúüÁµåÂñ∂Ë®àÁîª</span>
                        <span class="text-xs">2024Âπ¥1ÊúàÔºàAIÊèêÊ°àÔºâ</span>
                    </div>
                    <div class="diff-content">
                        <div class="diff-section">
                            <h3 class="diff-section-title">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                                </svg>
                                ÂÆöÈáèÁõÆÊ®ô
                            </h3>
                            <div class="diff-item changed">
                                <div class="diff-value">38%</div>
                                <div class="diff-label">Êµ∑Â§ñÂ£≤‰∏äÊØîÁéáÔºà2026Âπ¥Â∫¶Ôºâ</div>
                                <div class="diff-reason">
                                    <svg class="diff-reason-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span>AIÊé®Ê∏¨ÁêÜÁî±Ôºö„Ç¢„Ç∏„Ç¢Â∏ÇÂ†¥„ÅÆÊàêÈï∑Áéá„ÅåÂΩìÂàùÊÉ≥ÂÆö„ÅÆÂπ¥15%„Åã„Çâ22%„Å´‰∏äÊåØ„Çå</span>
                                </div>
                            </div>
                            <div class="diff-item changed">
                                <div class="diff-value">320ÂÑÑÂÜÜ</div>
                                <div class="diff-label">DXÊäïË≥áÈ°çÔºà3Âπ¥ÈñìÔºâ</div>
                                <div class="diff-reason">
                                    <svg class="diff-reason-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                    <span>AIÊé®Ê∏¨ÁêÜÁî±ÔºöAI„Éª„Éá„Éº„ÇøÂàÜÊûêÂü∫Áõ§„Å∏„ÅÆËøΩÂä†ÊäïË≥á20ÂÑÑÂÜÜ„ÅåÊâøË™ç</span>
                                </div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-value">15.0%</div>
                                <div class="diff-label">Âñ∂Ê•≠Âà©ÁõäÁéáÔºà2026Âπ¥Â∫¶Ôºâ</div>
                            </div>
                        </div>
                        
                        <div class="diff-section">
                            <h3 class="diff-section-title">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                                </svg>
                                ÈáçÁÇπÊñΩÁ≠ñ
                            </h3>
                            <div class="diff-item">
                                <div class="diff-label">„Ç¢„Ç∏„Ç¢5„Ç´ÂõΩ„Å∏„ÅÆÂ±ïÈñã</div>
                            </div>
                            <div class="diff-item">
                                <div class="diff-label">Âü∫Âππ„Ç∑„Çπ„ÉÜ„É†Âà∑Êñ∞</div>
                            </div>
                            <div class="diff-item added">
                                <div class="diff-label">AIÈúÄË¶Å‰∫àÊ∏¨„Ç∑„Çπ„ÉÜ„É†Â∞éÂÖ•ÔºàÊñ∞Ë¶èÔºâ</div>
                                <div class="diff-reason">
                                    <svg class="diff-reason-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                    </svg>
                                    <span>2024Âπ¥Q2„Çà„ÇäÂ∞éÂÖ•ÈñãÂßã„ÄÅÂñ∂Ê•≠Âà©ÁõäÁéá0.5ptÊîπÂñÑ„ÇíË¶ãËæº„ÇÄ</span>
                                </div>
                            </div>
                            <div class="diff-item added">
                                <div class="diff-label">Êù±Âçó„Ç¢„Ç∏„Ç¢Áµ±Êã¨‰ºöÁ§æË®≠Á´ãÔºàÊñ∞Ë¶èÔºâ</div>
                                <div class="diff-reason">
                                    <svg class="diff-reason-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                                    </svg>
                                    <span>„Ç∑„É≥„Ç¨„Éù„Éº„É´„Å´2024Âπ¥7ÊúàË®≠Á´ã‰∫àÂÆö„ÄÅÂú∞ÂüüÁµ±Êã¨Ê©üËÉΩ„ÇíÈõÜÁ¥Ñ</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="mt-6 flex justify-end">
            <button onclick="proceedToEdit()" class="btn btn-success">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                Â§âÊõ¥„ÇíÁ¢∫Ë™ç„Åó„Å¶Á∑®ÈõÜ„Å∏ÈÄ≤„ÇÄ
            </button>
        </div>
    </div>
    
    <!-- „Çπ„ÉÜ„ÉÉ„Éó4: Á∑®ÈõÜ„ÉªÊâøË™ç -->
    <div id="step4-content" style="display: none;">
        <div class="edit-section">
            <h2 class="text-xl font-semibold text-gray-900 mb-6">Êà¶Áï•Êõ¥Êñ∞„ÅÆÁ∑®ÈõÜ</h2>
            
            <div class="edit-tabs">
                <button class="edit-tab active" onclick="switchEditTab('quantitative')">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                    ÂÆöÈáèÁõÆÊ®ô
                </button>
                <button class="edit-tab" onclick="switchEditTab('strategies')">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                    </svg>
                    ÈáçÁÇπÊñΩÁ≠ñ
                </button>
                <button class="edit-tab" onclick="switchEditTab('reasons')">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                    </svg>
                    Â§âÊõ¥ÁêÜÁî±
                </button>
            </div>
            
            <!-- ÂÆöÈáèÁõÆÊ®ô„Çø„Éñ -->
            <div id="tab-quantitative" class="edit-form">
                <div class="form-group">
                    <label class="form-label">
                        Êµ∑Â§ñÂ£≤‰∏äÊØîÁéáÔºà2026Âπ¥Â∫¶ÁõÆÊ®ôÔºâ
                        <span class="required">*</span>
                    </label>
                    <input type="text" class="form-input ai-suggested" value="38%" id="overseas-ratio">
                    <div class="ai-suggestion-box">
                        <svg class="suggestion-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <div>
                            <div class="suggestion-text">
                                AI„Åå„Ç¢„Ç∏„Ç¢Â∏ÇÂ†¥„ÅÆÊàêÈï∑„Éà„É¨„É≥„Éâ„ÇíÂàÜÊûê„Åó„ÅüÁµêÊûú„ÄÅ38%„Å∏„ÅÆ‰∏äÊñπ‰øÆÊ≠£„ÇíÊé®Â•®„Åó„Åæ„Åô„ÄÇ
                                Áâπ„Å´„Ç§„É≥„Éâ„Éç„Ç∑„Ç¢„Éª„Éô„Éà„Éä„É†„Åß„ÅÆÈúÄË¶ÅÊã°Â§ß„ÅåÈ°ïËëó„Åß„Åô„ÄÇ
                            </div>
                            <div class="suggestion-actions">
                                <button class="suggestion-btn primary" onclick="acceptSuggestion('overseas-ratio')">Êé°Áî®</button>
                                <button class="suggestion-btn" onclick="rejectSuggestion('overseas-ratio')">ÂÖÉ„ÅÆÂÄ§Ôºà35%Ôºâ„Å´Êàª„Åô</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        DXÊäïË≥áÈ°çÔºà3Âπ¥ÈñìÔºâ
                        <span class="required">*</span>
                    </label>
                    <input type="text" class="form-input ai-suggested" value="320ÂÑÑÂÜÜ" id="dx-investment">
                    <div class="ai-suggestion-box">
                        <svg class="suggestion-icon w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
                        </svg>
                        <div>
                            <div class="suggestion-text">
                                AI„Éª„Éá„Éº„ÇøÂàÜÊûêÂü∫Áõ§„Å∏„ÅÆËøΩÂä†ÊäïË≥á20ÂÑÑÂÜÜ„ÅåÈÅ©ÊôÇÈñãÁ§∫„ÅßÁô∫Ë°®„Åï„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ
                                „Åì„Çå„Å´„Çà„ÇäÁ´∂ÂêàÂÑ™‰ΩçÊÄß„ÅÆÁ¢∫‰øù„ÅåÊúüÂæÖ„Åï„Çå„Åæ„Åô„ÄÇ
                            </div>
                            <div class="suggestion-actions">
                                <button class="suggestion-btn primary" onclick="acceptSuggestion('dx-investment')">Êé°Áî®</button>
                                <button class="suggestion-btn" onclick="viewDetails('dx-breakdown')">ÂÜÖË®≥„ÇíÁ¢∫Ë™ç</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        Âñ∂Ê•≠Âà©ÁõäÁéáÔºà2026Âπ¥Â∫¶ÁõÆÊ®ôÔºâ
                        <span class="required">*</span>
                    </label>
                    <input type="text" class="form-input" value="15.0%" id="operating-margin">
                </div>
            </div>
            
            <!-- ÈáçÁÇπÊñΩÁ≠ñ„Çø„Éñ -->
            <div id="tab-strategies" class="edit-form" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Êó¢Â≠òÊñΩÁ≠ñ</label>
                    <div class="space-y-2">
                        <div class="flex items-center gap-2">
                            <input type="checkbox" checked id="strategy-1">
                            <label for="strategy-1">„Ç¢„Ç∏„Ç¢5„Ç´ÂõΩ„Å∏„ÅÆÂ±ïÈñã</label>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="checkbox" checked id="strategy-2">
                            <label for="strategy-2">Âü∫Âππ„Ç∑„Çπ„ÉÜ„É†Âà∑Êñ∞</label>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        Êñ∞Ë¶èÊñΩÁ≠ñ‚ë†
                        <span class="text-xs text-accent-teal ml-2">AI„ÅåÊäΩÂá∫</span>
                    </label>
                    <input type="text" class="form-input ai-suggested" value="AIÈúÄË¶Å‰∫àÊ∏¨„Ç∑„Çπ„ÉÜ„É†Â∞éÂÖ•">
                    <textarea class="form-textarea mt-2" placeholder="Ë©≥Á¥∞Ë™¨Êòé">2024Âπ¥Q2„Çà„ÇäÊÆµÈöéÁöÑ„Å´Â∞éÂÖ•„ÄÇÂú®Â∫´ÊúÄÈÅ©Âåñ„Å´„Çà„ÇäÂñ∂Ê•≠Âà©ÁõäÁéá0.5ptÊîπÂñÑ„ÇíË¶ãËæº„ÇÄ„ÄÇÂàùÊúüÊäïË≥áÈ°ç„ÅØ15ÂÑÑÂÜÜ„ÄÅÂπ¥ÈñìÈÅãÁî®„Ç≥„Çπ„Éà2ÂÑÑÂÜÜ„ÇíÊÉ≥ÂÆö„ÄÇ</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        Êñ∞Ë¶èÊñΩÁ≠ñ‚ë°
                        <span class="text-xs text-accent-teal ml-2">AI„ÅåÊäΩÂá∫</span>
                    </label>
                    <input type="text" class="form-input ai-suggested" value="Êù±Âçó„Ç¢„Ç∏„Ç¢Áµ±Êã¨‰ºöÁ§æË®≠Á´ã">
                    <textarea class="form-textarea mt-2" placeholder="Ë©≥Á¥∞Ë™¨Êòé">„Ç∑„É≥„Ç¨„Éù„Éº„É´„Å´Âú∞ÂüüÁµ±Êã¨Ê©üËÉΩ„ÇíÈõÜÁ¥Ñ„ÄÇ2024Âπ¥7ÊúàË®≠Á´ã‰∫àÂÆö„ÄÇÁèæÂú∞Ê≥ï‰∫∫5Á§æ„ÇíÁµ±Êã¨„Åó„ÄÅÊÑèÊÄùÊ±∫ÂÆö„Çπ„Éî„Éº„Éâ„ÇíÂêë‰∏ä„ÄÇÊäïË≥áÈ°ç50ÂÑÑÂÜÜ„ÄÇ</textarea>
                </div>
            </div>
            
            <!-- Â§âÊõ¥ÁêÜÁî±„Çø„Éñ -->
            <div id="tab-reasons" class="edit-form" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Êµ∑Â§ñÂ£≤‰∏äÊØîÁéá‰∏äÊñπ‰øÆÊ≠£„ÅÆÁêÜÁî±</label>
                    <textarea class="form-textarea" rows="4">„Ç¢„Ç∏„Ç¢Â∏ÇÂ†¥„ÄÅÁâπ„Å´„Ç§„É≥„Éâ„Éç„Ç∑„Ç¢„Éª„Éô„Éà„Éä„É†„Å´„Åä„Åë„ÇãÈúÄË¶Å„ÅåÊÉ≥ÂÆö„Çí‰∏äÂõû„Çã„Éö„Éº„Çπ„ÅßÊã°Â§ß„ÄÇÁèæÂú∞„Éë„Éº„Éà„Éä„Éº„Å®„ÅÆÊèêÊê∫„ÇÇÈ†ÜË™ø„Å´ÈÄ≤Â±ï„Åó„ÄÅ2023Âπ¥Â∫¶„ÅÆÊµ∑Â§ñÂ£≤‰∏äÈ´ò„ÅåÂâçÂπ¥ÊØî+28%„Å®Â§ßÂπÖ„Å´ÊàêÈï∑„Åó„Åü„Åì„Å®„ÇíË∏è„Åæ„Åà„ÄÅÁõÆÊ®ô„Çí35%„Åã„Çâ38%„Å´‰∏äÊñπ‰øÆÊ≠£„ÄÇ</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">DXÊäïË≥áÂ¢óÈ°ç„ÅÆÁêÜÁî±</label>
                    <textarea class="form-textarea" rows="4">Á´∂Âêà‰ªñÁ§æ„ÅÆ„Éá„Ç∏„Çø„É´ÂåñÈÄ≤Â±ï„Å´ÂØæÂøú„Åó„ÄÅÁ´∂‰∫âÂÑ™‰ΩçÊÄß„ÇíÁ¢∫‰øù„Åô„Çã„Åü„ÇÅ„ÄÅAI„Éª„Éá„Éº„ÇøÂàÜÊûêÂü∫Áõ§„Å∏„ÅÆÊäïË≥á„ÇíËøΩÂä†„ÄÇÁâπ„Å´ÈúÄË¶Å‰∫àÊ∏¨Á≤æÂ∫¶„ÅÆÂêë‰∏ä„Å®„Çµ„Éó„É©„Ç§„ÉÅ„Çß„Éº„É≥ÊúÄÈÅ©Âåñ„Å´„Çà„Çä„ÄÅÂèéÁõäÊÄßÊîπÂñÑ„ÇíÂä†ÈÄü„Åï„Åõ„Çã„ÄÇÂèñÁ∑†ÂΩπ‰ºö„Å´„Å¶20ÂÑÑÂÜÜ„ÅÆËøΩÂä†ÊäïË≥á„ÇíÊâøË™çÔºà2024Âπ¥1ÊúàÔºâ„ÄÇ</textarea>
                </div>
                
                <div class="form-group">
                    <label class="form-label">ÊäïË≥áÂÆ∂Âêë„ÅëË™¨Êòé„Éù„Ç§„É≥„Éà</label>
                    <textarea class="form-textarea" rows="4">1. Êµ∑Â§ñÂ±ïÈñã„ÅÆÂä†ÈÄü„ÅØ„ÄÅÂõΩÂÜÖÂ∏ÇÂ†¥„ÅÆÊàêÁÜüÂåñ„É™„Çπ„ÇØ„Å∏„ÅÆÂØæÂøúÁ≠ñ
2. DXÊäïË≥á„ÅØÁü≠ÊúüÁöÑ„Å™„Ç≥„Çπ„ÉàÂ¢ó„Å®„Å™„Çã„Åå„ÄÅ‰∏≠Èï∑ÊúüÁöÑ„Å™ROIÊîπÂñÑ„Å´ÂØÑ‰∏é
3. Êñ∞Ë¶èÊñΩÁ≠ñ„ÅØ„ÅÑ„Åö„Çå„ÇÇÊó¢Â≠ò‰∫ãÊ•≠„Å®„ÅÆ„Ç∑„Éä„Ç∏„Éº„ÅåÈ´ò„Åè„ÄÅÂÆüÁèæÂèØËÉΩÊÄß„ÇíÁ≤æÊüªÊ∏à„Åø</textarea>
                </div>
            </div>
            
            <!-- „Ç¢„ÇØ„Ç∑„Éß„É≥„Éê„Éº -->
            <div class="action-bar">
                <div class="action-info">
                    <span class="text-sm text-gray-500">ÊúÄÁµÇÊõ¥Êñ∞Ôºö</span>
                    <span class="text-sm font-medium">2024Âπ¥1Êúà22Êó• 14:35ÔºàAIÂàÜÊûêÔºâ</span>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="saveDraft()">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4" />
                        </svg>
                        ‰∏ãÊõ∏„Åç‰øùÂ≠ò
                    </button>
                    <button class="btn btn-primary" onclick="submitForApproval()">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        ÊâøË™çÁî≥Ë´ã
                    </button>
                    <button class="btn btn-success" onclick="applyToStrategy()">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        Êà¶Áï•Ë®àÁîª„Å´ÈÅ©Áî®
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞
    let selectedSources = [];
    let currentStep = 1;
    let analysisInterval;
    
    // „Éá„Éº„Çø„ÇΩ„Éº„ÇπÈÅ∏Êäû
    function toggleSource(element) {
        element.classList.toggle('selected');
        const sourceId = element.getAttribute('data-source-id');
        
        if (element.classList.contains('selected')) {
            selectedSources.push(sourceId);
        } else {
            selectedSources = selectedSources.filter(id => id !== sourceId);
        }
        
        updateSelectedCount();
    }
    
    function updateSelectedCount() {
        document.getElementById('selected-count').textContent = selectedSources.length;
        const proceedBtn = document.getElementById('proceed-btn');
        
        if (selectedSources.length > 0) {
            proceedBtn.disabled = false;
            proceedBtn.classList.add('hover:bg-kagami-blue-dark');
        } else {
            proceedBtn.disabled = true;
            proceedBtn.classList.remove('hover:bg-kagami-blue-dark');
        }
    }
    
    // ÂàÜÊûêÈñãÂßã
    function proceedToAnalysis() {
        if (selectedSources.length === 0) {
            showNotification('„Éá„Éº„Çø„ÇΩ„Éº„Çπ„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ', 'warning');
            return;
        }
        
        // „Çπ„ÉÜ„ÉÉ„Éó2„Å∏ÁßªË°å
        moveToStep(2);
        
        // ÂàÜÊûê„Éó„É≠„Çª„Çπ„ÅÆ„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
        simulateAnalysis();
    }
    
    // „Çπ„ÉÜ„ÉÉ„ÉóÈÅ∑Áßª
    function moveToStep(step) {
        // Ââç„ÅÆ„Çπ„ÉÜ„ÉÉ„Éó„ÇíÈùûË°®Á§∫
        document.getElementById(`step${currentStep}-content`).style.display = 'none';
        
        // Êñ∞„Åó„ÅÑ„Çπ„ÉÜ„ÉÉ„Éó„ÇíË°®Á§∫
        document.getElementById(`step${step}-content`).style.display = 'block';
        
        // „Çπ„ÉÜ„ÉÉ„Éó„Ç§„É≥„Ç∏„Ç±„Éº„Çø„Éº„ÇíÊõ¥Êñ∞
        updateStepIndicators(step);
        
        currentStep = step;
        
        // „Çπ„ÇØ„É≠„Éº„É´
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    
    // „Çπ„ÉÜ„ÉÉ„Éó„Ç§„É≥„Ç∏„Ç±„Éº„Çø„ÉºÊõ¥Êñ∞
    function updateStepIndicators(activeStep) {
        for (let i = 1; i <= 4; i++) {
            const circle = document.getElementById(`step${i}`);
            const label = circle.nextElementSibling;
            
            circle.classList.remove('active', 'completed');
            label.classList.remove('active');
            
            if (i < activeStep) {
                circle.classList.add('completed');
                circle.innerHTML = `
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                    </svg>
                `;
            } else if (i === activeStep) {
                circle.classList.add('active');
                label.classList.add('active');
            }
        }
    }
    
    // AIÂàÜÊûê„Ç∑„Éü„É•„É¨„Éº„Ç∑„Éß„É≥
    function simulateAnalysis() {
        const tasks = [
            { id: 'task-1', duration: 2000 },
            { id: 'task-2', duration: 2500 },
            { id: 'task-3', duration: 2000 },
            { id: 'task-4', duration: 3000 }
        ];
        
        let currentTask = 0;
        
        function processTask() {
            if (currentTask < tasks.length) {
                const task = tasks[currentTask];
                const taskElement = document.getElementById(task.id);
                const icon = taskElement.querySelector('.task-icon');
                const progressBar = taskElement.querySelector('.task-progress-bar');
                
                // „Çø„Çπ„ÇØ„ÇíÂá¶ÁêÜ‰∏≠„Å´Â§âÊõ¥
                icon.classList.remove('pending');
                icon.classList.add('processing');
                taskElement.classList.add('processing');
                
                // „Éó„É≠„Ç∞„É¨„Çπ„Éê„Éº„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += 5;
                    progressBar.style.width = `${progress}%`;
                    
                    if (progress >= 100) {
                        clearInterval(progressInterval);
                        
                        // „Çø„Çπ„ÇØÂÆå‰∫Ü
                        icon.classList.remove('processing');
                        icon.classList.add('completed');
                        icon.innerHTML = `
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                            </svg>
                        `;
                        taskElement.classList.remove('processing');
                        taskElement.classList.add('completed');
                        
                        currentTask++;
                        
                        if (currentTask < tasks.length) {
                            setTimeout(processTask, 500);
                        } else {
                            // „Åô„Åπ„Å¶„ÅÆ„Çø„Çπ„ÇØ„ÅåÂÆå‰∫Ü
                            setTimeout(() => {
                                showNotification('AIÂàÜÊûê„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü', 'success');
                                moveToStep(3);
                            }, 1000);
                        }
                    }
                }, task.duration / 20);
            }
        }
        
        processTask();
    }
    
    // Á∑®ÈõÜ„Å∏ÈÄ≤„ÇÄ
    function proceedToEdit() {
        moveToStep(4);
    }
    
    // „Éì„É•„ÉºÂàá„ÇäÊõø„Åà
    function switchView(view) {
        const buttons = document.querySelectorAll('.toggle-option');
        buttons.forEach(btn => {
            btn.classList.remove('active');
            if (btn.getAttribute('onclick').includes(view)) {
                btn.classList.add('active');
            }
        });
        
        // „Éì„É•„Éº„Å´Âøú„Åò„ÅüË°®Á§∫Âàá„ÇäÊõø„ÅàÔºàÂÆüË£Ö„ÅØÁúÅÁï•Ôºâ
        showNotification(`${view}„Éì„É•„Éº„Å´Âàá„ÇäÊõø„Åà„Åæ„Åó„Åü`, 'info');
    }
    
    // Á∑®ÈõÜ„Çø„ÉñÂàá„ÇäÊõø„Åà
    function switchEditTab(tab) {
        // „Çø„Éñ„Éú„Çø„É≥„ÅÆÊõ¥Êñ∞
        const tabs = document.querySelectorAll('.edit-tab');
        tabs.forEach(t => t.classList.remove('active'));
        event.target.closest('.edit-tab').classList.add('active');
        
        // „Ç≥„É≥„ÉÜ„É≥„ÉÑ„ÅÆË°®Á§∫Âàá„ÇäÊõø„Åà
        document.querySelectorAll('[id^="tab-"]').forEach(content => {
            content.style.display = 'none';
        });
        document.getElementById(`tab-${tab}`).style.display = 'grid';
    }
    
    // AIÊèêÊ°à„ÅÆÊé°Áî®
    function acceptSuggestion(field) {
        showNotification('AIÊèêÊ°à„ÇíÊé°Áî®„Åó„Åæ„Åó„Åü', 'success');
        document.getElementById(field).classList.add('animate-in');
    }
    
    // AIÊèêÊ°à„ÅÆÂç¥‰∏ã
    function rejectSuggestion(field) {
        if (field === 'overseas-ratio') {
            document.getElementById(field).value = '35%';
        } else if (field === 'dx-investment') {
            document.getElementById(field).value = '300ÂÑÑÂÜÜ';
        }
        showNotification('ÂÖÉ„ÅÆÂÄ§„Å´Êàª„Åó„Åæ„Åó„Åü', 'info');
    }
    
    // Ë©≥Á¥∞Ë°®Á§∫
    function viewDetails(type) {
        showModal({
            title: 'DXÊäïË≥áÂÜÖË®≥',
            content: `
                <div class="space-y-4">
                    <h4 class="font-semibold text-gray-900">ÊäïË≥áÈ°çÂÜÖË®≥ÔºàÁ∑èÈ°ç320ÂÑÑÂÜÜÔºâ</h4>
                    <div class="space-y-2">
                        <div class="flex justify-between py-2 border-b">
                            <span>Âü∫Âππ„Ç∑„Çπ„ÉÜ„É†Âà∑Êñ∞</span>
                            <span class="font-medium">180ÂÑÑÂÜÜ</span>
                        </div>
                        <div class="flex justify-between py-2 border-b">
                            <span>AI„Éª„Éá„Éº„ÇøÂàÜÊûêÂü∫Áõ§ÔºàËøΩÂä†Ôºâ</span>
                            <span class="font-medium text-accent-teal">80ÂÑÑÂÜÜ</span>
                        </div>
                        <div class="flex justify-between py-2 border-b">
                            <span>„ÇØ„É©„Ç¶„ÉâÁßªË°å</span>
                            <span class="font-medium">40ÂÑÑÂÜÜ</span>
                        </div>
                        <div class="flex justify-between py-2">
                            <span>„Çª„Ç≠„É•„É™„ÉÜ„Ç£Âº∑Âåñ</span>
                            <span class="font-medium">20ÂÑÑÂÜÜ</span>
                        </div>
                    </div>
                </div>
            `,
            confirmText: 'Á¢∫Ë™ç',
            showCancel: false
        });
    }
    
    // „Ç§„É≥„Çµ„Ç§„ÉàÈÅ©Áî®
    function applyInsight(type) {
        // Ë©≤ÂΩì„Åô„ÇãÂ∑ÆÂàÜ„Å´„Çπ„ÇØ„É≠„Éº„É´
        const targetElement = document.querySelector(`.diff-item.changed, .diff-item.added`);
        if (targetElement) {
            targetElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
            targetElement.classList.add('animate-in');
        }
    }
    
    // ‰∏ãÊõ∏„Åç‰øùÂ≠ò
    function saveDraft() {
        showNotification('‰∏ãÊõ∏„Åç„Çí‰øùÂ≠ò„Åó„Åæ„Åó„Åü', 'success');
    }
    
    // ÊâøË™çÁî≥Ë´ã
    function submitForApproval() {
        showModal({
            title: 'ÊâøË™çÁî≥Ë´ã„ÅÆÁ¢∫Ë™ç',
            content: `
                <div class="space-y-4">
                    <p class="text-gray-600">‰ª•‰∏ã„ÅÆÂ§âÊõ¥ÂÜÖÂÆπ„ÅßÊâøË™çÁî≥Ë´ã„ÇíË°å„ÅÑ„Åæ„Åô„ÄÇ</p>
                    
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-900 mb-2">‰∏ª„Å™Â§âÊõ¥ÁÇπ</h4>
                        <ul class="space-y-1 text-sm text-gray-700">
                            <li>‚Ä¢ Êµ∑Â§ñÂ£≤‰∏äÊØîÁéáÔºö35% ‚Üí 38%</li>
                            <li>‚Ä¢ DXÊäïË≥áÈ°çÔºö300ÂÑÑÂÜÜ ‚Üí 320ÂÑÑÂÜÜ</li>
                            <li>‚Ä¢ Êñ∞Ë¶èÊñΩÁ≠ñÔºöAIÈúÄË¶Å‰∫àÊ∏¨„Ç∑„Çπ„ÉÜ„É†„ÄÅÊù±Âçó„Ç¢„Ç∏„Ç¢Áµ±Êã¨‰ºöÁ§æ</li>
                        </ul>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ÊâøË™çËÄÖ</label>
                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option>CFO - Â±±Áî∞Â§™ÈÉé</option>
                            <option>CEO - ‰ΩêËó§Ëä±Â≠ê</option>
                            <option>ÂèñÁ∑†ÂΩπ‰ºö</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">„Ç≥„É°„É≥„ÉàÔºà‰ªªÊÑèÔºâ</label>
                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg" rows="3"
                            placeholder="ÊâøË™çËÄÖ„Å∏„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏"></textarea>
                    </div>
                </div>
            `,
            confirmText: 'Áî≥Ë´ã„Åô„Çã',
            onConfirm: () => {
                showNotification('ÊâøË™çÁî≥Ë´ã„ÇíÈÄÅ‰ø°„Åó„Åæ„Åó„Åü', 'success');
            }
        });
    }
    
    // Êà¶Áï•Ë®àÁîª„Å´ÈÅ©Áî®
    function applyToStrategy() {
        showModal({
            title: 'Êà¶Áï•Ë®àÁîª„Å∏„ÅÆÈÅ©Áî®Á¢∫Ë™ç',
            content: `
                <div class="space-y-4">
                    <p class="text-gray-600">
                        AIÂàÜÊûêÁµêÊûú„Çí‰∏≠ÊúüÁµåÂñ∂Ë®àÁîª„Å´ÈÅ©Áî®„Åó„Åæ„Åô„ÄÇ
                        „Åì„ÅÆÊìç‰Ωú„Å´„Çà„Çä„ÄÅÊäïË≥áÂÆ∂Âêë„Åë„Éö„Éº„Ç∏„ÇÇËá™ÂãïÊõ¥Êñ∞„Åï„Çå„Åæ„Åô„ÄÇ
                    </p>
                    
                    <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div class="flex items-start gap-2">
                            <svg class="w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                            <div class="text-sm text-yellow-800">
                                <p class="font-medium mb-1">ÈáçË¶Å</p>
                                <p>ÈÅ©Áî®Âæå„ÅØÈñ¢ÈÄ£„Åô„ÇãÊäïË≥áÂÆ∂„Å∏„ÅÆÈÄöÁü•„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="space-y-2">
                        <label class="flex items-center">
                            <input type="checkbox" checked class="mr-2">
                            <span class="text-sm">Èñ¢ÈÄ£„Åô„ÇãÊäïË≥áÂÆ∂„Å∏Êõ¥Êñ∞ÈÄöÁü•„ÇíÈÄÅ‰ø°</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" checked class="mr-2">
                            <span class="text-sm">FAQ„ÇíËá™ÂãïÁîüÊàê„Åó„Å¶ÂÖ¨Èñã</span>
                        </label>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">
                            <span class="text-sm">Ê±∫ÁÆóË™¨Êòé‰ºö„Åß‰ΩøÁî®„Åô„ÇãË≥áÊñô„ÇíÊõ¥Êñ∞</span>
                        </label>
                    </div>
                </div>
            `,
            confirmText: 'ÈÅ©Áî®„Åô„Çã',
            onConfirm: () => {
                showNotification('Êà¶Áï•Ë®àÁîª„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü', 'success');
                setTimeout(() => {
                    window.location.href = '/strategy-planning';
                }, 2000);
            }
        });
    }
    
    // ÈÄöÁü•Ë°®Á§∫ÔºàÊó¢Â≠ò„ÅÆ„Ç∑„Çπ„ÉÜ„É†„Å®Áµ±ÂêàÔºâ
    function showNotification(message, type = 'info') {
        // Êó¢Â≠ò„ÅÆnotifications.js„Çí‰ΩøÁî®
        if (typeof window.showNotification === 'function') {
            window.showNotification(message, type);
        } else {
            console.log(`${type}: ${message}`);
        }
    }
    
    // „É¢„Éº„ÉÄ„É´Ë°®Á§∫ÔºàÊó¢Â≠ò„ÅÆ„Ç∑„Çπ„ÉÜ„É†„Å®Áµ±ÂêàÔºâ
    function showModal(options) {
        // Êó¢Â≠ò„ÅÆmodals.js„Çí‰ΩøÁî®
        if (typeof window.showModal === 'function') {
            window.showModal(options);
        } else {
            if (confirm(options.content)) {
                options.onConfirm && options.onConfirm();
            }
        }
    }
    
    // „Éö„Éº„Ç∏Ë™≠„ÅøËæº„ÅøÊôÇ„ÅÆÂàùÊúüÂåñ
    document.addEventListener('DOMContentLoaded', function() {
        // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÈÅ©Áî®
        document.querySelectorAll('.animate-in').forEach((el, index) => {
            el.style.animationDelay = `${index * 0.1}s`;
        });
    });
</script>
{% endblock %}