{% extends "base.html" %}

{% block title %}è­°äº‹éŒ²ç·¨é›† - çµ±åˆç·¨é›†ã‚·ã‚¹ãƒ†ãƒ {% endblock %}

{% block extra_css %}
<style>
/* çµ±åˆè­°äº‹éŒ²ç·¨é›†ã‚·ã‚¹ãƒ†ãƒ å°‚ç”¨ã‚¹ã‚¿ã‚¤ãƒ« */
.unified-editor-container {
    display: flex;
    height: calc(100vh - 4rem);
    margin: -1.5rem;
}

/* ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³é€²æ—ãƒãƒ¼ */
.pipeline-progress {
    background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
    color: white;
    padding: 1.5rem;
    position: sticky;
    top: 0;
    z-index: 10;
}

.pipeline-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
}

.meeting-info h1 {
    font-size: 1.5rem;
    font-weight: bold;
    margin-bottom: 0.25rem;
}

.meeting-meta {
    display: flex;
    gap: 0.75rem;
    align-items: center;
    font-size: 0.875rem;
    opacity: 0.9;
}

.stages-container {
    display: flex;
    gap: 0.5rem;
    overflow-x: auto;
    padding-bottom: 0.5rem;
}

.stage-item {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 0.75rem 1rem;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 8px;
    min-width: 110px;
    cursor: pointer;
    transition: all 0.2s;
    position: relative;
}

.stage-item:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: translateY(-2px);
}

.stage-item.active {
    background: rgba(34, 197, 94, 0.3);
    box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.5);
}

.stage-item.completed {
    background: rgba(34, 197, 94, 0.2);
}

.stage-icon {
    font-size: 1.5rem;
    margin-bottom: 0.25rem;
}

.stage-label {
    font-size: 0.75rem;
    font-weight: 600;
    text-align: center;
    line-height: 1.2;
}

/* å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
.left-sidebar {
    width: 320px;
    background: #f9fafb;
    border-right: 1px solid #e5e7eb;
    padding: 1.5rem;
    overflow-y: auto;
}

.investor-profile {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.investor-avatar {
    width: 56px;
    height: 56px;
    background: linear-gradient(135deg, #3b82f6, #1d4ed8);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    font-size: 1.5rem;
}

.investor-stats {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 1rem;
    margin-bottom: 2rem;
}

.stat-item {
    text-align: center;
    padding: 1rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.stat-value {
    font-size: 1.5rem;
    font-weight: bold;
    color: #1f2937;
}

.stat-label {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 0.25rem;
}

/* ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ */
.main-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

.work-area {
    flex: 1;
    padding: 1.5rem;
    overflow-y: auto;
    background: white;
}

.work-area-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
    padding: 1.5rem;
    background: #f8fafc;
    border-radius: 12px;
    border: 1px solid #e2e8f0;
}

/* å³ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
.right-sidebar {
    width: 320px;
    background: #f9fafb;
    border-left: 1px solid #e5e7eb;
    padding: 1.5rem;
    overflow-y: auto;
}

/* ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢ */
.upload-area {
    border: 2px dashed #cbd5e1;
    border-radius: 12px;
    padding: 3rem;
    text-align: center;
    background: #f8fafc;
    transition: all 0.3s;
}

.upload-area:hover {
    border-color: #3b82f6;
    background: #eff6ff;
}

.upload-area.drag-over {
    border-color: #3b82f6;
    background: #dbeafe;
}

/* æ–‡å­—èµ·ã“ã—ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ */
.transcription-editor {
    background: white;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.editor-toolbar {
    padding: 1rem;
    border-bottom: 1px solid #e5e7eb;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.transcript-text {
    padding: 1.5rem;
    min-height: 400px;
    max-height: 600px;
    overflow-y: auto;
}

#transcriptEditor {
    outline: none;
    line-height: 1.8;
}

#transcriptEditor p {
    margin-bottom: 1rem;
}

.uncertain {
    background: #fef3c7;
    padding: 0.125rem 0.25rem;
    border-radius: 4px;
}

/* AIææ¡ˆ */
.ai-suggestion {
    background: #f0f9ff;
    border: 1px solid #0ea5e9;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
}

.suggestion-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 0.75rem;
}

.confidence-badge {
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
    background: rgba(14, 165, 233, 0.1);
    color: #0c4a6e;
    border-radius: 4px;
}
</style>
{% endblock %}

{% block content %}
<div class="unified-editor-container">
    <!-- å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼šæŠ•è³‡å®¶æƒ…å ± -->
    <div class="left-sidebar">
        <div class="investor-profile">
            <div class="investor-avatar">é‡</div>
            <div>
                <h4 class="font-semibold text-gray-900">é‡æ‘ã‚¢ã‚»ãƒƒãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ</h4>
                <p class="text-sm text-gray-600">æ©Ÿé–¢æŠ•è³‡å®¶</p>
            </div>
        </div>

        <div class="investor-stats">
            <div class="stat-item">
                <div class="stat-value">12</div>
                <div class="stat-label">ç·é¢è«‡å›æ•°</div>
            </div>
            <div class="stat-item">
                <div class="stat-value">8.5</div>
                <div class="stat-label">æº€è¶³åº¦</div>
            </div>
        </div>

        <div class="mb-6">
            <h3 class="font-semibold text-gray-900 mb-3">ğŸ“‹ éå»é¢è«‡å±¥æ­´</h3>
            <div class="space-y-2">
                <div class="p-3 bg-white rounded-lg cursor-pointer hover:shadow-md transition-shadow">
                    <div class="text-xs text-gray-500 mb-1">2023-10-15</div>
                    <div class="text-sm font-medium text-gray-900">Q2æ±ºç®—èª¬æ˜ã€ESGæˆ¦ç•¥</div>
                    <div class="text-xs text-green-600">æº€è¶³åº¦: 8.2</div>
                </div>
                <div class="p-3 bg-white rounded-lg cursor-pointer hover:shadow-md transition-shadow">
                    <div class="text-xs text-gray-500 mb-1">2023-07-15</div>
                    <div class="text-sm font-medium text-gray-900">ä¸­æœŸçµŒå–¶è¨ˆç”»ã€M&Aæˆ¦ç•¥</div>
                    <div class="text-xs text-green-600">æº€è¶³åº¦: 7.8</div>
                </div>
            </div>
        </div>

        <div>
            <h3 class="font-semibold text-gray-900 mb-3">ğŸ“„ é–¢é€£è³‡æ–™</h3>
            <div class="space-y-2">
                <div class="flex items-center gap-2 p-3 bg-white rounded-lg cursor-pointer hover:shadow-md transition-shadow">
                    <span class="text-xl">ğŸ“Š</span>
                    <span class="text-sm font-medium text-gray-900">Q3æ±ºç®—è³‡æ–™</span>
                </div>
                <div class="flex items-center gap-2 p-3 bg-white rounded-lg cursor-pointer hover:shadow-md transition-shadow">
                    <span class="text-xl">ğŸ“ˆ</span>
                    <span class="text-sm font-medium text-gray-900">ä¸­æœŸçµŒå–¶è¨ˆç”»</span>
                </div>
                <div class="flex items-center gap-2 p-3 bg-white rounded-lg cursor-pointer hover:shadow-md transition-shadow">
                    <span class="text-xl">ğŸŒ±</span>
                    <span class="text-sm font-medium text-gray-900">ESGãƒ¬ãƒãƒ¼ãƒˆ</span>
                </div>
            </div>
        </div>
    </div>

    <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
    <div class="main-content">
        <!-- ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³é€²æ—ãƒãƒ¼ -->
        <div class="pipeline-progress">
            <div class="pipeline-header">
                <div class="meeting-info">
                    <h1>æŠ•è³‡å®¶ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚° 2024/01/22</h1>
                    <div class="meeting-meta">
                        <span>é‡æ‘ã‚¢ã‚»ãƒƒãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ</span>
                        <span>â€¢</span>
                        <span>2024å¹´1æœˆ22æ—¥</span>
                        <span>â€¢</span>
                        <span>æ±ºç®—èª¬æ˜ä¼š</span>
                    </div>
                </div>
                <div class="flex gap-2">
                    <button class="px-4 py-2 bg-white/20 text-white rounded-lg hover:bg-white/30 transition-colors">
                        ğŸ“¤ æ›¸ãå‡ºã—
                    </button>
                </div>
            </div>

            <!-- æ®µéšã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
            <div class="stages-container">
                <div class="stage-item completed" onclick="switchStage('upload')">
                    <div class="stage-icon">ğŸ“¹</div>
                    <div class="stage-label">ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰</div>
                </div>
                <div class="stage-item completed" onclick="switchStage('transcription')">
                    <div class="stage-icon">ğŸ“</div>
                    <div class="stage-label">æ–‡å­—èµ·ã“ã—</div>
                </div>
                <div class="stage-item active" onclick="switchStage('ai_summary')">
                    <div class="stage-icon">ğŸ¤–</div>
                    <div class="stage-label">AIè¦ç´„</div>
                </div>
                <div class="stage-item" onclick="switchStage('faq')">
                    <div class="stage-icon">â“</div>
                    <div class="stage-label">FAQä½œæˆ</div>
                </div>
                <div class="stage-item" onclick="switchStage('review')">
                    <div class="stage-icon">âœ…</div>
                    <div class="stage-label">ãƒ¬ãƒ“ãƒ¥ãƒ¼</div>
                </div>
                <div class="stage-item" onclick="switchStage('publish')">
                    <div class="stage-icon">ğŸŒ</div>
                    <div class="stage-label">å…¬é–‹</div>
                </div>
            </div>
        </div>

        <!-- ãƒ¯ãƒ¼ã‚¯ã‚¨ãƒªã‚¢ -->
        <div class="work-area">
            <div class="work-area-header">
                <div class="flex items-center gap-4">
                    <div class="text-3xl">ğŸ¤–</div>
                    <div>
                        <h3 class="text-xl font-semibold text-gray-900">AIè¦ç´„ãƒ»åˆ†æ</h3>
                        <p class="text-sm text-gray-600">è­°äº‹éŒ²ã®è¦ç´„ã¨é‡è¦ãƒã‚¤ãƒ³ãƒˆã®æŠ½å‡ºã‚’è¡Œã„ã¾ã™</p>
                    </div>
                </div>
                <div class="flex gap-2">
                    <button class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                        ğŸ¤– è¦ç´„ç”Ÿæˆ
                    </button>
                    <button class="px-4 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors">
                        ğŸ¨ èª¿æ•´
                    </button>
                </div>
            </div>

            <!-- AIè¦ç´„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h4 class="font-semibold text-gray-900 mb-4">ğŸ“‹ ä¼šè­°è¦ç´„</h4>
                    <div contenteditable="true" class="prose prose-sm max-w-none">
                        <p><strong>ä¸»è¦è­°é¡Œ:</strong> AIäº‹æ¥­ã®ç«¶äº‰å„ªä½æ€§ã€ESGæˆ¦ç•¥ã®é€²æ—ã€ä»Šå¾Œã®æŠ•è³‡è¨ˆç”»</p>
                        
                        <p><strong>ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒˆ:</strong></p>
                        <ul>
                            <li>AIäº‹æ¥­ã§ã¯æ¥­ç•Œç‰¹åŒ–å‹ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã§ç«¶åˆå„ªä½ã‚’ç¢ºç«‹</li>
                            <li>è£½é€ æ¥­å‘ã‘ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ã§å¸‚å ´ã‚·ã‚§ã‚¢25%ã‚’é”æˆ</li>
                            <li>ESGæŠ•è³‡ã‚’ä»ŠæœŸ20%å¢—é¡ã€ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«ç›®æ¨™ã‚’2030å¹´ã«å‰å€’ã—</li>
                            <li>æ–°è¦è¨­å‚™æŠ•è³‡ã«ã‚ˆã‚Šç”Ÿç”£åŠ¹ç‡ã‚’15%å‘ä¸Šäºˆå®š</li>
                        </ul>
                        
                        <p><strong>æŠ•è³‡å®¶ã®é–¢å¿ƒäº‹é …:</strong></p>
                        <ul>
                            <li>AIäº‹æ¥­ã®åç›Šæ€§ã¨æˆé•·æŒç¶šæ€§</li>
                            <li>å¤§æ‰‹ãƒ†ãƒƒã‚¯ä¼æ¥­ã¨ã®ç«¶äº‰æˆ¦ç•¥</li>
                            <li>ESGæŠ•è³‡ã®ROIæ¸¬å®šæ–¹æ³•</li>
                            <li>æŠ€è¡“è€…æ¡ç”¨è¨ˆç”»ã¨äººæå®šç€ç‡</li>
                        </ul>
                    </div>
                </div>

                <div class="bg-white rounded-lg shadow-sm p-6">
                    <h4 class="font-semibold text-gray-900 mb-4">ğŸ¯ ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚¢ã‚¤ãƒ†ãƒ </h4>
                    <div class="space-y-3">
                        <div class="p-4 bg-red-50 rounded-lg border border-red-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-medium text-gray-900">è¿½åŠ è³‡æ–™ã®æº–å‚™</span>
                                <span class="px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded">å„ªå…ˆåº¦: é«˜</span>
                            </div>
                            <p class="text-sm text-gray-600 mb-1">AIäº‹æ¥­ã®è©³ç´°ãªãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—è³‡æ–™ã‚’æ¬¡å›é¢è«‡ã¾ã§ã«æº–å‚™</p>
                            <p class="text-xs text-gray-500">æœŸé™: 2024-01-25</p>
                        </div>

                        <div class="p-4 bg-yellow-50 rounded-lg border border-yellow-200">
                            <div class="flex items-center justify-between mb-2">
                                <span class="font-medium text-gray-900">ESGæŒ‡æ¨™ã®è©³ç´°èª¬æ˜</span>
                                <span class="px-2 py-1 bg-yellow-100 text-yellow-700 text-xs font-medium rounded">å„ªå…ˆåº¦: ä¸­</span>
                            </div>
                            <p class="text-sm text-gray-600 mb-1">ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«é”æˆã®ãŸã‚ã®å…·ä½“çš„æ–½ç­–ã¨ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³</p>
                            <p class="text-xs text-gray-500">æœŸé™: 2024-01-30</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å³ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼šAIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ -->
    <div class="right-sidebar">
        <h3 class="font-semibold text-gray-900 mb-4">ğŸ¤– AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ</h3>

        <!-- AIææ¡ˆ -->
        <div class="ai-suggestion">
            <div class="suggestion-header">
                <span class="font-medium text-blue-900">ğŸ“ è¦ç´„æ”¹å–„ææ¡ˆ</span>
                <span class="confidence-badge">ä¿¡é ¼åº¦: 94%</span>
            </div>
            <p class="text-sm text-gray-700 mb-3">
                ç«¶åˆä»–ç¤¾ã¨ã®æ¯”è¼ƒæƒ…å ±ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€æŠ•è³‡å®¶ã®ç†è§£ãŒã‚ˆã‚Šæ·±ã¾ã‚Šã¾ã™ã€‚
            </p>
            <div class="flex gap-2">
                <button class="px-3 py-1.5 bg-blue-600 text-white text-sm rounded-lg hover:bg-blue-700">
                    é©ç”¨ã™ã‚‹
                </button>
                <button class="px-3 py-1.5 bg-white text-gray-600 border border-gray-300 text-sm rounded-lg hover:bg-gray-50">
                    ã‚¹ã‚­ãƒƒãƒ—
                </button>
            </div>
        </div>

        <!-- åˆ†æè¨­å®š -->
        <div class="bg-white rounded-lg p-4 mb-4">
            <h4 class="font-medium text-gray-900 mb-3">ğŸ¯ åˆ†æãƒ•ã‚©ãƒ¼ã‚«ã‚¹</h4>
            <div class="space-y-2">
                <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" checked class="rounded text-blue-600">
                    <span>ç«¶åˆå„ªä½æ€§åˆ†æ</span>
                </label>
                <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" checked class="rounded text-blue-600">
                    <span>æŠ•è³‡å®¶é–¢å¿ƒåº¦åˆ†æ</span>
                </label>
                <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" class="rounded text-blue-600">
                    <span>ãƒªã‚¹ã‚¯è¦å› åˆ†æ</span>
                </label>
                <label class="flex items-center gap-2 text-sm">
                    <input type="checkbox" class="rounded text-blue-600">
                    <span>ESGè¦ç´ åˆ†æ</span>
                </label>
            </div>
        </div>

        <!-- åˆ†æçµæœ -->
        <div class="bg-gray-50 rounded-lg p-4">
            <h4 class="font-medium text-gray-900 mb-3">ğŸ“Š åˆ†æçµæœ</h4>
            <div class="space-y-2 text-sm">
                <div class="flex justify-between">
                    <span class="text-gray-600">æ„Ÿæƒ…åˆ†æ</span>
                    <span class="font-medium text-green-600">ãƒã‚¸ãƒ†ã‚£ãƒ– 78%</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">é‡è¦åº¦</span>
                    <span class="font-medium text-blue-600">é«˜ (8.2/10)</span>
                </div>
                <div class="flex justify-between">
                    <span class="text-gray-600">ä¿¡é ¼åº¦</span>
                    <span class="font-medium text-green-600">95%</span>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// çµ±åˆè­°äº‹éŒ²ç·¨é›†ã‚·ã‚¹ãƒ†ãƒ ã®JavaScript
let currentStage = 'ai_summary';

function switchStage(stage) {
    console.log('ã‚¹ãƒ†ãƒ¼ã‚¸åˆ‡ã‚Šæ›¿ãˆ:', stage);
    // å®Ÿéš›ã«ã¯ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§ãƒšãƒ¼ã‚¸ã‚’å†èª­ã¿è¾¼ã¿
    window.location.href = `{{ base_url }}/dialogue/edit-unified?stage=${stage}`;
}

// åˆæœŸåŒ–
document.addEventListener('DOMContentLoaded', function() {
    console.log('çµ±åˆè­°äº‹éŒ²ç·¨é›†ã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†');
});
</script>
{% endblock %}