{% extends "base.html" %}

{% block title %}ä¸­æœŸè¨ˆç”»ãƒ»æŠ•è³‡å®¶å¯¾å¿œç®¡ç†{% endblock %}
{% block page_icon %}ğŸ“‹{% endblock %}
{% block page_title %}ä¸­æœŸè¨ˆç”»ãƒ»æŠ•è³‡å®¶å¯¾å¿œç®¡ç†{% endblock %}
{% block breadcrumb_current %}ä¸­æœŸè¨ˆç”»ãƒ»æŠ•è³‡å®¶å¯¾å¿œç®¡ç†{% endblock %}

{% block extra_css %}
<style>
    /* ä¸­æœŸè¨ˆç”»è¡¨ç¤ºã‚¨ãƒªã‚¢ */
    .midterm-plan-container {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        overflow: hidden;
        margin-bottom: 24px;
    }
    
    .plan-header {
        background: linear-gradient(135deg, #1a365d 0%, #2563eb 100%);
        color: white;
        padding: 24px;
    }
    
    .plan-title {
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 8px;
    }
    
    .plan-period {
        font-size: 1rem;
        opacity: 0.9;
        margin-bottom: 16px;
    }
    
    .plan-source {
        display: flex;
        gap: 16px;
        font-size: 0.875rem;
    }
    
    .source-badge {
        background: rgba(255, 255, 255, 0.2);
        padding: 4px 12px;
        border-radius: 16px;
        backdrop-filter: blur(10px);
    }
    
    /* è¨ˆç”»è©³ç´° */
    .plan-content {
        padding: 24px;
    }
    
    .plan-section {
        margin-bottom: 32px;
    }
    
    .section-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 2px solid #e5e7eb;
    }
    
    .section-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: #111827;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .section-actions {
        display: flex;
        gap: 8px;
    }
    
    /* ç›®æ¨™ã‚«ãƒ¼ãƒ‰ */
    .target-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 16px;
        margin-bottom: 24px;
    }
    
    .target-card {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        position: relative;
        transition: all 0.2s;
    }
    
    .target-card:hover {
        border-color: #14b8a6;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }
    
    .target-indicator {
        position: absolute;
        top: 16px;
        right: 16px;
        width: 8px;
        height: 8px;
        border-radius: 50%;
        background: #10b981;
    }
    
    .target-indicator.has-questions {
        background: #f59e0b;
        animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
        0% { opacity: 1; transform: scale(1); }
        50% { opacity: 0.8; transform: scale(1.2); }
        100% { opacity: 1; transform: scale(1); }
    }
    
    .target-name {
        font-weight: 600;
        color: #111827;
        margin-bottom: 8px;
    }
    
    .target-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: #1a365d;
        margin-bottom: 4px;
    }
    
    .target-baseline {
        font-size: 0.875rem;
        color: #6b7280;
        margin-bottom: 8px;
    }
    
    .target-questions {
        font-size: 0.75rem;
        color: #f59e0b;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 4px;
    }
    
    /* è³ªå•ç®¡ç†ã‚¨ãƒªã‚¢ */
    .question-management {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        padding: 24px;
        margin-bottom: 24px;
    }
    
    .question-tabs {
        display: flex;
        gap: 4px;
        background: #f3f4f6;
        padding: 4px;
        border-radius: 8px;
        margin-bottom: 20px;
    }
    
    .question-tab {
        padding: 8px 16px;
        border-radius: 6px;
        font-size: 0.875rem;
        font-weight: 500;
        color: #6b7280;
        cursor: pointer;
        transition: all 0.2s;
        position: relative;
    }
    
    .question-tab.active {
        background: white;
        color: #111827;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .question-badge {
        position: absolute;
        top: -4px;
        right: -4px;
        background: #ef4444;
        color: white;
        font-size: 0.625rem;
        padding: 2px 6px;
        border-radius: 10px;
        font-weight: 600;
    }
    
    /* è³ªå•ãƒªã‚¹ãƒˆ */
    .question-list {
        space-y: 12px;
    }
    
    .question-item {
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        transition: all 0.2s;
        cursor: pointer;
    }
    
    .question-item:hover {
        border-color: #14b8a6;
        background: #f0fdfa;
    }
    
    .question-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 8px;
    }
    
    .question-meta {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 0.75rem;
        color: #6b7280;
    }
    
    .question-status {
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .status-badge {
        padding: 2px 8px;
        border-radius: 12px;
        font-size: 0.625rem;
        font-weight: 600;
    }
    
    .status-new {
        background: #fee2e2;
        color: #991b1b;
    }
    
    .status-answered {
        background: #d1fae5;
        color: #065f46;
    }
    
    .status-faq {
        background: #dbeafe;
        color: #1e40af;
    }
    
    .question-text {
        font-weight: 500;
        color: #111827;
        margin-bottom: 8px;
    }
    
    .question-context {
        font-size: 0.875rem;
        color: #6b7280;
        margin-bottom: 12px;
    }
    
    .question-actions {
        display: flex;
        gap: 8px;
    }
    
    .action-button {
        padding: 6px 12px;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        font-size: 0.75rem;
        font-weight: 500;
        background: white;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .action-button:hover {
        background: #f9fafb;
        border-color: #d1d5db;
    }
    
    .action-button.primary {
        background: #14b8a6;
        border-color: #14b8a6;
        color: white;
    }
    
    .action-button.primary:hover {
        background: #0d9488;
        border-color: #0d9488;
    }
    
    /* FAQä½œæˆã‚¨ãƒªã‚¢ */
    .faq-editor {
        background: linear-gradient(135deg, #f0fdfa, #e0f2fe);
        border: 1px solid #14b8a6;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 24px;
        position: relative;
        overflow: hidden;
    }
    
    .faq-editor::before {
        content: 'ğŸ¤–';
        position: absolute;
        top: 24px;
        right: 24px;
        font-size: 32px;
        opacity: 0.2;
    }
    
    .faq-editor-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
    }
    
    .faq-editor-title {
        font-size: 1.125rem;
        font-weight: 600;
        color: #0f766e;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .ai-indicator {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 4px 12px;
        background: rgba(255, 255, 255, 0.8);
        border-radius: 16px;
        font-size: 0.75rem;
        color: #0f766e;
    }
    
    .ai-indicator.active {
        animation: ai-pulse 1.5s infinite;
    }
    
    @keyframes ai-pulse {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.6; }
    }
    
    /* FAQç·¨é›†ãƒ•ã‚©ãƒ¼ãƒ  */
    .faq-form {
        background: white;
        border-radius: 8px;
        padding: 20px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .form-section {
        margin-bottom: 20px;
    }
    
    .form-label {
        display: block;
        font-weight: 500;
        color: #374151;
        margin-bottom: 8px;
        font-size: 0.875rem;
    }
    
    .form-input, .form-textarea {
        width: 100%;
        padding: 8px 12px;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        font-size: 0.875rem;
        transition: all 0.2s;
    }
    
    .form-input:focus, .form-textarea:focus {
        outline: none;
        border-color: #14b8a6;
        box-shadow: 0 0 0 3px rgba(20, 184, 166, 0.1);
    }
    
    .form-textarea {
        min-height: 100px;
        resize: vertical;
    }
    
    /* AIææ¡ˆ */
    .ai-suggestions {
        background: #f0fdfa;
        border: 1px solid #14b8a6;
        border-radius: 8px;
        padding: 16px;
        margin-top: 12px;
    }
    
    .ai-suggestion-item {
        display: flex;
        align-items: flex-start;
        gap: 12px;
        padding: 12px;
        background: white;
        border-radius: 6px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .ai-suggestion-item:hover {
        transform: translateX(4px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }
    
    .suggestion-icon {
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #d1fae5;
        border-radius: 50%;
        flex-shrink: 0;
    }
    
    .suggestion-content {
        flex: 1;
    }
    
    .suggestion-title {
        font-weight: 500;
        color: #111827;
        margin-bottom: 4px;
        font-size: 0.875rem;
    }
    
    .suggestion-text {
        font-size: 0.75rem;
        color: #6b7280;
        line-height: 1.5;
    }
    
    .suggestion-action {
        color: #14b8a6;
        font-size: 0.75rem;
        font-weight: 500;
    }
    
    /* å…¬é–‹FAQ */
    .public-faq-section {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        padding: 24px;
    }
    
    .faq-category {
        margin-bottom: 24px;
    }
    
    .category-header {
        display: flex;
        align-items: center;
        gap: 8px;
        margin-bottom: 12px;
        cursor: pointer;
    }
    
    .category-icon {
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #f3f4f6;
        border-radius: 6px;
    }
    
    .category-title {
        font-weight: 600;
        color: #111827;
        flex: 1;
    }
    
    .category-count {
        font-size: 0.75rem;
        color: #6b7280;
        background: #f3f4f6;
        padding: 2px 8px;
        border-radius: 12px;
    }
    
    .faq-list {
        space-y: 8px;
    }
    
    .faq-item {
        background: #f9fafb;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .faq-item:hover {
        border-color: #d1d5db;
        background: #f3f4f6;
    }
    
    .faq-question {
        font-weight: 500;
        color: #111827;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        gap: 8px;
    }
    
    .faq-answer {
        font-size: 0.875rem;
        color: #4b5563;
        line-height: 1.6;
        display: none;
    }
    
    .faq-item.expanded .faq-answer {
        display: block;
    }
    
    .faq-meta {
        display: flex;
        gap: 16px;
        margin-top: 12px;
        font-size: 0.75rem;
        color: #6b7280;
    }
    
    .faq-stats {
        display: flex;
        align-items: center;
        gap: 4px;
    }
    
    /* ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ— */
    .draggable {
        cursor: move;
    }
    
    .dragging {
        opacity: 0.5;
    }
    
    .drop-zone {
        border: 2px dashed #e5e7eb;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        color: #9ca3af;
        transition: all 0.2s;
    }
    
    .drop-zone.active {
        border-color: #14b8a6;
        background: #f0fdfa;
        color: #0f766e;
    }
    
    /* è©³ç´°ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¹ã‚¿ã‚¤ãƒ« */
    .target-detail-modal {
        max-height: 80vh;
        overflow-y: auto;
    }
    
    .detail-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        padding: 20px;
        background: #f9fafb;
        border-radius: 12px 12px 0 0;
        margin: -20px -20px 20px -20px;
    }
    
    .detail-tabs {
        display: flex;
        gap: 4px;
        background: #f3f4f6;
        padding: 4px;
        border-radius: 8px;
        margin-bottom: 20px;
    }
    
    .detail-tab {
        display: flex;
        align-items: center;
        gap: 6px;
        padding: 8px 16px;
        border-radius: 6px;
        font-size: 0.875rem;
        font-weight: 500;
        color: #6b7280;
        background: transparent;
        border: none;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .detail-tab.active {
        background: white;
        color: #111827;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }
    
    .tab-badge {
        background: #ef4444;
        color: white;
        font-size: 0.625rem;
        padding: 2px 6px;
        border-radius: 10px;
        font-weight: 600;
    }
    
    .detail-content {
        min-height: 300px;
    }
    
    .detail-footer {
        display: flex;
        gap: 12px;
        margin-top: 24px;
        padding-top: 24px;
        border-top: 1px solid #e5e7eb;
    }
    
    .btn-primary {
        padding: 8px 16px;
        background: #14b8a6;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s;
    }
    
    .btn-primary:hover {
        background: #0d9488;
    }
    
    .btn-secondary {
        padding: 8px 16px;
        background: white;
        color: #374151;
        border: 1px solid #e5e7eb;
        border-radius: 6px;
        font-size: 0.875rem;
        font-weight: 500;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 6px;
        transition: all 0.2s;
    }
    
    .btn-secondary:hover {
        background: #f9fafb;
        border-color: #d1d5db;
    }
    
    /* ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ£ãƒ¼ãƒˆ */
    .progress-chart {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 16px;
    }
    
    .progress-timeline {
        position: relative;
        padding: 20px 0;
    }
    
    .timeline-item {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 16px;
        position: relative;
    }
    
    .timeline-date {
        width: 80px;
        font-size: 0.75rem;
        color: #6b7280;
        text-align: right;
    }
    
    .timeline-marker {
        width: 12px;
        height: 12px;
        background: #14b8a6;
        border-radius: 50%;
        position: relative;
        z-index: 1;
    }
    
    .timeline-marker.pending {
        background: #e5e7eb;
        border: 2px solid #9ca3af;
    }
    
    .timeline-content {
        flex: 1;
        background: #f9fafb;
        padding: 12px 16px;
        border-radius: 8px;
        position: relative;
    }
    
    .timeline-line {
        position: absolute;
        left: 85px;
        top: 0;
        bottom: 0;
        width: 2px;
        background: #e5e7eb;
        z-index: 0;
    }
    
    /* ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ */
    .collaboration-indicator {
        display: flex;
        align-items: center;
        gap: 8px;
        padding: 8px 16px;
        background: #f0fdfa;
        border: 1px solid #14b8a6;
        border-radius: 8px;
        font-size: 0.875rem;
        color: #0f766e;
        margin-bottom: 16px;
    }
    
    .active-users {
        display: flex;
        align-items: center;
        gap: -8px;
    }
    
    .user-avatar {
        width: 32px;
        height: 32px;
        background: #14b8a6;
        color: white;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.75rem;
        font-weight: 600;
        border: 2px solid white;
    }
    
    /* ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ— */
    .heatmap-container {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 16px;
    }
    
    .heatmap-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 4px;
    }
    
    .heatmap-cell {
        aspect-ratio: 1;
        border-radius: 4px;
        position: relative;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .heatmap-cell:hover {
        transform: scale(1.1);
        z-index: 10;
    }
    
    .heat-level-0 { background: #f3f4f6; }
    .heat-level-1 { background: #86efac; }
    .heat-level-2 { background: #34d399; }
    .heat-level-3 { background: #10b981; }
    .heat-level-4 { background: #059669; }
    
    /* æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ */
    .approval-flow {
        background: #f9fafb;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 16px;
    }
    
    .approval-step {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 8px;
        margin-bottom: 8px;
    }
    
    .approval-status {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .approval-approved {
        background: #d1fae5;
        color: #065f46;
    }
    
    .approval-pending {
        background: #fed7aa;
        color: #9a3412;
    }
    
    .approval-waiting {
        background: #f3f4f6;
        color: #9ca3af;
    }
    
    /* ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ */
    @keyframes pulse {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.05); opacity: 0.9; }
    }
    
    @keyframes slideIn {
        from { transform: translateX(-10px); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
    }
    
    @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
    }
    
    .target-card {
        animation: fadeIn 0.5s ease-out;
        animation-fill-mode: both;
    }
    
    .target-card:nth-child(1) { animation-delay: 0.1s; }
    .target-card:nth-child(2) { animation-delay: 0.2s; }
    .target-card:nth-child(3) { animation-delay: 0.3s; }
    .target-card:nth-child(4) { animation-delay: 0.4s; }
    .target-card:nth-child(5) { animation-delay: 0.5s; }
    .target-card:nth-child(6) { animation-delay: 0.6s; }
    
    .target-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }
    
    /* ã‚¹ãƒãƒ¼ãƒˆææ¡ˆã‚«ãƒ¼ãƒ‰ */
    .smart-suggestion {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 16px;
        border-radius: 12px;
        margin-bottom: 20px;
        position: relative;
        overflow: hidden;
        animation: slideIn 0.5s ease-out;
    }
    
    .smart-suggestion::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: linear-gradient(45deg, transparent 30%, rgba(255,255,255,0.1) 50%, transparent 70%);
        transform: rotate(45deg);
        animation: shimmer 3s infinite;
    }
    
    @keyframes shimmer {
        0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
        100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
    }
    
    /* AIã‚¢ã‚·ã‚¹ãƒˆãƒœã‚¿ãƒ³ */
    .ai-assist-button {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, #14b8a6 0%, #0d9488 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        box-shadow: 0 10px 25px -5px rgba(20, 184, 166, 0.5);
        cursor: pointer;
        transition: all 0.3s;
        z-index: 1000;
    }
    
    .ai-assist-button:hover {
        transform: scale(1.1);
        box-shadow: 0 15px 35px -5px rgba(20, 184, 166, 0.7);
    }
    
    .ai-assist-menu {
        position: fixed;
        bottom: 100px;
        right: 30px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        padding: 8px;
        min-width: 200px;
        display: none;
        z-index: 1001;
    }
    
    .ai-assist-menu.active {
        display: block;
        animation: slideIn 0.3s ease-out;
    }
    
    .ai-assist-option {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px 16px;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .ai-assist-option:hover {
        background: #f3f4f6;
    }
    
    /* ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ« */
    .insights-panel {
        background: linear-gradient(135deg, #f9fafb 0%, #e5e7eb 100%);
        border-radius: 12px;
        padding: 20px;
        margin-bottom: 20px;
        position: relative;
        overflow: hidden;
    }
    
    .insight-item {
        display: flex;
        align-items: center;
        gap: 12px;
        padding: 12px;
        background: white;
        border-radius: 8px;
        margin-bottom: 8px;
        cursor: pointer;
        transition: all 0.2s;
    }
    
    .insight-item:hover {
        transform: translateX(8px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    }
    
    .insight-icon {
        width: 40px;
        height: 40px;
        background: #dbeafe;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #2563eb;
    }
    
    .insight-icon.warning {
        background: #fef3c7;
        color: #d97706;
    }
    
    .insight-icon.success {
        background: #d1fae5;
        color: #059669;
    }
</style>
{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- AIã‚¢ã‚·ã‚¹ãƒˆãƒœã‚¿ãƒ³ -->
    <div class="ai-assist-button" onclick="toggleAIAssist()">
        <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
        </svg>
    </div>
    
    <!-- AIã‚¢ã‚·ã‚¹ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ -->
    <div class="ai-assist-menu" id="aiAssistMenu">
        <div class="ai-assist-option" onclick="aiGenerateInsights()">
            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
            </svg>
            <span class="text-sm font-medium">ã‚¤ãƒ³ã‚µã‚¤ãƒˆç”Ÿæˆ</span>
        </div>
        <div class="ai-assist-option" onclick="aiSuggestAnswers()">
            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
            </svg>
            <span class="text-sm font-medium">å›ç­”æ¡ˆä½œæˆ</span>
        </div>
        <div class="ai-assist-option" onclick="aiAnalyzeTrends()">
            <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
            </svg>
            <span class="text-sm font-medium">ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ</span>
        </div>
        <div class="ai-assist-option" onclick="aiOptimizePlan()">
            <svg class="w-5 h-5 text-orange-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
            <span class="text-sm font-medium">è¨ˆç”»æœ€é©åŒ–</span>
        </div>
    </div>
    
    <!-- ã‚¹ãƒãƒ¼ãƒˆææ¡ˆ -->
    <div class="smart-suggestion" id="smartSuggestion" style="display: none;">
        <div class="flex items-start gap-3">
            <svg class="w-6 h-6 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z" />
            </svg>
            <div class="flex-1">
                <h3 class="font-semibold mb-1">AIåˆ†æã«ã‚ˆã‚‹é‡è¦ãªç™ºè¦‹</h3>
                <p class="text-sm opacity-90" id="suggestionText">DXæŠ•è³‡ã«é–¢ã™ã‚‹è³ªå•ãŒå…ˆé€±æ¯”ã§40%å¢—åŠ ã—ã¦ã„ã¾ã™ã€‚æŠ•è³‡å®¶å‘ã‘ã«è©³ç´°ãªèª¬æ˜è³‡æ–™ã®æº–å‚™ã‚’æ¨å¥¨ã—ã¾ã™ã€‚</p>
            </div>
            <button onclick="dismissSuggestion()" class="text-white/80 hover:text-white">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
    </div>
    
    <!-- ã‚¤ãƒ³ã‚µã‚¤ãƒˆãƒ‘ãƒãƒ« -->
    <div class="insights-panel" id="insightsPanel" style="display: none;">
        <h3 class="text-lg font-semibold mb-4">AIã«ã‚ˆã‚‹åˆ†æã¨æ¨å¥¨äº‹é …</h3>
        <div class="space-y-3">
            <div class="insight-item" onclick="applyInsight('revenue')">
                <div class="insight-icon">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" />
                    </svg>
                </div>
                <div class="flex-1">
                    <h4 class="font-medium text-sm">å£²ä¸Šç›®æ¨™é”æˆã¸ã®é‡è¦ãƒã‚¤ãƒ³ãƒˆ</h4>
                    <p class="text-xs text-gray-600 mt-1">ç‚ºæ›¿ãƒªã‚¹ã‚¯ã«é–¢ã™ã‚‹è³ªå•ãŒå¤šãã€è©³ç´°ãªãƒ˜ãƒƒã‚¸æˆ¦ç•¥ã®èª¬æ˜ãŒå¿…è¦ã§ã™</p>
                </div>
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
            </div>
            
            <div class="insight-item" onclick="applyInsight('esg')">
                <div class="insight-icon warning">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <div class="flex-1">
                    <h4 class="font-medium text-sm">ESGç›®æ¨™ã«é–¢ã™ã‚‹æ³¨æ„äº‹é …</h4>
                    <p class="text-xs text-gray-600 mt-1">CO2å‰Šæ¸›ç›®æ¨™ã«ã¤ã„ã¦æŠ•è³‡å®¶ã‹ã‚‰å…·ä½“çš„ãªãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã®è¦æ±‚ãŒå¢—åŠ </p>
                </div>
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
            </div>
            
            <div class="insight-item" onclick="applyInsight('questions')">
                <div class="insight-icon success">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <div class="flex-1">
                    <h4 class="font-medium text-sm">ã‚ˆãã‚ã‚‹è³ªå•ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º</h4>
                    <p class="text-xs text-gray-600 mt-1">23ä»¶ã®é¡ä¼¼è³ªå•ã‚’è‡ªå‹•ã‚°ãƒ«ãƒ¼ãƒ—åŒ–ã—ã€åŠ¹ç‡çš„ãªå›ç­”ä½œæˆãŒå¯èƒ½ã§ã™</p>
                </div>
                <svg class="w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                </svg>
            </div>
        </div>
    </div>

    <!-- ä¸­æœŸçµŒå–¶è¨ˆç”»è¡¨ç¤ºã‚¨ãƒªã‚¢ -->
    <div class="midterm-plan-container">
    <div class="plan-header">
        <h1 class="plan-title">ä¸­æœŸçµŒå–¶è¨ˆç”» 2024-2026</h1>
        <p class="plan-period">ã€ŒDXã¨ESGã‚’è»¸ã¨ã—ãŸæŒç¶šçš„æˆé•·ã¸ã®æŒ‘æˆ¦ã€</p>
        <div class="plan-source">
            <span class="source-badge">ğŸ“„ 2024å¹´5æœˆæ±ºç®—çŸ­ä¿¡ã‚ˆã‚Š</span>
            <span class="source-badge">ğŸ“¢ 2024å¹´5æœˆ15æ—¥é©æ™‚é–‹ç¤ºã‚ˆã‚Š</span>
            <span class="source-badge">ğŸ”„ æœ€çµ‚æ›´æ–°: 2024å¹´1æœˆ20æ—¥</span>
        </div>
    </div>
    
    <div class="plan-content">
        <!-- å®šé‡ç›®æ¨™ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="plan-section">
            <div class="section-header">
                <h2 class="section-title">
                    <span>ğŸ“Š</span>
                    å®šé‡ç›®æ¨™ï¼ˆ2026å¹´åº¦ï¼‰
                </h2>
                <div class="section-actions">
                    <button onclick="showAllQuestions('quantitative')" class="action-button">
                        é–¢é€£è³ªå•ã‚’è¦‹ã‚‹ (23ä»¶)
                    </button>
                    <button onclick="editTargets('quantitative')" class="action-button">
                        ç·¨é›†
                    </button>
                </div>
            </div>
            
            <div class="target-grid">
                <div class="target-card" onclick="showTargetDetail('revenue')">
                    <div class="target-indicator has-questions"></div>
                    <div class="target-name">å£²ä¸Šé«˜</div>
                    <div class="target-value">1,500å„„å††</div>
                    <div class="target-baseline">2023å¹´åº¦å®Ÿç¸¾: 1,200å„„å††ï¼ˆ+25%ï¼‰</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('revenue')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>8ä»¶ã®æœªå›ç­”è³ªå•</span>
                    </div>
                </div>
                
                <div class="target-card" onclick="showTargetDetail('operating-margin')">
                    <div class="target-indicator"></div>
                    <div class="target-name">å–¶æ¥­åˆ©ç›Šç‡</div>
                    <div class="target-value">15.0%</div>
                    <div class="target-baseline">2023å¹´åº¦å®Ÿç¸¾: 12.3%ï¼ˆ+2.7ptï¼‰</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('operating-margin')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>ã™ã¹ã¦å›ç­”æ¸ˆã¿</span>
                    </div>
                </div>
                
                <div class="target-card" onclick="showTargetDetail('roe')">
                    <div class="target-indicator has-questions"></div>
                    <div class="target-name">ROE</div>
                    <div class="target-value">12.0%</div>
                    <div class="target-baseline">2023å¹´åº¦å®Ÿç¸¾: 10.5%ï¼ˆ+1.5ptï¼‰</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('roe')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>3ä»¶ã®æœªå›ç­”è³ªå•</span>
                    </div>
                </div>
                
                <div class="target-card" onclick="showTargetDetail('dividend-ratio')">
                    <div class="target-indicator"></div>
                    <div class="target-name">é…å½“æ€§å‘</div>
                    <div class="target-value">40%</div>
                    <div class="target-baseline">2023å¹´åº¦å®Ÿç¸¾: 35%ï¼ˆ+5ptï¼‰</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('dividend-ratio')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>ã™ã¹ã¦å›ç­”æ¸ˆã¿</span>
                    </div>
                </div>
                
                <div class="target-card" onclick="showTargetDetail('overseas-ratio')">
                    <div class="target-indicator has-questions"></div>
                    <div class="target-name">æµ·å¤–å£²ä¸Šæ¯”ç‡</div>
                    <div class="target-value">35%</div>
                    <div class="target-baseline">2023å¹´åº¦å®Ÿç¸¾: 22%ï¼ˆ+13ptï¼‰</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('overseas-ratio')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>5ä»¶ã®æœªå›ç­”è³ªå•</span>
                    </div>
                </div>
                
                <div class="target-card" onclick="showTargetDetail('co2-reduction')">
                    <div class="target-indicator has-questions"></div>
                    <div class="target-name">CO2å‰Šæ¸›ç‡</div>
                    <div class="target-value">-50%</div>
                    <div class="target-baseline">2020å¹´åº¦æ¯”ï¼ˆç¾åœ¨: -28%ï¼‰</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('co2-reduction')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>7ä»¶ã®æœªå›ç­”è³ªå•</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- é‡ç‚¹æ–½ç­–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="plan-section">
            <div class="section-header">
                <h2 class="section-title">
                    <span>ğŸ¯</span>
                    é‡ç‚¹æ–½ç­–
                </h2>
                <div class="section-actions">
                    <button onclick="showAllQuestions('strategies')" class="action-button">
                        é–¢é€£è³ªå•ã‚’è¦‹ã‚‹ (45ä»¶)
                    </button>
                    <button onclick="editTargets('strategies')" class="action-button">
                        ç·¨é›†
                    </button>
                </div>
            </div>
            
            <div class="target-grid">
                <div class="target-card" onclick="showTargetDetail('dx-investment')">
                    <div class="target-indicator has-questions"></div>
                    <div class="target-name">DXæŠ•è³‡</div>
                    <div class="target-value">3å¹´é–“ã§300å„„å††</div>
                    <div class="target-baseline">åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ åˆ·æ–°ã€AIæ´»ç”¨ã€ãƒ‡ãƒ¼ã‚¿åŸºç›¤æ§‹ç¯‰</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('dx-investment')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>12ä»¶ã®æœªå›ç­”è³ªå•</span>
                    </div>
                </div>
                
                <div class="target-card" onclick="showTargetDetail('asia-expansion')">
                    <div class="target-indicator has-questions"></div>
                    <div class="target-name">ã‚¢ã‚¸ã‚¢å±•é–‹</div>
                    <div class="target-value">5ã‚«å›½æ–°è¦é€²å‡º</div>
                    <div class="target-baseline">ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢ã€ãƒ™ãƒˆãƒŠãƒ ã€ã‚¿ã‚¤ã€ãƒãƒ¬ãƒ¼ã‚·ã‚¢ã€ãƒ•ã‚£ãƒªãƒ”ãƒ³</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('asia-expansion')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>18ä»¶ã®æœªå›ç­”è³ªå•</span>
                    </div>
                </div>
                
                <div class="target-card" onclick="showTargetDetail('new-business')">
                    <div class="target-indicator has-questions"></div>
                    <div class="target-name">æ–°è¦äº‹æ¥­</div>
                    <div class="target-value">å£²ä¸Šæ§‹æˆæ¯”20%</div>
                    <div class="target-baseline">ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢ã€ã‚°ãƒªãƒ¼ãƒ³ãƒ†ãƒƒã‚¯ã€SaaSäº‹æ¥­</div>
                    <div class="target-questions" onclick="event.stopPropagation(); showTargetQuestions('new-business')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        <span>15ä»¶ã®æœªå›ç­”è³ªå•</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- è³ªå•ç®¡ç†ã‚¨ãƒªã‚¢ -->
<div class="question-management">
    <div class="section-header">
        <h2 class="section-title">
            <span>ğŸ’¬</span>
            æŠ•è³‡å®¶ã‹ã‚‰ã®è³ªå•ç®¡ç†
        </h2>
        <div class="section-actions">
            <button onclick="importQuestions()" class="action-button">
                è³ªå•ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
            </button>
            <button onclick="showAIAssistant()" class="action-button primary">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
                </svg>
                AIå›ç­”æ”¯æ´
            </button>
        </div>
    </div>
    
    <div class="question-tabs">
        <button class="question-tab active" onclick="switchQuestionTab('unanswered')">
            æœªå›ç­”
            <span class="question-badge">26</span>
        </button>
        <button class="question-tab" onclick="switchQuestionTab('draft')">
            ä¸‹æ›¸ã
            <span class="question-badge">8</span>
        </button>
        <button class="question-tab" onclick="switchQuestionTab('answered')">
            å›ç­”æ¸ˆã¿
        </button>
        <button class="question-tab" onclick="switchQuestionTab('faq')">
            FAQåŒ–æ¸ˆã¿
        </button>
    </div>
    
    <div id="question-list" class="question-list">
        <!-- æœªå›ç­”ã®è³ªå•ä¾‹ -->
        <div class="question-item" onclick="openQuestionDetail('Q001')">
            <div class="question-header">
                <div class="question-meta">
                    <span>ğŸ¢ é‡æ‘ã‚¢ã‚»ãƒƒãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ</span>
                    <span>â€¢</span>
                    <span>2024/01/22 é¢è«‡</span>
                    <span>â€¢</span>
                    <span>æµ·å¤–å£²ä¸Šæ¯”ç‡ã«ã¤ã„ã¦</span>
                </div>
                <div class="question-status">
                    <span class="status-badge status-new">æ–°è¦</span>
                </div>
            </div>
            <p class="question-text">
                æµ·å¤–å£²ä¸Šæ¯”ç‡35%ã®é”æˆã«å‘ã‘ã¦ã€å„åœ°åŸŸåˆ¥ã®å£²ä¸Šç›®æ¨™ã¨æŠ•è³‡è¨ˆç”»ã®è©³ç´°ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
                ç‰¹ã«ã‚¢ã‚¸ã‚¢å¸‚å ´ã§ã®ç«¶åˆå„ªä½æ€§ã‚’ã©ã®ã‚ˆã†ã«ç¢ºä¿ã™ã‚‹ã®ã‹ï¼Ÿ
            </p>
            <p class="question-context">
                é–¢é€£ï¼šä¸­æœŸçµŒå–¶è¨ˆç”» > å®šé‡ç›®æ¨™ > æµ·å¤–å£²ä¸Šæ¯”ç‡ã€é‡ç‚¹æ–½ç­– > ã‚¢ã‚¸ã‚¢å±•é–‹
            </p>
            <div class="question-actions">
                <button class="action-button primary" onclick="answerQuestion('Q001')">å›ç­”ä½œæˆ</button>
                <button class="action-button" onclick="createFAQ('Q001')">FAQåŒ–</button>
                <button class="action-button" onclick="assignQuestion('Q001')">æ‹…å½“è€…å‰²å½“</button>
                <button class="action-button" onclick="relateQuestion('Q001')">é¡ä¼¼è³ªå•ã‚’è¦‹ã‚‹</button>
            </div>
        </div>
        
        <div class="question-item" onclick="openQuestionDetail('Q002')">
            <div class="question-header">
                <div class="question-meta">
                    <span>ğŸŒ BlackRock</span>
                    <span>â€¢</span>
                    <span>2024/01/21 é›»è©±ä¼šè­°</span>
                    <span>â€¢</span>
                    <span>DXæŠ•è³‡ã«ã¤ã„ã¦</span>
                </div>
                <div class="question-status">
                    <span class="status-badge status-new">æ–°è¦</span>
                </div>
            </div>
            <p class="question-text">
                DXæŠ•è³‡300å„„å††ã®å†…è¨³ã¨æœŸå¾…ã•ã‚Œã‚‹ROIã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¦ãã ã•ã„ã€‚
                ã¾ãŸã€æŠ•è³‡åŠ¹æœã®æ¸¬å®šæ–¹æ³•ã¨KPIã®è¨­å®šã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„ã€‚
            </p>
            <p class="question-context">
                é–¢é€£ï¼šä¸­æœŸçµŒå–¶è¨ˆç”» > é‡ç‚¹æ–½ç­– > DXæŠ•è³‡
            </p>
            <div class="question-actions">
                <button class="action-button primary" onclick="answerQuestion('Q002')">å›ç­”ä½œæˆ</button>
                <button class="action-button" onclick="createFAQ('Q002')">FAQåŒ–</button>
                <button class="action-button" onclick="assignQuestion('Q002')">æ‹…å½“è€…å‰²å½“</button>
                <button class="action-button" onclick="relateQuestion('Q002')">é¡ä¼¼è³ªå•ã‚’è¦‹ã‚‹</button>
            </div>
        </div>
        
        <div class="question-item" onclick="openQuestionDetail('Q003')">
            <div class="question-header">
                <div class="question-meta">
                    <span>ğŸŒ± ESGæŠ•è³‡ãƒ•ã‚¡ãƒ³ãƒ‰</span>
                    <span>â€¢</span>
                    <span>2024/01/20 æ›¸é¢</span>
                    <span>â€¢</span>
                    <span>CO2å‰Šæ¸›ã«ã¤ã„ã¦</span>
                </div>
                <div class="question-status">
                    <span class="status-badge status-new">æ–°è¦</span>
                </div>
            </div>
            <p class="question-text">
                CO2å‰Šæ¸›ç‡50%é”æˆã®ãŸã‚ã®å…·ä½“çš„ãªãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã¨ã€
                ã‚¹ã‚³ãƒ¼ãƒ—1ã€2ã€3ãã‚Œãã‚Œã®å‰Šæ¸›è¨ˆç”»ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
            </p>
            <p class="question-context">
                é–¢é€£ï¼šä¸­æœŸçµŒå–¶è¨ˆç”» > å®šé‡ç›®æ¨™ > CO2å‰Šæ¸›ç‡
            </p>
            <div class="question-actions">
                <button class="action-button primary" onclick="answerQuestion('Q003')">å›ç­”ä½œæˆ</button>
                <button class="action-button" onclick="createFAQ('Q003')">FAQåŒ–</button>
                <button class="action-button" onclick="assignQuestion('Q003')">æ‹…å½“è€…å‰²å½“</button>
                <button class="action-button" onclick="relateQuestion('Q003')">é¡ä¼¼è³ªå•ã‚’è¦‹ã‚‹</button>
            </div>
        </div>
    </div>
</div>

<!-- FAQä½œæˆã‚¨ãƒªã‚¢ï¼ˆåˆæœŸã¯éè¡¨ç¤ºï¼‰ -->
<div id="faq-editor" class="faq-editor" style="display: none;">
    <div class="faq-editor-header">
        <h3 class="faq-editor-title">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
            </svg>
            AIæ”¯æ´FAQä½œæˆ
        </h3>
        <div class="ai-indicator active">
            <div class="w-2 h-2 bg-green-500 rounded-full"></div>
            AIãŒåˆ†æä¸­...
        </div>
    </div>
    
    <div class="faq-form">
        <div class="form-section">
            <label class="form-label">å…ƒã®è³ªå•</label>
            <div class="p-3 bg-gray-50 rounded-lg text-sm" id="original-question">
                <!-- å‹•çš„ã«æŒ¿å…¥ -->
            </div>
        </div>
        
        <div class="form-section">
            <label class="form-label">ã‚«ãƒ†ã‚´ãƒªãƒ¼</label>
            <select class="form-input" id="faq-category">
                <option>è²¡å‹™ãƒ»æ¥­ç¸¾</option>
                <option>çµŒå–¶æˆ¦ç•¥</option>
                <option>ESGãƒ»ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£</option>
                <option>ã‚¬ãƒãƒŠãƒ³ã‚¹</option>
                <option>äº‹æ¥­å±•é–‹</option>
                <option>æŠ€è¡“ãƒ»ç ”ç©¶é–‹ç™º</option>
            </select>
        </div>
        
        <div class="form-section">
            <label class="form-label">FAQç”¨ã®è³ªå•æ–‡</label>
            <input type="text" class="form-input" id="faq-question" 
                placeholder="æŠ•è³‡å®¶ã«ã¨ã£ã¦ã‚ã‹ã‚Šã‚„ã™ã„è³ªå•æ–‡ã«ç·¨é›†">
            
            <div class="ai-suggestions">
                <div class="text-xs font-semibold text-teal-700 mb-2">AIææ¡ˆ</div>
                <div class="ai-suggestion-item" onclick="applyAISuggestion('question', 1)">
                    <div class="suggestion-icon">ğŸ’¡</div>
                    <div class="suggestion-content">
                        <div class="suggestion-title">ã‚ˆã‚Šæ±ç”¨çš„ãªè¡¨ç¾</div>
                        <div class="suggestion-text">
                            ã€Œæµ·å¤–å±•é–‹ã«ãŠã‘ã‚‹åœ°åŸŸåˆ¥ã®å£²ä¸Šç›®æ¨™ã¨æŠ•è³‡è¨ˆç”»ã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„ã€
                        </div>
                    </div>
                    <span class="suggestion-action">é©ç”¨</span>
                </div>
                <div class="ai-suggestion-item" onclick="applyAISuggestion('question', 2)">
                    <div class="suggestion-icon">ğŸ¯</div>
                    <div class="suggestion-content">
                        <div class="suggestion-title">ç„¦ç‚¹ã‚’çµã£ãŸè¡¨ç¾</div>
                        <div class="suggestion-text">
                            ã€Œã‚¢ã‚¸ã‚¢å¸‚å ´ã§ã®æˆé•·æˆ¦ç•¥ã¨ç«¶åˆå„ªä½æ€§ã«ã¤ã„ã¦ã€
                        </div>
                    </div>
                    <span class="suggestion-action">é©ç”¨</span>
                </div>
            </div>
        </div>
        
        <div class="form-section">
            <label class="form-label">å›ç­”</label>
            <textarea class="form-textarea" id="faq-answer" 
                placeholder="æ˜ç¢ºã§åŒ…æ‹¬çš„ãªå›ç­”ã‚’è¨˜è¼‰"></textarea>
            
            <div class="ai-suggestions">
                <div class="text-xs font-semibold text-teal-700 mb-2">AIææ¡ˆï¼ˆé–‹ç¤ºæ¸ˆã¿æƒ…å ±ã‹ã‚‰ç”Ÿæˆï¼‰</div>
                <div class="ai-suggestion-item" onclick="applyAISuggestion('answer', 1)">
                    <div class="suggestion-icon">ğŸ“Š</div>
                    <div class="suggestion-content">
                        <div class="suggestion-title">æ•°å€¤ã‚’å«ã‚€å…·ä½“çš„å›ç­”</div>
                        <div class="suggestion-text">
                            ã€Œ2026å¹´åº¦ã®æµ·å¤–å£²ä¸Šæ¯”ç‡35%é”æˆã«å‘ã‘ã¦ã€ã‚¢ã‚¸ã‚¢åœ°åŸŸã§200å„„å††ï¼ˆå…¨ä½“ã®60%ï¼‰ã€
                            åŒ—ç±³ã§100å„„å††ï¼ˆ30%ï¼‰ã€æ¬§å·ã§30å„„å††ï¼ˆ10%ï¼‰ã®å£²ä¸Šã‚’è¨ˆç”»ã—ã¦ã„ã¾ã™ã€‚
                            æŠ•è³‡é¡ã¯3å¹´é–“ã§ç·é¡150å„„å††ã‚’äºˆå®šã—ã€ç¾åœ°æ³•äººè¨­ç«‹ã€ç‰©æµæ‹ ç‚¹æ§‹ç¯‰ã€
                            ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°å¼·åŒ–ã«å……å½“ã—ã¾ã™ã€‚ã€
                        </div>
                    </div>
                    <span class="suggestion-action">é©ç”¨</span>
                </div>
                <div class="ai-suggestion-item" onclick="applyAISuggestion('answer', 2)">
                    <div class="suggestion-icon">ğŸ”</div>
                    <div class="suggestion-content">
                        <div class="suggestion-title">é–¢é€£æƒ…å ±ãƒªãƒ³ã‚¯ä»˜ã</div>
                        <div class="suggestion-text">
                            ä¸Šè¨˜ã«åŠ ãˆã¦ã€Œè©³ç´°ã¯çµ±åˆå ±å‘Šæ›¸P.45-48ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹æˆ¦ç•¥ã€ã‚’ã”å‚ç…§ãã ã•ã„ã€ã‚’è¿½åŠ 
                        </div>
                    </div>
                    <span class="suggestion-action">è¿½åŠ </span>
                </div>
            </div>
        </div>
        
        <div class="form-section">
            <label class="form-label">é–¢é€£è³‡æ–™ãƒ»ãƒªãƒ³ã‚¯</label>
            <div class="space-y-2">
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="link-1" checked>
                    <label for="link-1" class="text-sm">2024å¹´5æœˆæœŸæ±ºç®—èª¬æ˜è³‡æ–™ P.23-25</label>
                </div>
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="link-2" checked>
                    <label for="link-2" class="text-sm">ä¸­æœŸçµŒå–¶è¨ˆç”»èª¬æ˜è³‡æ–™ P.12-15</label>
                </div>
                <div class="flex items-center gap-2">
                    <input type="checkbox" id="link-3">
                    <label for="link-3" class="text-sm">çµ±åˆå ±å‘Šæ›¸2023 P.45-48</label>
                </div>
            </div>
        </div>
        
        <div class="flex gap-3 mt-6">
            <button onclick="saveFAQ()" class="action-button primary">ä¿å­˜ã—ã¦FAQå…¬é–‹</button>
            <button onclick="saveDraft()" class="action-button">ä¸‹æ›¸ãä¿å­˜</button>
            <button onclick="previewFAQ()" class="action-button">ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</button>
            <button onclick="closeFAQEditor()" class="action-button">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        </div>
    </div>
</div>

<!-- å…¬é–‹FAQä¸€è¦§ -->
<div class="public-faq-section">
    <div class="section-header">
        <h2 class="section-title">
            <span>ğŸ“š</span>
            å…¬é–‹FAQ
        </h2>
        <div class="section-actions">
            <input type="search" placeholder="FAQã‚’æ¤œç´¢..." class="form-input" style="width: 200px;">
            <button onclick="exportFAQ()" class="action-button">ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ</button>
            <button onclick="manageFAQOrder()" class="action-button">ä¸¦ã³é †ç®¡ç†</button>
        </div>
    </div>
    
    <!-- è²¡å‹™ãƒ»æ¥­ç¸¾ã‚«ãƒ†ã‚´ãƒªãƒ¼ -->
    <div class="faq-category">
        <div class="category-header" onclick="toggleCategory('financial')">
            <div class="category-icon">ğŸ’°</div>
            <h3 class="category-title">è²¡å‹™ãƒ»æ¥­ç¸¾</h3>
            <span class="category-count">12ä»¶</span>
            <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
        </div>
        
        <div class="faq-list" id="financial-faqs">
            <div class="faq-item draggable" draggable="true" onclick="toggleFAQ(this)">
                <div class="faq-question">
                    <span>Q.</span>
                    2026å¹´åº¦ã®å£²ä¸Šé«˜1,500å„„å††é”æˆã®å‰ææ¡ä»¶ã¨å†…è¨³ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
                </div>
                <div class="faq-answer">
                    å£²ä¸Šé«˜1,500å„„å††ã®é”æˆã«å‘ã‘ã¦ã€æ—¢å­˜äº‹æ¥­ã§1,200å„„å††ï¼ˆå¹´å¹³å‡æˆé•·ç‡3%ï¼‰ã€
                    æ–°è¦äº‹æ¥­ã§300å„„å††ã‚’è¨ˆç”»ã—ã¦ã„ã¾ã™ã€‚åœ°åŸŸåˆ¥ã§ã¯å›½å†…900å„„å††ã€æµ·å¤–600å„„å††ï¼ˆæµ·å¤–æ¯”ç‡40%ï¼‰ã‚’
                    è¦‹è¾¼ã‚“ã§ãŠã‚Šã€ç‰¹ã«ã‚¢ã‚¸ã‚¢å¸‚å ´ã§ã®æˆé•·ã‚’é‡è¦–ã—ã¦ã„ã¾ã™ã€‚
                    ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã¯1ãƒ‰ãƒ«=140å††ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚
                </div>
                <div class="faq-meta">
                    <span class="faq-stats">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                        </svg>
                        é–²è¦§: 234å›
                    </span>
                    <span class="faq-stats">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                        </svg>
                        æœ‰ç”¨: 89%
                    </span>
                    <span>æœ€çµ‚æ›´æ–°: 2024/01/15</span>
                    <button onclick="editFAQ('FAQ001')" class="text-blue-600 hover:text-blue-700 text-sm">ç·¨é›†</button>
                </div>
            </div>
            
            <div class="faq-item draggable" draggable="true" onclick="toggleFAQ(this)">
                <div class="faq-question">
                    <span>Q.</span>
                    å–¶æ¥­åˆ©ç›Šç‡15%é”æˆã®ãŸã‚ã®å…·ä½“çš„ãªæ–½ç­–ã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„ã€‚
                </div>
                <div class="faq-answer">
                    å–¶æ¥­åˆ©ç›Šç‡15%ã®é”æˆã«å‘ã‘ã¦ã€ä»¥ä¸‹ã®æ–½ç­–ã‚’å®Ÿæ–½ã—ã¾ã™ï¼š
                    1) é«˜ä»˜åŠ ä¾¡å€¤è£½å“ã¸ã®ã‚·ãƒ•ãƒˆã«ã‚ˆã‚‹ç²—åˆ©ç‡æ”¹å–„ï¼ˆ+2.0ptï¼‰
                    2) DXæ¨é€²ã«ã‚ˆã‚‹æ¥­å‹™åŠ¹ç‡åŒ–ã§ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼ˆ+1.5ptï¼‰
                    3) è¦æ¨¡æ‹¡å¤§ã«ã‚ˆã‚‹å›ºå®šè²»ç‡ã®ä½æ¸›ï¼ˆ+1.2ptï¼‰
                    ã“ã‚Œã‚‰ã«ã‚ˆã‚Šã€ç¾åœ¨ã®12.3%ã‹ã‚‰æ®µéšçš„ã«æ”¹å–„ã‚’å›³ã‚Šã¾ã™ã€‚
                </div>
                <div class="faq-meta">
                    <span class="faq-stats">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
                        </svg>
                        é–²è¦§: 189å›
                    </span>
                    <span class="faq-stats">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
                        </svg>
                        æœ‰ç”¨: 92%
                    </span>
                    <span>æœ€çµ‚æ›´æ–°: 2024/01/10</span>
                    <button onclick="editFAQ('FAQ002')" class="text-blue-600 hover:text-blue-700 text-sm">ç·¨é›†</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ESGãƒ»ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£ã‚«ãƒ†ã‚´ãƒªãƒ¼ -->
    <div class="faq-category">
        <div class="category-header" onclick="toggleCategory('esg')">
            <div class="category-icon">ğŸŒ±</div>
            <h3 class="category-title">ESGãƒ»ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£</h3>
            <span class="category-count">8ä»¶</span>
            <svg class="w-5 h-5 transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
        </div>
        
        <div class="faq-list" id="esg-faqs" style="display: none;">
            <!-- ESGé–¢é€£ã®FAQ -->
        </div>
    </div>
</div>

<!-- ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ -->
<div class="fixed bottom-6 right-6 flex flex-col gap-3">
    <button onclick="showAIAssistant()" class="px-6 py-3 bg-kagami-blue text-white rounded-full shadow-lg hover:bg-kagami-blue-dark transition-all flex items-center gap-2">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z" />
        </svg>
        AIå›ç­”ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
    </button>
</div>
{% endblock %}

{% block extra_js %}
<script>
    // ç›®æ¨™è©³ç´°ç”»é¢è¡¨ç¤º
    function showTargetDetail(targetId) {
        const targetData = getTargetData(targetId);
        
        const modalContent = `
            <div class="target-detail-modal" data-target-id="${targetId}">
                <!-- ãƒ˜ãƒƒãƒ€ãƒ¼éƒ¨åˆ† -->
                <div class="detail-header">
                    <div class="detail-title-section">
                        <h3 class="text-xl font-bold text-gray-900">${targetData.name}</h3>
                        <p class="text-sm text-gray-600 mt-1">${targetData.description}</p>
                    </div>
                    <div class="detail-status">
                        <span class="status-badge ${targetData.status === 'on-track' ? 'status-on-track' : 'status-at-risk'}">
                            ${targetData.status === 'on-track' ? 'é †èª¿' : 'è¦æ³¨æ„'}
                        </span>
                    </div>
                </div>
                
                <!-- ã‚¿ãƒ–ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                <div class="detail-tabs">
                    <button class="detail-tab active" onclick="switchDetailTab('overview')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                        æ¦‚è¦
                    </button>
                    <button class="detail-tab" onclick="switchDetailTab('progress')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z" />
                        </svg>
                        é€²æ—
                    </button>
                    <button class="detail-tab" onclick="switchDetailTab('questions')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z" />
                        </svg>
                        è³ªå• <span class="tab-badge">${targetData.questionCount}</span>
                    </button>
                    <button class="detail-tab" onclick="switchDetailTab('history')">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                        å±¥æ­´
                    </button>
                </div>
                
                <!-- ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢ -->
                <div id="detail-content" class="detail-content">
                    ${getDetailContent('overview', targetData)}
                </div>
                
                <!-- ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ•ãƒƒã‚¿ãƒ¼ -->
                <div class="detail-footer">
                    <button onclick="editTarget('${targetId}')" class="btn-primary">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                        </svg>
                        ç·¨é›†
                    </button>
                    <button onclick="updateProgress('${targetId}')" class="btn-secondary">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        é€²æ—æ›´æ–°
                    </button>
                    <button onclick="createTargetFAQ('${targetId}')" class="btn-secondary">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6" />
                        </svg>
                        FAQä½œæˆ
                    </button>
                </div>
            </div>
        `;
        
        // showModalé–¢æ•°ã«sizeãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒã‚ã‚‹å ´åˆ
        const modalOptions = {
            title: targetData.name,
            content: modalContent,
            confirmText: null,
            cancelText: 'é–‰ã˜ã‚‹'
        };
        
        // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’å¤§ããè¡¨ç¤º
        if (typeof showModal === 'function') {
            showModal(modalOptions);
        }
    }
    
    // ç›®æ¨™ãƒ‡ãƒ¼ã‚¿å–å¾—
    function getTargetData(targetId) {
        const targets = {
            'revenue': {
                id: 'revenue',
                name: 'å£²ä¸Šé«˜',
                value: '1,500å„„å††',
                baseline: '2023å¹´åº¦å®Ÿç¸¾: 1,200å„„å††ï¼ˆ+25%ï¼‰',
                description: '2026å¹´åº¦ã«ãŠã‘ã‚‹å£²ä¸Šé«˜ç›®æ¨™',
                status: 'on-track',
                progress: 42,
                questionCount: 8,
                lastUpdate: '2024/01/20',
                responsible: 'çµŒå–¶ä¼ç”»éƒ¨ãƒ»è²¡å‹™éƒ¨',
                milestones: [
                    { date: '2024/03', target: '1,250å„„å††', actual: '1,245å„„å††', status: 'completed' },
                    { date: '2024/09', target: '1,300å„„å††', actual: null, status: 'pending' },
                    { date: '2025/03', target: '1,350å„„å††', actual: null, status: 'pending' },
                    { date: '2025/09', target: '1,425å„„å††', actual: null, status: 'pending' },
                    { date: '2026/03', target: '1,500å„„å††', actual: null, status: 'pending' }
                ]
            },
            'operating-margin': {
                id: 'operating-margin',
                name: 'å–¶æ¥­åˆ©ç›Šç‡',
                value: '15.0%',
                baseline: '2023å¹´åº¦å®Ÿç¸¾: 12.3%ï¼ˆ+2.7ptï¼‰',
                description: 'é«˜ä»˜åŠ ä¾¡å€¤åŒ–ã¨åŠ¹ç‡åŒ–ã«ã‚ˆã‚‹åˆ©ç›Šç‡å‘ä¸Š',
                status: 'on-track',
                progress: 65,
                questionCount: 0,
                lastUpdate: '2024/01/22',
                responsible: 'çµŒå–¶ä¼ç”»éƒ¨ãƒ»CFO'
            },
            'dx-investment': {
                id: 'dx-investment',
                name: 'DXæŠ•è³‡',
                value: '3å¹´é–“ã§300å„„å††',
                baseline: 'åŸºå¹¹ã‚·ã‚¹ãƒ†ãƒ åˆ·æ–°ã€AIæ´»ç”¨ã€ãƒ‡ãƒ¼ã‚¿åŸºç›¤æ§‹ç¯‰',
                description: 'ãƒ‡ã‚¸ã‚¿ãƒ«å¤‰é©ã«ã‚ˆã‚‹ç«¶äº‰åŠ›å¼·åŒ–',
                status: 'at-risk',
                progress: 35,
                questionCount: 12,
                lastUpdate: '2024/01/18',
                responsible: 'DXæ¨é€²å®¤ãƒ»ITéƒ¨é–€'
            },
            'roe': {
                id: 'roe',
                name: 'ROE',
                value: '12.0%',
                baseline: '2023å¹´åº¦å®Ÿç¸¾: 10.5%ï¼ˆ+1.5ptï¼‰',
                description: 'è³‡æœ¬åŠ¹ç‡ã®å‘ä¸Šã‚’é€šã˜ãŸä¼æ¥­ä¾¡å€¤å‘ä¸Š',
                status: 'on-track',
                progress: 58,
                questionCount: 3,
                lastUpdate: '2024/01/21',
                responsible: 'CFOãƒ»è²¡å‹™éƒ¨'
            },
            'dividend-ratio': {
                id: 'dividend-ratio',
                name: 'é…å½“æ€§å‘',
                value: '40%',
                baseline: '2023å¹´åº¦å®Ÿç¸¾: 35%ï¼ˆ+5ptï¼‰',
                description: 'æ ªä¸»é‚„å…ƒã®å¼·åŒ–',
                status: 'on-track',
                progress: 70,
                questionCount: 0,
                lastUpdate: '2024/01/19',
                responsible: 'CFOãƒ»è²¡å‹™éƒ¨'
            },
            'overseas-ratio': {
                id: 'overseas-ratio',
                name: 'æµ·å¤–å£²ä¸Šæ¯”ç‡',
                value: '35%',
                baseline: '2023å¹´åº¦å®Ÿç¸¾: 22%ï¼ˆ+13ptï¼‰',
                description: 'ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹ã®åŠ é€Ÿ',
                status: 'on-track',
                progress: 45,
                questionCount: 5,
                lastUpdate: '2024/01/22',
                responsible: 'å›½éš›äº‹æ¥­éƒ¨'
            },
            'co2-reduction': {
                id: 'co2-reduction',
                name: 'CO2å‰Šæ¸›ç‡',
                value: '-50%',
                baseline: '2020å¹´åº¦æ¯”ï¼ˆç¾åœ¨: -28%ï¼‰',
                description: 'ã‚«ãƒ¼ãƒœãƒ³ãƒ‹ãƒ¥ãƒ¼ãƒˆãƒ©ãƒ«ã¸ã®å–ã‚Šçµ„ã¿',
                status: 'on-track',
                progress: 56,
                questionCount: 7,
                lastUpdate: '2024/01/20',
                responsible: 'ESGæ¨é€²å®¤'
            },
            'asia-expansion': {
                id: 'asia-expansion',
                name: 'ã‚¢ã‚¸ã‚¢å±•é–‹',
                value: '5ã‚«å›½æ–°è¦é€²å‡º',
                baseline: 'ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢ã€ãƒ™ãƒˆãƒŠãƒ ã€ã‚¿ã‚¤ã€ãƒãƒ¬ãƒ¼ã‚·ã‚¢ã€ãƒ•ã‚£ãƒªãƒ”ãƒ³',
                description: 'ã‚¢ã‚¸ã‚¢å¸‚å ´ã§ã®ãƒ—ãƒ¬ã‚¼ãƒ³ã‚¹æ‹¡å¤§',
                status: 'on-track',
                progress: 40,
                questionCount: 18,
                lastUpdate: '2024/01/21',
                responsible: 'å›½éš›äº‹æ¥­éƒ¨'
            },
            'new-business': {
                id: 'new-business',
                name: 'æ–°è¦äº‹æ¥­',
                value: 'å£²ä¸Šæ§‹æˆæ¯”20%',
                baseline: 'ãƒ˜ãƒ«ã‚¹ã‚±ã‚¢ã€ã‚°ãƒªãƒ¼ãƒ³ãƒ†ãƒƒã‚¯ã€SaaSäº‹æ¥­',
                description: 'æ–°ãŸãªæˆé•·ã‚¨ãƒ³ã‚¸ãƒ³ã®ç¢ºç«‹',
                status: 'at-risk',
                progress: 25,
                questionCount: 15,
                lastUpdate: '2024/01/19',
                responsible: 'æ–°è¦äº‹æ¥­é–‹ç™ºéƒ¨'
            }
        };
        return targets[targetId] || targets['revenue'];
    }
    
    // è©³ç´°ã‚³ãƒ³ãƒ†ãƒ³ãƒ„å–å¾—
    function getDetailContent(tab, targetData) {
        switch(tab) {
            case 'overview':
                return `
                    <div class="overview-content">
                        <!-- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ -->
                        <div class="collaboration-indicator">
                            <div class="active-users">
                                <div class="user-avatar">TY</div>
                                <div class="user-avatar" style="background: #3b82f6;">SH</div>
                                <div class="user-avatar" style="background: #f59e0b;">KI</div>
                            </div>
                            <span>3åãŒã“ã®é …ç›®ã‚’ç·¨é›†ä¸­</span>
                            <div style="margin-left: auto; font-size: 0.75rem;">
                                æœ€çµ‚æ›´æ–°: ${targetData.lastUpdate} 14:32
                            </div>
                        </div>
                        
                        <!-- åŸºæœ¬æƒ…å ± -->
                        <div class="grid grid-cols-2 gap-4 mb-6">
                            <div class="info-block">
                                <label class="text-sm text-gray-600">ç›®æ¨™å€¤</label>
                                <p class="text-lg font-semibold">${targetData.value}</p>
                            </div>
                            <div class="info-block">
                                <label class="text-sm text-gray-600">åŸºæº–å€¤</label>
                                <p class="text-sm">${targetData.baseline}</p>
                            </div>
                            <div class="info-block">
                                <label class="text-sm text-gray-600">æ‹…å½“éƒ¨é–€</label>
                                <p class="text-sm">${targetData.responsible}</p>
                            </div>
                            <div class="info-block">
                                <label class="text-sm text-gray-600">é€²æ—ç‡</label>
                                <div class="flex items-center gap-2">
                                    <div class="progress-bar" style="width: 100px;">
                                        <div class="progress-fill" style="width: ${targetData.progress}%;"></div>
                                    </div>
                                    <span class="text-sm font-medium">${targetData.progress}%</span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- é–¢é€£æŒ‡æ¨™ -->
                        <div class="related-metrics">
                            <h4 class="font-medium text-gray-900 mb-3">é–¢é€£æŒ‡æ¨™</h4>
                            <div class="grid grid-cols-3 gap-3">
                                <div class="metric-card">
                                    <div class="metric-label">å›½å†…å£²ä¸Š</div>
                                    <div class="metric-value">900å„„å††</div>
                                    <div class="metric-change positive">+3.2%</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-label">æµ·å¤–å£²ä¸Š</div>
                                    <div class="metric-value">600å„„å††</div>
                                    <div class="metric-change positive">+8.5%</div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-label">æ–°è¦äº‹æ¥­</div>
                                    <div class="metric-value">300å„„å††</div>
                                    <div class="metric-change">-</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ãƒªã‚¹ã‚¯ã¨æ©Ÿä¼š -->
                        <div class="risks-opportunities mt-6">
                            <h4 class="font-medium text-gray-900 mb-3">ãƒªã‚¹ã‚¯ã¨æ©Ÿä¼š</h4>
                            <div class="grid grid-cols-2 gap-4">
                                <div class="risk-card">
                                    <h5 class="text-sm font-medium text-red-900 mb-2">ğŸš¨ ãƒªã‚¹ã‚¯</h5>
                                    <ul class="text-sm text-gray-700 space-y-1">
                                        <li>â€¢ ç‚ºæ›¿å¤‰å‹•ã®å½±éŸ¿ï¼ˆ1ãƒ‰ãƒ«5å††ã§ç´„30å„„å††ã®å½±éŸ¿ï¼‰</li>
                                        <li>â€¢ åŸææ–™ä¾¡æ ¼ã®é«˜é¨°</li>
                                        <li>â€¢ ç«¶äº‰æ¿€åŒ–ã«ã‚ˆã‚‹ä¾¡æ ¼ä¸‹è½åœ§åŠ›</li>
                                    </ul>
                                </div>
                                <div class="opportunity-card">
                                    <h5 class="text-sm font-medium text-green-900 mb-2">ğŸ’¡ æ©Ÿä¼š</h5>
                                    <ul class="text-sm text-gray-700 space-y-1">
                                        <li>â€¢ ã‚¢ã‚¸ã‚¢å¸‚å ´ã®æˆé•·åŠ é€Ÿ</li>
                                        <li>â€¢ DXéœ€è¦ã®æ‹¡å¤§</li>
                                        <li>â€¢ M&Aã«ã‚ˆã‚‹æˆé•·åŠ é€Ÿã®ä½™åœ°</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <style>
                        .info-block {
                            background: #f9fafb;
                            padding: 12px;
                            border-radius: 8px;
                        }
                        .metric-card {
                            background: white;
                            border: 1px solid #e5e7eb;
                            padding: 12px;
                            border-radius: 8px;
                            text-align: center;
                        }
                        .metric-label {
                            font-size: 0.75rem;
                            color: #6b7280;
                            margin-bottom: 4px;
                        }
                        .metric-value {
                            font-size: 1.125rem;
                            font-weight: 600;
                            color: #111827;
                        }
                        .metric-change {
                            font-size: 0.75rem;
                            color: #6b7280;
                        }
                        .metric-change.positive {
                            color: #10b981;
                        }
                        .risk-card, .opportunity-card {
                            background: #fef2f2;
                            padding: 16px;
                            border-radius: 8px;
                        }
                        .opportunity-card {
                            background: #f0fdf4;
                        }
                    </style>
                `;
                
            case 'progress':
                return `
                    <div class="progress-content">
                        <!-- é€²æ—ãƒãƒ£ãƒ¼ãƒˆ -->
                        <div class="progress-chart">
                            <h4 class="font-medium text-gray-900 mb-4">é€²æ—æ¨ç§»</h4>
                            <canvas id="progress-chart-${targetData.id}" height="200"></canvas>
                        </div>
                        
                        <!-- ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ -->
                        <div class="milestones mt-6">
                            <h4 class="font-medium text-gray-900 mb-4">ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³</h4>
                            <div class="timeline-line"></div>
                            ${targetData.milestones ? targetData.milestones.map(milestone => `
                                <div class="timeline-item">
                                    <div class="timeline-date">${milestone.date}</div>
                                    <div class="timeline-marker ${milestone.status === 'completed' ? '' : 'pending'}"></div>
                                    <div class="timeline-content">
                                        <div class="flex justify-between items-start">
                                            <div>
                                                <div class="font-medium">ç›®æ¨™: ${milestone.target}</div>
                                                ${milestone.actual ? `<div class="text-sm text-gray-600">å®Ÿç¸¾: ${milestone.actual}</div>` : ''}
                                            </div>
                                            <span class="text-xs px-2 py-1 rounded ${milestone.status === 'completed' ? 'bg-green-100 text-green-800' : 'bg-gray-100 text-gray-600'}">
                                                ${milestone.status === 'completed' ? 'é”æˆ' : 'äºˆå®š'}
                                            </span>
                                        </div>
                                    </div>
                                </div>
                            `).join('') : ''}
                        </div>
                        
                        <!-- æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ -->
                        <div class="approval-flow mt-6">
                            <h4 class="font-medium text-gray-900 mb-4">é€²æ—æ›´æ–°æ‰¿èªãƒ•ãƒ­ãƒ¼</h4>
                            <div class="approval-step">
                                <div class="approval-status approval-approved">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <div class="font-medium">æ‹…å½“éƒ¨é–€ç¢ºèª</div>
                                    <div class="text-sm text-gray-600">ç”°ä¸­å¤ªéƒï¼ˆçµŒå–¶ä¼ç”»éƒ¨ï¼‰ - 2024/01/20 10:30</div>
                                </div>
                            </div>
                            <div class="approval-step">
                                <div class="approval-status approval-pending">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <div class="font-medium">CFOæ‰¿èª</div>
                                    <div class="text-sm text-gray-600">æ‰¿èªå¾…ã¡</div>
                                </div>
                            </div>
                            <div class="approval-step">
                                <div class="approval-status approval-waiting">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                    </svg>
                                </div>
                                <div class="flex-1">
                                    <div class="font-medium">CEOæœ€çµ‚æ‰¿èª</div>
                                    <div class="text-sm text-gray-600">æœªå®Ÿæ–½</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
            case 'questions':
                return `
                    <div class="questions-content">
                        <!-- è³ªå•ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ— -->
                        <div class="heatmap-container">
                            <h4 class="font-medium text-gray-900 mb-4">æŠ•è³‡å®¶é–¢å¿ƒåº¦ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ï¼ˆéå»30æ—¥ï¼‰</h4>
                            <div class="heatmap-grid">
                                ${generateHeatmap()}
                            </div>
                            <div class="text-xs text-gray-500 mt-2">â€» æ¿ƒã„è‰²ã»ã©è³ªå•ãŒå¤šã„æ—¥</div>
                        </div>
                        
                        <!-- è³ªå•ãƒªã‚¹ãƒˆ -->
                        <div class="questions-list mt-6">
                            <h4 class="font-medium text-gray-900 mb-4">é–¢é€£ã™ã‚‹è³ªå•ï¼ˆ${targetData.questionCount}ä»¶ï¼‰</h4>
                            <div class="space-y-3">
                                <div class="question-summary-card">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-sm font-medium">é‡æ‘ã‚¢ã‚»ãƒƒãƒˆãƒãƒã‚¸ãƒ¡ãƒ³ãƒˆ</span>
                                            <span class="text-xs text-gray-500">2024/01/22</span>
                                        </div>
                                        <span class="status-badge status-new">æœªå›ç­”</span>
                                    </div>
                                    <p class="text-sm text-gray-700 mb-2">
                                        å£²ä¸Šé«˜1,500å„„å††é”æˆã®å‰ææ¡ä»¶ã¨ã—ã¦ã€ç‚ºæ›¿ãƒ¬ãƒ¼ãƒˆã®æƒ³å®šã¯ã©ã®ç¨‹åº¦ã§ã™ã‹ï¼Ÿ
                                    </p>
                                    <div class="flex gap-2">
                                        <button onclick="answerQuestion('Q004')" class="text-xs px-3 py-1 bg-kagami-blue text-white rounded">å›ç­”ä½œæˆ</button>
                                        <button onclick="viewSimilar('Q004')" class="text-xs px-3 py-1 border border-gray-300 rounded">é¡ä¼¼è³ªå•</button>
                                    </div>
                                </div>
                                
                                <div class="question-summary-card">
                                    <div class="flex justify-between items-start mb-2">
                                        <div class="flex items-center gap-2">
                                            <span class="text-sm font-medium">BlackRock</span>
                                            <span class="text-xs text-gray-500">2024/01/20</span>
                                        </div>
                                        <span class="status-badge status-answered">å›ç­”æ¸ˆ</span>
                                    </div>
                                    <p class="text-sm text-gray-700 mb-2">
                                        æ–°è¦äº‹æ¥­ã®300å„„å††ã¯ã©ã®ã‚ˆã†ãªåˆ†é‡ã‚’æƒ³å®šã—ã¦ã„ã¾ã™ã‹ï¼Ÿ
                                    </p>
                                    <div class="flex gap-2">
                                        <button onclick="viewAnswer('Q005')" class="text-xs px-3 py-1 border border-gray-300 rounded">å›ç­”ã‚’è¦‹ã‚‹</button>
                                        <button onclick="createFAQ('Q005')" class="text-xs px-3 py-1 border border-gray-300 rounded">FAQåŒ–</button>
                                    </div>
                                </div>
                            </div>
                            
                            <button onclick="showAllQuestions('${targetData.id}')" class="mt-4 text-sm text-kagami-blue hover:text-kagami-blue-dark">
                                ã™ã¹ã¦ã®è³ªå•ã‚’è¦‹ã‚‹ â†’
                            </button>
                        </div>
                    </div>
                    
                    <style>
                        .question-summary-card {
                            background: #f9fafb;
                            padding: 16px;
                            border-radius: 8px;
                            border: 1px solid #e5e7eb;
                        }
                    </style>
                `;
                
            case 'history':
                return `
                    <div class="history-content">
                        <h4 class="font-medium text-gray-900 mb-4">å¤‰æ›´å±¥æ­´</h4>
                        <div class="space-y-3">
                            <div class="history-item">
                                <div class="flex items-start gap-3">
                                    <div class="history-icon">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="font-medium text-sm">ç”°ä¸­å¤ªéƒ</span>
                                            <span class="text-xs text-gray-500">2024/01/20 14:32</span>
                                        </div>
                                        <p class="text-sm text-gray-700">
                                            ç›®æ¨™å€¤ã‚’ã€Œ1,450å„„å††ã€ã‹ã‚‰ã€Œ1,500å„„å††ã€ã«ä¸Šæ–¹ä¿®æ­£
                                        </p>
                                        <div class="mt-2 p-2 bg-gray-50 rounded text-xs text-gray-600">
                                            ç†ç”±: ã‚¢ã‚¸ã‚¢å¸‚å ´ã®æƒ³å®šä»¥ä¸Šã®æˆé•·ã‚’åæ˜ 
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="history-item">
                                <div class="flex items-start gap-3">
                                    <div class="history-icon bg-green-100 text-green-600">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="font-medium text-sm">ä½è—¤èŠ±å­</span>
                                            <span class="text-xs text-gray-500">2024/01/15 10:20</span>
                                        </div>
                                        <p class="text-sm text-gray-700">
                                            Q3å®Ÿç¸¾ã‚’æ›´æ–°ï¼š1,245å„„å††ï¼ˆç›®æ¨™é”æˆï¼‰
                                        </p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="history-item">
                                <div class="flex items-start gap-3">
                                    <div class="history-icon bg-blue-100 text-blue-600">
                                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z" />
                                        </svg>
                                    </div>
                                    <div class="flex-1">
                                        <div class="flex items-center gap-2 mb-1">
                                            <span class="font-medium text-sm">ã‚·ã‚¹ãƒ†ãƒ </span>
                                            <span class="text-xs text-gray-500">2024/01/10 09:00</span>
                                        </div>
                                        <p class="text-sm text-gray-700">
                                            æŠ•è³‡å®¶ã‹ã‚‰ã®è³ªå•ãŒ5ä»¶è¿½åŠ ã•ã‚Œã¾ã—ãŸ
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <style>
                        .history-item {
                            padding: 12px;
                            border-radius: 8px;
                            background: #f9fafb;
                        }
                        .history-icon {
                            width: 32px;
                            height: 32px;
                            background: #e5e7eb;
                            border-radius: 50%;
                            display: flex;
                            align-items: center;
                            justify-content: center;
                            flex-shrink: 0;
                        }
                    </style>
                `;
                
            default:
                return '<p>ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>';
        }
    }
    
    // ãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—ç”Ÿæˆ
    function generateHeatmap() {
        let html = '';
        for (let i = 0; i < 30; i++) {
            const level = Math.floor(Math.random() * 5);
            html += `<div class="heatmap-cell heat-level-${level}" title="${i+1}æ—¥å‰: ${level * 2}ä»¶ã®è³ªå•"></div>`;
        }
        return html;
    }
    
    // è©³ç´°ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
    function switchDetailTab(tab) {
        document.querySelectorAll('.detail-tab').forEach(t => {
            t.classList.remove('active');
        });
        event.target.classList.add('active');
        
        const targetId = document.querySelector('.target-detail-modal').dataset.targetId;
        const targetData = getTargetData(targetId);
        document.getElementById('detail-content').innerHTML = getDetailContent(tab, targetData);
        
        // ãƒãƒ£ãƒ¼ãƒˆãŒã‚ã‚‹å ´åˆã¯æç”»
        if (tab === 'progress') {
            setTimeout(() => drawProgressChart(targetData), 100);
        }
    }
    
    // é€²æ—ãƒãƒ£ãƒ¼ãƒˆæç”»
    function drawProgressChart(targetData) {
        // Chart.jsãªã©ã‚’ä½¿ç”¨ã—ã¦ãƒãƒ£ãƒ¼ãƒˆã‚’æç”»
        // ã“ã“ã§ã¯ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼
        console.log('Drawing progress chart for', targetData.id);
    }
    
    // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆè³ªå•è¡¨ç¤º
    function showTargetQuestions(targetId) {
        showModal({
            title: 'é–¢é€£ã™ã‚‹è³ªå•',
            content: `
                <div class="space-y-4">
                    <div class="p-4 bg-yellow-50 rounded-lg">
                        <p class="text-sm text-yellow-800">
                            ã“ã®ç›®æ¨™ã«é–¢ã—ã¦${targetId === 'revenue' ? '8' : targetId === 'roe' ? '3' : targetId === 'overseas-ratio' ? '5' : targetId === 'co2-reduction' ? '7' : targetId === 'dx-investment' ? '12' : targetId === 'asia-expansion' ? '18' : '15'}ä»¶ã®æœªå›ç­”è³ªå•ãŒã‚ã‚Šã¾ã™ã€‚
                        </p>
                    </div>
                    
                    <div class="space-y-3">
                        <!-- è³ªå•ãƒªã‚¹ãƒˆãŒå‹•çš„ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
                    </div>
                    
                    <div class="flex gap-3">
                        <button onclick="answerAllQuestions('${targetId}')" class="px-4 py-2 bg-kagami-blue text-white rounded-lg hover:bg-kagami-blue-dark">
                            ã™ã¹ã¦ã«å›ç­”ã‚’ä½œæˆ
                        </button>
                        <button onclick="createTargetFAQ('${targetId}')" class="px-4 py-2 bg-white border border-gray-300 rounded-lg hover:bg-gray-50">
                            FAQã‚’ä½œæˆ
                        </button>
                    </div>
                </div>
            `,
            confirmText: null,
            cancelText: 'é–‰ã˜ã‚‹'
        });
    }
    
    // è³ªå•ã‚¿ãƒ–åˆ‡ã‚Šæ›¿ãˆ
    function switchQuestionTab(tab) {
        document.querySelectorAll('.question-tab').forEach(t => {
            t.classList.remove('active');
        });
        event.target.classList.add('active');
        
        // ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®æ›´æ–°ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯ãƒ‡ãƒ¼ã‚¿ã‚’å‹•çš„ã«èª­ã¿è¾¼ã¿ï¼‰
        showNotification(`${tab === 'unanswered' ? 'æœªå›ç­”' : tab === 'draft' ? 'ä¸‹æ›¸ã' : tab === 'answered' ? 'å›ç­”æ¸ˆã¿' : 'FAQåŒ–æ¸ˆã¿'}ã®è³ªå•ã‚’è¡¨ç¤º`, 'info');
    }
    
    // è³ªå•ã«å›ç­”
    function answerQuestion(questionId) {
        document.getElementById('faq-editor').style.display = 'block';
        document.getElementById('original-question').textContent = 
            questionId === 'Q001' ? 'æµ·å¤–å£²ä¸Šæ¯”ç‡35%ã®é”æˆã«å‘ã‘ã¦ã€å„åœ°åŸŸåˆ¥ã®å£²ä¸Šç›®æ¨™ã¨æŠ•è³‡è¨ˆç”»ã®è©³ç´°ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚' :
            questionId === 'Q002' ? 'DXæŠ•è³‡300å„„å††ã®å†…è¨³ã¨æœŸå¾…ã•ã‚Œã‚‹ROIã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¦ãã ã•ã„ã€‚' :
            'CO2å‰Šæ¸›ç‡50%é”æˆã®ãŸã‚ã®å…·ä½“çš„ãªãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚';
        
        // FAQã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã«ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
        document.getElementById('faq-editor').scrollIntoView({ behavior: 'smooth' });
        
        // AIææ¡ˆã‚’ãƒ­ãƒ¼ãƒ‰
        setTimeout(() => {
            showNotification('AIãŒå›ç­”æ¡ˆã‚’ä½œæˆä¸­...', 'info');
        }, 500);
    }
    
    // FAQä½œæˆ
    function createFAQ(questionId) {
        answerQuestion(questionId);
    }
    
    // AIææ¡ˆã‚’é©ç”¨
    function applyAISuggestion(type, index) {
        if (type === 'question') {
            if (index === 1) {
                document.getElementById('faq-question').value = 'æµ·å¤–å±•é–‹ã«ãŠã‘ã‚‹åœ°åŸŸåˆ¥ã®å£²ä¸Šç›®æ¨™ã¨æŠ•è³‡è¨ˆç”»ã«ã¤ã„ã¦æ•™ãˆã¦ãã ã•ã„';
            } else {
                document.getElementById('faq-question').value = 'ã‚¢ã‚¸ã‚¢å¸‚å ´ã§ã®æˆé•·æˆ¦ç•¥ã¨ç«¶åˆå„ªä½æ€§ã«ã¤ã„ã¦';
            }
        } else if (type === 'answer') {
            const currentAnswer = document.getElementById('faq-answer').value;
            if (index === 1) {
                document.getElementById('faq-answer').value = `2026å¹´åº¦ã®æµ·å¤–å£²ä¸Šæ¯”ç‡35%é”æˆã«å‘ã‘ã¦ã€ã‚¢ã‚¸ã‚¢åœ°åŸŸã§200å„„å††ï¼ˆå…¨ä½“ã®60%ï¼‰ã€åŒ—ç±³ã§100å„„å††ï¼ˆ30%ï¼‰ã€æ¬§å·ã§30å„„å††ï¼ˆ10%ï¼‰ã®å£²ä¸Šã‚’è¨ˆç”»ã—ã¦ã„ã¾ã™ã€‚æŠ•è³‡é¡ã¯3å¹´é–“ã§ç·é¡150å„„å††ã‚’äºˆå®šã—ã€ç¾åœ°æ³•äººè¨­ç«‹ã€ç‰©æµæ‹ ç‚¹æ§‹ç¯‰ã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°å¼·åŒ–ã«å……å½“ã—ã¾ã™ã€‚`;
            } else {
                document.getElementById('faq-answer').value = currentAnswer + '\n\nè©³ç´°ã¯çµ±åˆå ±å‘Šæ›¸P.45-48ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹æˆ¦ç•¥ã€ã‚’ã”å‚ç…§ãã ã•ã„ã€‚';
            }
        }
        showNotification('AIææ¡ˆã‚’é©ç”¨ã—ã¾ã—ãŸ', 'success');
    }
    
    // FAQä¿å­˜
    function saveFAQ() {
        showModal({
            title: 'FAQã®å…¬é–‹ç¢ºèª',
            content: `
                <div class="space-y-4">
                    <div class="p-4 bg-blue-50 rounded-lg">
                        <p class="text-sm text-blue-800">
                            ã“ã®FAQã‚’å…¬é–‹ã™ã‚‹ã¨ã€ã™ã¹ã¦ã®æŠ•è³‡å®¶ãŒé–²è¦§å¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
                        </p>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-2">å…¬é–‹ç¯„å›²</h4>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="radio" name="visibility" checked class="mr-2">
                                <span class="text-sm">ã™ã¹ã¦ã®æŠ•è³‡å®¶</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="visibility" class="mr-2">
                                <span class="text-sm">æ©Ÿé–¢æŠ•è³‡å®¶ã®ã¿</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="visibility" class="mr-2">
                                <span class="text-sm">ç‰¹å®šã®æŠ•è³‡å®¶ã‚°ãƒ«ãƒ¼ãƒ—</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-2">é€šçŸ¥è¨­å®š</h4>
                        <label class="flex items-center">
                            <input type="checkbox" checked class="mr-2">
                            <span class="text-sm">é–¢é€£ã™ã‚‹è³ªå•ã‚’ã—ãŸæŠ•è³‡å®¶ã«é€šçŸ¥</span>
                        </label>
                    </div>
                </div>
            `,
            confirmText: 'å…¬é–‹ã™ã‚‹',
            onConfirm: () => {
                showNotification('FAQã‚’å…¬é–‹ã—ã¾ã—ãŸ', 'success');
                closeFAQEditor();
            }
        });
    }
    
    // FAQã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚’é–‰ã˜ã‚‹
    function closeFAQEditor() {
        document.getElementById('faq-editor').style.display = 'none';
    }
    
    // FAQã‚«ãƒ†ã‚´ãƒªãƒ¼ã®å±•é–‹/æŠ˜ã‚ŠãŸãŸã¿
    function toggleCategory(categoryId) {
        const faqs = document.getElementById(`${categoryId}-faqs`);
        const arrow = event.currentTarget.querySelector('svg');
        
        if (faqs.style.display === 'none') {
            faqs.style.display = 'block';
            arrow.style.transform = 'rotate(180deg)';
        } else {
            faqs.style.display = 'none';
            arrow.style.transform = 'rotate(0deg)';
        }
    }
    
    // FAQã®å±•é–‹/æŠ˜ã‚ŠãŸãŸã¿
    function toggleFAQ(element) {
        if (event.target.tagName === 'BUTTON') return;
        element.classList.toggle('expanded');
    }
    
    // AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ
    function showAIAssistant() {
        showModal({
            title: 'AIå›ç­”ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆ',
            content: `
                <div class="space-y-4">
                    <div class="p-4 bg-gradient-to-r from-teal-50 to-blue-50 rounded-lg">
                        <h4 class="font-semibold text-gray-900 mb-2">AIãŒåˆ†æã—ãŸå‚¾å‘</h4>
                        <ul class="space-y-2 text-sm text-gray-700">
                            <li class="flex items-start gap-2">
                                <span class="text-red-500">â€¢</span>
                                æµ·å¤–å±•é–‹ã«é–¢ã™ã‚‹è³ªå•ãŒæœ€ã‚‚å¤šãï¼ˆ43%ï¼‰ã€ç‰¹ã«åœ°åŸŸåˆ¥æŠ•è³‡è¨ˆç”»ã¸ã®é–¢å¿ƒãŒé«˜ã„
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-yellow-500">â€¢</span>
                                DXæŠ•è³‡ã®ROIã«é–¢ã™ã‚‹è³ªå•ãŒå¢—åŠ ï¼ˆå‰æœˆæ¯”+65%ï¼‰
                            </li>
                            <li class="flex items-start gap-2">
                                <span class="text-green-500">â€¢</span>
                                ESGé–¢é€£ã®è³ªå•ã¯å®šé‡ç›®æ¨™ã‚’æ±‚ã‚ã‚‹å†…å®¹ãŒä¸­å¿ƒ
                            </li>
                        </ul>
                    </div>
                    
                    <div>
                        <h4 class="font-semibold text-gray-900 mb-2">æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h4>
                        <div class="space-y-2">
                            <button onclick="generateBulkFAQ()" class="w-full p-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-left">
                                <div class="font-medium text-gray-900">ğŸ“„ ä¸€æ‹¬FAQä½œæˆ</div>
                                <div class="text-sm text-gray-600 mt-1">æœªå›ç­”26ä»¶ã®è³ªå•ã‹ã‚‰é‡è¦ãª10ä»¶ã‚’é¸ã‚“ã§FAQåŒ–</div>
                            </button>
                            <button onclick="analyzeQuestionTrends()" class="w-full p-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-left">
                                <div class="font-medium text-gray-900">ğŸ“Š ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ</div>
                                <div class="text-sm text-gray-600 mt-1">è³ªå•å‚¾å‘ã‚’åˆ†æã—ã¦äºˆé˜²çš„ãªFAQã‚’ææ¡ˆ</div>
                            </button>
                            <button onclick="improveExistingFAQ()" class="w-full p-3 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 text-left">
                                <div class="font-medium text-gray-900">âœ¨ æ—¢å­˜FAQæ”¹å–„</div>
                                <div class="text-sm text-gray-600 mt-1">é–²è¦§æ•°ã®å¤šã„FAQã‚’AIãŒåˆ†æã—ã¦æ”¹å–„ææ¡ˆ</div>
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            AIã«ç›¸è«‡
                        </label>
                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg" rows="3"
                            placeholder="ä¾‹ï¼šæµ·å¤–å±•é–‹ã«é–¢ã™ã‚‹è³ªå•ã¸ã®æ¨™æº–çš„ãªå›ç­”ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ•™ãˆã¦"></textarea>
                    </div>
                </div>
            `,
            confirmText: 'AIã«ç›¸è«‡',
            onConfirm: () => {
                showNotification('AIãŒåˆ†æä¸­...', 'info');
            }
        });
    }
    
    // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½
    document.addEventListener('DOMContentLoaded', function() {
        const draggables = document.querySelectorAll('.draggable');
        const dropZones = document.querySelectorAll('.faq-list');
        
        draggables.forEach(draggable => {
            draggable.addEventListener('dragstart', () => {
                draggable.classList.add('dragging');
            });
            
            draggable.addEventListener('dragend', () => {
                draggable.classList.remove('dragging');
            });
        });
        
        dropZones.forEach(zone => {
            zone.addEventListener('dragover', e => {
                e.preventDefault();
                const dragging = document.querySelector('.dragging');
                const afterElement = getDragAfterElement(zone, e.clientY);
                if (afterElement == null) {
                    zone.appendChild(dragging);
                } else {
                    zone.insertBefore(dragging, afterElement);
                }
            });
        });
    });
    
    function getDragAfterElement(container, y) {
        const draggableElements = [...container.querySelectorAll('.draggable:not(.dragging)')];
        
        return draggableElements.reduce((closest, child) => {
            const box = child.getBoundingClientRect();
            const offset = y - box.top - box.height / 2;
            
            if (offset < 0 && offset > closest.offset) {
                return { offset: offset, element: child };
            } else {
                return closest;
            }
        }, { offset: Number.NEGATIVE_INFINITY }).element;
    }
    
    // ãã®ä»–ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
    function showAllQuestions(type) {
        showNotification(`${type}ã«é–¢ã™ã‚‹ã™ã¹ã¦ã®è³ªå•ã‚’è¡¨ç¤º`, 'info');
    }
    
    function editTargets(type) {
        showNotification(`${type}ã®ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹ã`, 'info');
    }
    
    function importQuestions() {
        showModal({
            title: 'è³ªå•ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ',
            content: `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ã‚¤ãƒ³ãƒãƒ¼ãƒˆå…ƒ</label>
                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option>è­°äº‹éŒ²ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </option>
                            <option>ãƒ¡ãƒ¼ãƒ«å•ã„åˆã‚ã›</option>
                            <option>CSVãƒ•ã‚¡ã‚¤ãƒ«</option>
                        </select>
                    </div>
                </div>
            `,
            confirmText: 'ã‚¤ãƒ³ãƒãƒ¼ãƒˆ',
            onConfirm: () => {
                showNotification('è³ªå•ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
            }
        });
    }
    
    function exportFAQ() {
        showModal({
            title: 'FAQã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ',
            content: `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å‡ºåŠ›å½¢å¼</label>
                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option>PDFï¼ˆæŠ•è³‡å®¶å‘ã‘ï¼‰</option>
                            <option>Excelï¼ˆç·¨é›†ç”¨ï¼‰</option>
                            <option>HTMLï¼ˆWebã‚µã‚¤ãƒˆç”¨ï¼‰</option>
                        </select>
                    </div>
                </div>
            `,
            confirmText: 'ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ',
            onConfirm: () => {
                showNotification('FAQã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
            }
        });
    }
    
    // ç›®æ¨™ç·¨é›†
    function editTarget(targetId) {
        const targetData = getTargetData(targetId);
        showModal({
            title: `${targetData.name}ã®ç·¨é›†`,
            content: `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç›®æ¨™å€¤</label>
                        <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg" value="${targetData.value}">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">èª¬æ˜</label>
                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg" rows="3">${targetData.description}</textarea>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">æ‹…å½“éƒ¨é–€</label>
                        <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg" value="${targetData.responsible}">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å¤‰æ›´ç†ç”±</label>
                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg" rows="2" placeholder="å¤‰æ›´ç†ç”±ã‚’è¨˜è¼‰ã—ã¦ãã ã•ã„"></textarea>
                    </div>
                    
                    <div class="p-4 bg-yellow-50 rounded-lg">
                        <p class="text-sm text-yellow-800">
                            <strong>æ³¨æ„ï¼š</strong>ã“ã®å¤‰æ›´ã¯é–¢ä¿‚è€…ã«é€šçŸ¥ã•ã‚Œã€æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹ãŒå¿…è¦ã§ã™ã€‚
                        </p>
                    </div>
                </div>
            `,
            confirmText: 'ä¿å­˜',
            onConfirm: () => {
                showNotification('å¤‰æ›´ã‚’ä¿å­˜ã—ã€æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã—ã¾ã—ãŸ', 'success');
            }
        });
    }
    
    // é€²æ—æ›´æ–°
    function updateProgress(targetId) {
        const targetData = getTargetData(targetId);
        showModal({
            title: `${targetData.name}ã®é€²æ—æ›´æ–°`,
            content: `
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ç¾åœ¨ã®é€²æ—ç‡</label>
                        <div class="flex items-center gap-4">
                            <input type="range" min="0" max="100" value="${targetData.progress}" 
                                   class="flex-1" id="progress-slider" onchange="updateProgressValue()">
                            <span id="progress-value" class="text-lg font-semibold w-16 text-right">${targetData.progress}%</span>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">å®Ÿç¸¾å€¤</label>
                        <input type="text" class="w-full px-3 py-2 border border-gray-300 rounded-lg" 
                               placeholder="ä¾‹: 1,245å„„å††">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</label>
                        <select class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                            <option value="on-track" ${targetData.status === 'on-track' ? 'selected' : ''}>é †èª¿</option>
                            <option value="at-risk" ${targetData.status === 'at-risk' ? 'selected' : ''}>è¦æ³¨æ„</option>
                            <option value="delayed">é…å»¶</option>
                            <option value="completed">å®Œäº†</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ã‚³ãƒ¡ãƒ³ãƒˆ</label>
                        <textarea class="w-full px-3 py-2 border border-gray-300 rounded-lg" rows="3" 
                                  placeholder="é€²æ—ã«é–¢ã™ã‚‹è©³ç´°ã‚„èª²é¡Œã‚’è¨˜è¼‰"></textarea>
                    </div>
                    
                    <div>
                        <label class="flex items-center">
                            <input type="checkbox" class="mr-2">
                            <span class="text-sm">é–¢ä¿‚è€…ã«é€²æ—æ›´æ–°ã‚’é€šçŸ¥ã™ã‚‹</span>
                        </label>
                    </div>
                </div>
            `,
            confirmText: 'æ›´æ–°',
            onConfirm: () => {
                showNotification('é€²æ—ã‚’æ›´æ–°ã—ã¾ã—ãŸ', 'success');
            }
        });
    }
    
    // é€²æ—ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã®å€¤æ›´æ–°
    function updateProgressValue() {
        const slider = document.getElementById('progress-slider');
        const value = document.getElementById('progress-value');
        value.textContent = slider.value + '%';
    }
    
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    function simulateRealtimeCollaboration() {
        // ãƒ©ãƒ³ãƒ€ãƒ ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå‚åŠ /é›¢è„±
        setInterval(() => {
            const indicators = document.querySelectorAll('.collaboration-indicator');
            indicators.forEach(indicator => {
                const users = indicator.querySelector('.active-users');
                if (users && Math.random() > 0.7) {
                    // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¢ãƒã‚¿ãƒ¼ã®æ›´æ–°
                    const avatars = users.querySelectorAll('.user-avatar');
                    const randomAvatar = avatars[Math.floor(Math.random() * avatars.length)];
                    randomAvatar.style.animation = 'pulse 1s';
                    setTimeout(() => {
                        randomAvatar.style.animation = '';
                    }, 1000);
                }
            });
        }, 5000);
    }
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', function() {
        // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã®åˆæœŸåŒ–
        initializeDragAndDrop();
        
        // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        simulateRealtimeCollaboration();
        
        // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
        document.addEventListener('keydown', function(e) {
            // Ctrl+K: æ¤œç´¢
            if (e.ctrlKey && e.key === 'k') {
                e.preventDefault();
                document.getElementById('globalSearch')?.focus();
            }
            // Ctrl+S: ä¿å­˜
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                showNotification('å¤‰æ›´ã‚’ä¿å­˜ã—ã¾ã—ãŸ', 'success');
            }
        });
    });
    
    // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—åˆæœŸåŒ–
    function initializeDragAndDrop() {
        const draggables = document.querySelectorAll('.draggable');
        const dropZones = document.querySelectorAll('.faq-list');
        
        draggables.forEach(draggable => {
            draggable.addEventListener('dragstart', () => {
                draggable.classList.add('dragging');
            });
            
            draggable.addEventListener('dragend', () => {
                draggable.classList.remove('dragging');
            });
        });
        
        dropZones.forEach(zone => {
            zone.addEventListener('dragover', e => {
                e.preventDefault();
                const dragging = document.querySelector('.dragging');
                const afterElement = getDragAfterElement(zone, e.clientY);
                if (afterElement == null) {
                    zone.appendChild(dragging);
                } else {
                    zone.insertBefore(dragging, afterElement);
                }
            });
        });
    }
    
    // ãã®ä»–ã®è£œåŠ©é–¢æ•°
    function assignQuestion(questionId) {
        showNotification(`è³ªå•${questionId}ã®æ‹…å½“è€…ã‚’å‰²ã‚Šå½“ã¦`, 'info');
    }
    
    function relateQuestion(questionId) {
        showNotification(`è³ªå•${questionId}ã®é¡ä¼¼è³ªå•ã‚’è¡¨ç¤º`, 'info');
    }
    
    function openQuestionDetail(questionId) {
        showNotification(`è³ªå•${questionId}ã®è©³ç´°ã‚’è¡¨ç¤º`, 'info');
    }
    
    function saveDraft() {
        showNotification('FAQã‚’ä¸‹æ›¸ãä¿å­˜ã—ã¾ã—ãŸ', 'success');
    }
    
    function previewFAQ() {
        showNotification('FAQã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’è¡¨ç¤º', 'info');
    }
    
    function editFAQ(faqId) {
        showNotification(`FAQ${faqId}ã®ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹ã`, 'info');
    }
    
    function manageFAQOrder() {
        showNotification('FAQã®ä¸¦ã³é †ç®¡ç†ãƒ¢ãƒ¼ãƒ‰ã‚’é–‹ã', 'info');
    }
    
    function createTargetFAQ(targetId) {
        showNotification(`${targetId}ã«é–¢ã™ã‚‹FAQã‚’ä½œæˆ`, 'info');
    }
    
    function answerAllQuestions(targetId) {
        showNotification(`${targetId}ã®ã™ã¹ã¦ã®è³ªå•ã«å›ç­”ã‚’ä½œæˆ`, 'info');
    }
    
    function viewSimilar(questionId) {
        showNotification(`è³ªå•${questionId}ã®é¡ä¼¼è³ªå•ã‚’è¡¨ç¤º`, 'info');
    }
    
    function viewAnswer(questionId) {
        showNotification(`è³ªå•${questionId}ã®å›ç­”ã‚’è¡¨ç¤º`, 'info');
    }
    
    function generateBulkFAQ() {
        showNotification('ä¸€æ‹¬FAQä½œæˆã‚’é–‹å§‹', 'info');
    }
    
    function analyzeQuestionTrends() {
        showNotification('è³ªå•ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æã‚’é–‹å§‹', 'info');
    }
    
    function improveExistingFAQ() {
        showNotification('æ—¢å­˜FAQã®æ”¹å–„ææ¡ˆã‚’ç”Ÿæˆ', 'info');
    }
    
    // AIã‚¢ã‚·ã‚¹ãƒˆé–¢é€£é–¢æ•°
    function toggleAIAssist() {
        const menu = document.getElementById('aiAssistMenu');
        menu.classList.toggle('active');
    }
    
    function aiGenerateInsights() {
        toggleAIAssist();
        document.getElementById('insightsPanel').style.display = 'block';
        showNotification('AIãŒãƒ‡ãƒ¼ã‚¿ã‚’åˆ†æã—ã€ã‚¤ãƒ³ã‚µã‚¤ãƒˆã‚’ç”Ÿæˆã—ã¾ã—ãŸ', 'success');
        
        // ã‚¹ãƒãƒ¼ãƒˆææ¡ˆã‚‚è¡¨ç¤º
        setTimeout(() => {
            document.getElementById('smartSuggestion').style.display = 'block';
        }, 1000);
    }
    
    function aiSuggestAnswers() {
        toggleAIAssist();
        showNotification('AIãŒè³ªå•ã¸ã®å›ç­”æ¡ˆã‚’ç”Ÿæˆã—ã¦ã„ã¾ã™...', 'info');
        
        // FAQç·¨é›†ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        setTimeout(() => {
            const faqEditor = document.querySelector('.faq-editor');
            if (faqEditor) {
                faqEditor.scrollIntoView({ behavior: 'smooth', block: 'center' });
                faqEditor.style.animation = 'pulse 2s';
            }
        }, 500);
    }
    
    function aiAnalyzeTrends() {
        toggleAIAssist();
        showNotification('è³ªå•ãƒˆãƒ¬ãƒ³ãƒ‰ã‚’åˆ†æä¸­...', 'info');
        
        // ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤º
        setTimeout(() => {
            showModal({
                title: 'AIãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æçµæœ',
                content: `
                    <div class="space-y-4">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <h4 class="font-medium text-blue-900 mb-2">ğŸ“ˆ ä¸Šæ˜‡ãƒˆãƒ¬ãƒ³ãƒ‰</h4>
                            <ul class="text-sm text-blue-700 space-y-1">
                                <li>â€¢ DXæŠ•è³‡ã®ROIã«é–¢ã™ã‚‹è³ªå•: +40% (å…ˆé€±æ¯”)</li>
                                <li>â€¢ ã‚¢ã‚¸ã‚¢å±•é–‹ã®ãƒªã‚¹ã‚¯ã«é–¢ã™ã‚‹è³ªå•: +25%</li>
                                <li>â€¢ ESGç›®æ¨™ã®å®Ÿç¾å¯èƒ½æ€§: +20%</li>
                            </ul>
                        </div>
                        
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <h4 class="font-medium text-orange-900 mb-2">ğŸ” æ³¨ç›®ãƒ†ãƒ¼ãƒ</h4>
                            <ul class="text-sm text-orange-700 space-y-1">
                                <li>â€¢ ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³ã®åœ°æ”¿å­¦ãƒªã‚¹ã‚¯</li>
                                <li>â€¢ AIäººæã®ç¢ºä¿ã¨è‚²æˆè¨ˆç”»</li>
                                <li>â€¢ ã‚µã‚¹ãƒ†ãƒŠãƒ“ãƒªãƒ†ã‚£ãƒœãƒ³ãƒ‰ã®æ´»ç”¨</li>
                            </ul>
                        </div>
                        
                        <div class="bg-green-50 p-4 rounded-lg">
                            <h4 class="font-medium text-green-900 mb-2">ğŸ’¡ æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</h4>
                            <ul class="text-sm text-green-700 space-y-1">
                                <li>â€¢ DXæŠ•è³‡ã«é–¢ã™ã‚‹è©³ç´°èª¬æ˜è³‡æ–™ã®ä½œæˆ</li>
                                <li>â€¢ åœ°æ”¿å­¦ãƒªã‚¹ã‚¯å¯¾å¿œæ–¹é‡ã®FAQåŒ–</li>
                                <li>â€¢ å››åŠæœŸã”ã¨ã®ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³è¨­å®š</li>
                            </ul>
                        </div>
                    </div>
                `,
                confirmText: 'ãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ',
                onConfirm: () => {
                    showNotification('ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æãƒ¬ãƒãƒ¼ãƒˆã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
                }
            });
        }, 1500);
    }
    
    function aiOptimizePlan() {
        toggleAIAssist();
        showNotification('è¨ˆç”»æœ€é©åŒ–ã®ææ¡ˆã‚’ç”Ÿæˆä¸­...', 'info');
        
        setTimeout(() => {
            showModal({
                title: 'AIã«ã‚ˆã‚‹è¨ˆç”»æœ€é©åŒ–ææ¡ˆ',
                content: `
                    <div class="space-y-4">
                        <div class="p-4 bg-purple-50 rounded-lg">
                            <h4 class="font-medium text-purple-900 mb-2">ğŸ¯ ç›®æ¨™èª¿æ•´ææ¡ˆ</h4>
                            <div class="space-y-2 text-sm text-purple-700">
                                <p>â–ªï¸ æµ·å¤–å£²ä¸Šæ¯”ç‡ç›®æ¨™: 35% â†’ 30% (ç¾å®Ÿçš„ãªæˆé•·ç‡ã‚’è€ƒæ…®)</p>
                                <p>â–ªï¸ DXæŠ•è³‡: 300å„„å†† â†’ 350å„„å†† (ç«¶äº‰å„ªä½æ€§ç¢ºä¿ã®ãŸã‚)</p>
                                <p>â–ªï¸ CO2å‰Šæ¸›: -50% â†’ -45% (æ®µéšçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ¨å¥¨)</p>
                            </div>
                        </div>
                        
                        <div class="p-4 bg-blue-50 rounded-lg">
                            <h4 class="font-medium text-blue-900 mb-2">ğŸ“… ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³æœ€é©åŒ–</h4>
                            <div class="space-y-2 text-sm text-blue-700">
                                <p>â–ªï¸ Q1-Q2: DXåŸºç›¤æ§‹ç¯‰ã«é›†ä¸­</p>
                                <p>â–ªï¸ Q3-Q4: ã‚¢ã‚¸ã‚¢å±•é–‹ã®æœ¬æ ¼åŒ–</p>
                                <p>â–ªï¸ 2025å¹´åº¦: æ–°è¦äº‹æ¥­ã®åç›ŠåŒ–åŠ é€Ÿ</p>
                            </div>
                        </div>
                        
                        <div class="p-4 bg-amber-50 rounded-lg">
                            <h4 class="font-medium text-amber-900 mb-2">âš ï¸ ãƒªã‚¹ã‚¯ãƒ˜ãƒƒã‚¸ææ¡ˆ</h4>
                            <div class="space-y-2 text-sm text-amber-700">
                                <p>â–ªï¸ ç‚ºæ›¿ãƒ˜ãƒƒã‚¸: å£²ä¸Šã®60%ã¾ã§æ‹¡å¤§</p>
                                <p>â–ªï¸ ã‚µãƒ—ãƒ©ã‚¤ãƒã‚§ãƒ¼ãƒ³: ä»£æ›¿ã‚µãƒ—ãƒ©ã‚¤ãƒ¤ãƒ¼ã®ç¢ºä¿</p>
                                <p>â–ªï¸ äººæ: DXäººæã®å¤–éƒ¨æ¡ç”¨å¼·åŒ–</p>
                            </div>
                        </div>
                    </div>
                `,
                confirmText: 'ææ¡ˆã‚’é©ç”¨',
                onConfirm: () => {
                    showNotification('æœ€é©åŒ–ææ¡ˆã‚’è¨ˆç”»ã«åæ˜ ã—ã¾ã—ãŸ', 'success');
                }
            });
        }, 1500);
    }
    
    function dismissSuggestion() {
        document.getElementById('smartSuggestion').style.display = 'none';
    }
    
    function applyInsight(type) {
        showNotification(`${type}ã«é–¢ã™ã‚‹ã‚¤ãƒ³ã‚µã‚¤ãƒˆã‚’é©ç”¨ã—ã¾ã—ãŸ`, 'success');
        
        // é–¢é€£ã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆ
        if (type === 'revenue') {
            const revenueCard = document.querySelector('[onclick*="revenue"]');
            if (revenueCard) {
                revenueCard.style.border = '2px solid #3b82f6';
                revenueCard.style.animation = 'pulse 2s';
            }
        }
    }
    
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    function simulateRealtimeUpdates() {
        setInterval(() => {
            // ãƒ©ãƒ³ãƒ€ãƒ ã«è³ªå•æ•°ã‚’æ›´æ–°
            const questionCounts = document.querySelectorAll('.target-questions span');
            const randomIndex = Math.floor(Math.random() * questionCounts.length);
            if (questionCounts[randomIndex]) {
                const currentText = questionCounts[randomIndex].textContent;
                const match = currentText.match(/(\d+)/);
                if (match) {
                    const currentCount = parseInt(match[1]);
                    const newCount = currentCount + Math.floor(Math.random() * 3) + 1;
                    questionCounts[randomIndex].textContent = currentText.replace(match[1], newCount);
                    questionCounts[randomIndex].parentElement.style.animation = 'pulse 1s';
                }
            }
        }, 10000); // 10ç§’ã”ã¨ã«æ›´æ–°
    }
    
    // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®è¿½åŠ åˆæœŸåŒ–
    document.addEventListener('DOMContentLoaded', function() {
        // æ—¢å­˜ã®åˆæœŸåŒ–ã«åŠ ãˆã¦
        simulateRealtimeUpdates();
        
        // 3ç§’å¾Œã«ã‚¹ãƒãƒ¼ãƒˆææ¡ˆã‚’è¡¨ç¤º
        setTimeout(() => {
            document.getElementById('smartSuggestion').style.display = 'block';
        }, 3000);
    });
</script>
</div>
{% endblock %}